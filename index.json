[{"content":"Fcitx5的繁體倉頡是在fcitx5-table-extra裡, 但被沒有打包成debain package無法直接使用apt安裝.\n我們要自己編譯並安裝在系統上, 首先安裝必要的packages及fcitx5\n$ sudo apt-get install fcitx5 fcitx5-chinese-addons git build-essential \\ cmake extra-cmake-modules libboost-dev libimecore-dev libimetable-dev \\ libfcitx5core-dev libfcitx5utils-dev 編譯及安裝fcitx5-table-extra\n$ git clone https://github.com/fcitx/fcitx5-table-extra.git $ cd fcitx5-table-extra \u0026amp;\u0026amp; mkdir build \u0026amp;\u0026amp; cd build $ cmake -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_INSTALL_LIBDIR=/usr/lib .. $ make -j8 \u0026amp;\u0026amp; sudo make install 重啟fcitx5就可以看到一些倉頡輸入法, 像是CangJie5, SmartCangJie6\u0026hellip;\nPS.\n檢查系統是否使用正確的輸入法框架可使用im-config指令 注音輸入法只要安裝fcitx5-chewing即可 ","permalink":"https://oopsmonk.github.io/posts/2022-12-19-fcitx5/","summary":"Fcitx5的繁體倉頡是在fcitx5-table-extra裡, 但被沒有打包成debain package無法直接使用apt安裝.\n我們要自己編譯並安裝在系統上, 首先安裝必要的packages及fcitx5\n$ sudo apt-get install fcitx5 fcitx5-chinese-addons git build-essential \\ cmake extra-cmake-modules libboost-dev libimecore-dev libimetable-dev \\ libfcitx5core-dev libfcitx5utils-dev 編譯及安裝fcitx5-table-extra\n$ git clone https://github.com/fcitx/fcitx5-table-extra.git $ cd fcitx5-table-extra \u0026amp;\u0026amp; mkdir build \u0026amp;\u0026amp; cd build $ cmake -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_INSTALL_LIBDIR=/usr/lib .. $ make -j8 \u0026amp;\u0026amp; sudo make install 重啟fcitx5就可以看到一些倉頡輸入法, 像是CangJie5, SmartCangJie6\u0026hellip;\nPS.\n檢查系統是否使用正確的輸入法框架可使用im-config指令 注音輸入法只要安裝fcitx5-chewing即可 ","title":"Fcitx5 倉頡輸入法 on Ubuntu 22.04"},{"content":"You can find many note-taking services, like, Evernote, Google Keep, Notion, Obsidian and online storage services such as, Dropbox, Google Drive, OneDrive, iCloud. They are easy to use and secure. But, secure is not equal to private! A way to keep privacy is host private services by self.\nEdward Snowden’s Privacy Tips: “Get Rid Of Dropbox,” Avoid Facebook And Google\nThis is how I share/edit notes and files with different devices which service providers are unable to peek and analyze my private contents. Joplin and Syncthing in grey are optional in the diagram, for example notes can be written on the Raspberry Pi through the terminal Joplin application, files can share between the Phone and the PC directly but my Raspberry Pi is online 24/7.\nAt least two devices is needed, here shows how to install Syncthing and Joplin on an Ubuntu PC and a Raspberry Pi. Steps are described briefly and details in the following sections\nBasic setup:\nInstall Syncthing on Raspberry Pi and Ubuntu PC Share the joplin-sync folder by Syncthing between Raspberry Pi and PC Install Joplin on Ubuntu Set synchronization target to File system Once 2 devices are setup and in sync for adding a new device:\nInstall Syncthing on the new device Add remote device by Syncthing on Raspberry Pi Share the joplin-sync folder to the new device Install Joplin on the new device Set synchronization target to File system on the new device Installing Syncthing on Ubuntu First, installing Syncthing on a local device which is Raspberry Pi in this example.\nAdding Syncthing to The Package Manager $ sudo curl -o /usr/share/keyrings/syncthing-archive-keyring.gpg https://syncthing.net/release-key.gpg $ echo \u0026#34;deb [signed-by=/usr/share/keyrings/syncthing-archive-keyring.gpg] https://apt.syncthing.net/ syncthing stable\u0026#34; | sudo tee /etc/apt/sources.list.d/syncthing.list $ sudo apt-get update $ sudo apt install syncthing Starting Syncthing Service $ syncthing [start] 2022/06/02 17:20:14 INFO: syncthing v1.20.1 \u0026#34;Fermium Flea\u0026#34; (go1.18.1 linux-amd64) deb@build.syncthing.net 2022-05-04 16:17:03 UTC [noupgrade] [start] 2022/06/02 17:20:14 INFO: Generating ECDSA key and certificate for syncthing... [start] 2022/06/02 17:20:14 INFO: Default folder created and/or linked to new config [start] 2022/06/02 17:20:15 INFO: Default config saved. Edit /home/sam/.config/syncthing/config.xml to taste (with Syncthing stopped) or use the GUI ... [K6V4V] 2022/06/02 17:20:16 INFO: GUI and API listening on 127.0.0.1:8384 Now, you can access the service by http://localhost:8384 and set username/password. Device ID could be found at Show ID in Actions menu, copy or write it down for later use.\nEnabling Syncthing Automatically You can start Syncthing automatically by 2 ways on Unix-like systems, a system service or an user service.\nFor Raspberry Pi, I would setup a system service since it runs as a server role, somehow the service has been setup after installation, I found syncthing.service under /.config/systemd/user/default.target.wants. I\u0026rsquo;d recommend to restart the Raspberry Pi for checking if Syncthing is shown in the process status(ps -axf), if it\u0026rsquo;s not there you can follow How to set up a system service\nFor Ubuntu PC, I setup the Desktop Entry, just simply copy script into ~/.config/autostart/ folder. see Using the Desktop Environment\n$ wget https://raw.githubusercontent.com/syncthing/syncthing/main/etc/linux-desktop/syncthing-start.desktop -O .config/autostart/syncthing-start.desktop Adding A Remote Device Second, Repeat previous to install Syncthing on the remote device which is an Ubuntu PC. After installing Syncthing on both Raspberry Pi and PC, you are ready to create a sync folder via the Syncthing service. Access the service of Raspberry Pi and click Add Remote Device and past PC\u0026rsquo;s Device ID\nClick Add Folder and fill in Folder Label and Folder Path as you preferred.\nSelect the Sharing tab to setup the remote device\nOnce Save is clicked, an notification will be popped up on the PC\u0026rsquo;s web-page asking to accept the invitation from the remote device(Raspberry Pi)\nInstall Joplin The recommended way to install Joplin Desktop application is from the installing script which it can create desktop icon and keep application up-to-date.\nwget -O - https://raw.githubusercontent.com/laurent22/joplin/dev/Joplin_install_and_update.sh | bash After installation, the script created $HOME/.joplin and $HOME/.config/joplin-desktop directories on the system.\nThe Joplin application version can be checked by\n$ cat $HOME/.joplin/VERSION 2.7.15 Database is stored in\n$ ls $HOME/.config/joplin-desktop cache database.sqlite log.txt resources settings.json tmp Therefore, if you would like to remove Joplin Desktop\n$ rm -rf $HOME/.joplin \u0026amp;\u0026amp; $HOME/.config/joplin-desktop Additionally, Joplin support external editor to edit Markdown files, the way to use vim/nvim is through gnome-terminal\nsudo apt install gnome-terminal Conclusion It is a way to keep sensitive contents in private and share them with different devices through Internet without worry about 3rd-parties controlling your data. The drawbacks are services maintenance is on yourself and troubleshooting is not easy if you have no basic understanding about how these tools work. Initial setup is kind of complicated and not handy for adding new devices but these services have run on my 4 devices for almost one year without problems.\nBy the way, I have been using Raspberry Pi to provide microservices for 9 years.\nNotice There is an Joplin issue on mobile devices, the workaround is downgrade the app to v2.5.5 at the moment, see:\nOperation Not Permitted On Android 12 #5691 Android filesystem sync is broken after 2.6.3 update #5779 References Syncthing Getting Start Syncthing Debian/Ubuntu Packages Joplin Joplin Desktop Application Joplin use Vim editor ","permalink":"https://oopsmonk.github.io/posts/2022-06-05-syncthin-joplin/","summary":"You can find many note-taking services, like, Evernote, Google Keep, Notion, Obsidian and online storage services such as, Dropbox, Google Drive, OneDrive, iCloud. They are easy to use and secure. But, secure is not equal to private! A way to keep privacy is host private services by self.\nEdward Snowden’s Privacy Tips: “Get Rid Of Dropbox,” Avoid Facebook And Google\nThis is how I share/edit notes and files with different devices which service providers are unable to peek and analyze my private contents.","title":"Note-taking and file sharing with Syncthing and Joplin"},{"content":"What is Perf? Perf or perf-event is a Linux profiler and is part of the Linux Kernel which can help you solve advanced performance and troubleshooting functions. It covers hardware level (CPU/PMU, Performance Monitoring Unit) features and software features (software counters, tracepoints) as well.\nInstall on Ubuntu If perf has not installed on the system\n$ perf WARNING: perf not found for kernel 5.4.0-109 You may need to install the following packages for this specific kernel: linux-tools-5.4.0-109-generic linux-cloud-tools-5.4.0-109-generic You may also want to install one of the following packages to keep up to date: linux-tools-generic linux-cloud-tools-generic $ The perf is part of linux-tools-generic package on Ubuntu:\n$ sudo apt install linux-tools-generic The following additional packages will be installed: linux-tools-5.4.0-109 linux-tools-5.4.0-109-generic The following NEW packages will be installed: linux-tools-5.4.0-109 linux-tools-5.4.0-109-generic linux-tools-generic 0 upgraded, 3 newly installed, 0 to remove and 0 not upgraded. Need to get 5,597 kB of archives. After this operation, 25.9 MB of additional disk space will be used. Do you want to continue? [Y/n] .... $ perf -v perf version 5.4.178 $ There was a warning when running the perf on the terminal\n\u0026ldquo;Cannot load tips.txt file, please install perf!\u0026rdquo;\nTo solve this warning: copy tips.txt from https://github.com/torvalds/linux/blob/master/tools/perf/Documentation/tips.txt to /usr/share/doc/perf-tip/tips.txt\nPerf with GUI hotspot: a standalone GUI for performance data\nOther profilers OProfile GProf References https://www.brendangregg.com/perf.html\nhttp://wiki.csie.ncku.edu.tw/embedded/perf-tutorial\nhttps://blog.csdn.net/z1026544682/article/details/115329534\nhttps://xiaoyanzhuo.github.io/2019/01/18/Perf-Tool.html\n","permalink":"https://oopsmonk.github.io/posts/2022-04-28-perf/","summary":"What is Perf? Perf or perf-event is a Linux profiler and is part of the Linux Kernel which can help you solve advanced performance and troubleshooting functions. It covers hardware level (CPU/PMU, Performance Monitoring Unit) features and software features (software counters, tracepoints) as well.\nInstall on Ubuntu If perf has not installed on the system\n$ perf WARNING: perf not found for kernel 5.4.0-109 You may need to install the following packages for this specific kernel: linux-tools-5.","title":"Install Perf on Ubuntu 20.04"},{"content":"utarray benchmarking\nWeek48~52 小筆記 bazel installation on Raspberry Pi Issue#1308\n$ sudo apt-get install build-essential openjdk-8-jdk python zip unzip $ wget https://github.com/bazelbuild/bazel/releases/download/0.19.2/bazel-0.19.2-dist.zip $ mkdir bazel-0.19.2 \u0026amp;\u0026amp; unzip ./bazel-0.19.2-dist.zip -d bazel-0.19.2 $ cd bazel-0.19.2 $ env BAZEL_JAVAC_OPTS=\u0026#34;-J-Xms384m -J-Xmx512m\u0026#34; bash ./compile.sh 🍃 Building Bazel from scratch...... 🍃 Building Bazel with Bazel. .WARNING: --batch mode is deprecated. Please instead explicitly shut down your Bazel server using the command \u0026#34;bazel shutdown\u0026#34;. INFO: Analysed target //src:bazel_nojdk (233 packages loaded, 10401 targets configured). Workaround for VS Code middle click paste. VS Code在Ubuntu裡滑鼠中鍵的複製貼上功能會造成看程式時的困擾\nIssue#49305\nIt cause a problem when browsing source code in VS code, here is an alternative solution. Disable middle paste on Xubuntu 18.04\nsam@sam-T480s:~$ xinput list ⎡ Virtual core pointer id=2 [master pointer (3)] ⎜ ↳ Virtual core XTEST pointer id=4 [slave pointer (2)] ⎜ ↳ ETPS/2 Elantech TrackPoint id=12 [slave pointer (2)] ⎜ ↳ ETPS/2 Elantech Touchpad id=11 [slave pointer (2)] ⎣ Virtual core keyboard id=3 [master keyboard (2)] ↳ Virtual core XTEST keyboard id=5 [slave keyboard (3)] ↳ Power Button id=6 [slave keyboard (3)] ↳ Video Bus id=7 [slave keyboard (3)] ↳ Sleep Button id=8 [slave keyboard (3)] ↳ Integrated Camera: Integrated C id=9 [slave keyboard (3)] ↳ AT Translated Set 2 keyboard id=10 [slave keyboard (3)] ↳ ThinkPad Extra Buttons id=13 [slave keyboard (3)] sam@sam-T480s:~$ xinput get-button-map 12 1 2 3 4 5 6 7 sam@sam-T480s:~$ xinput set-button-map 12 1 0 3 4 5 6 7 Run it on boot\n$ cat \u0026lt;\u0026lt;EOT \u0026gt; ~/bin/mouse_middle_disable.sh #!/bin/bash xinput set-button-map 12 1 0 3 4 5 6 7 exit 0 EOT $ chmode a+x ~/bin/mouse_middle_disable.sh // add the script to startup session. $ xfce4-session-settings utarray benchmarking Raspberry Pi 2 Model B\n(Quad-core Cortex-A7 32bits, 976MB memory, CPU clock is between 600/900MHz)\nIntel i5-8250U, Octa-core 64bits 24GB memory, CPU clock is between 400/3400MHz\nElement size = 27 bytes\n","permalink":"https://oopsmonk.github.io/posts/2018-12-01-month12/","summary":"utarray benchmarking\nWeek48~52 小筆記 bazel installation on Raspberry Pi Issue#1308\n$ sudo apt-get install build-essential openjdk-8-jdk python zip unzip $ wget https://github.com/bazelbuild/bazel/releases/download/0.19.2/bazel-0.19.2-dist.zip $ mkdir bazel-0.19.2 \u0026amp;\u0026amp; unzip ./bazel-0.19.2-dist.zip -d bazel-0.19.2 $ cd bazel-0.19.2 $ env BAZEL_JAVAC_OPTS=\u0026#34;-J-Xms384m -J-Xmx512m\u0026#34; bash ./compile.sh 🍃 Building Bazel from scratch...... 🍃 Building Bazel with Bazel. .WARNING: --batch mode is deprecated. Please instead explicitly shut down your Bazel server using the command \u0026#34;bazel shutdown\u0026#34;. INFO: Analysed target //src:bazel_nojdk (233 packages loaded, 10401 targets configured).","title":"RPi vs i5-8250U"},{"content":"Test Google Asistant on Raspberry Pi.\nWeek40~44 (10/01~10/31) 網路文章 Wi-Fi 6: What’s Different, and Why it Matters\n網路資源 Raspberry Pi BT setup\nTurn your Raspberry Pi into homemade Google Home\nGoogle Asistant SDK\nGoogle Asistant SDK C++ 使用Python lib常常會當機改用C++比較沒問題, 但C++版本有限制API使用的次數, 無法長期使用.\n","permalink":"https://oopsmonk.github.io/posts/2018-10-14-2018month10/","summary":"Test Google Asistant on Raspberry Pi.\nWeek40~44 (10/01~10/31) 網路文章 Wi-Fi 6: What’s Different, and Why it Matters\n網路資源 Raspberry Pi BT setup\nTurn your Raspberry Pi into homemade Google Home\nGoogle Asistant SDK\nGoogle Asistant SDK C++ 使用Python lib常常會當機改用C++比較沒問題, 但C++版本有限制API使用的次數, 無法長期使用.","title":"RPi Home"},{"content":"Pointers, again\u0026hellip;\nHow many pointers you can have?\nC89: 12\nWeek31~35 (07/29~08/31) 網路文章 What is the difference between const int*, const int * const, and int const *?\nRead it backwards (as driven by Clockwise/Spiral Rule):\nint* - pointer to int\nint const * - pointer to const int\nint * const - const pointer to int\nint const * const - const pointer to const int\nNow the first const can be on either side of the type so:\nconst int * == int const *\nconst int * const == int const * const\nIf you want to go really crazy you can do things like this:\nint ** - pointer to pointer to int\nint ** const - a const pointer to a pointer to an int\nint * const * - a pointer to a const pointer to an int\nint const ** - a pointer to a pointer to a const int\nint * const * const - a const pointer to a const pointer to an int\nconst X* p means \u0026ldquo;p points to an X that is const\u0026rdquo;: the X object can\u0026rsquo;t be changed via p.\nX* const p means \u0026ldquo;p is a const pointer to an X that is non-const\u0026rdquo;: you can\u0026rsquo;t change the pointer p itself, but you can change the X object via p.\nconst X* const p means \u0026ldquo;p is a const pointer to an X that is const\u0026rdquo;: you can\u0026rsquo;t change the pointer p itself, nor can you change the X object via p.\n網路資源 Stanford CS143: Compilers\n","permalink":"https://oopsmonk.github.io/posts/2018-08-22-2018month8/","summary":"Pointers, again\u0026hellip;\nHow many pointers you can have?\nC89: 12\nWeek31~35 (07/29~08/31) 網路文章 What is the difference between const int*, const int * const, and int const *?\nRead it backwards (as driven by Clockwise/Spiral Rule):\nint* - pointer to int\nint const * - pointer to const int\nint * const - const pointer to int\nint const * const - const pointer to const int\nNow the first const can be on either side of the type so:","title":"How many pointers you can have?"},{"content":"It\u0026rsquo;s blocks and no chain, keep fighting!\nWeek27~30 (07/01~27) 網路文章 IOTA Summer Summit 2018\n","permalink":"https://oopsmonk.github.io/posts/2018-06-30-2018month7/","summary":"It\u0026rsquo;s blocks and no chain, keep fighting!\nWeek27~30 (07/01~27) 網路文章 IOTA Summer Summit 2018","title":"Energetic People!"},{"content":"More bad ideas + Generosity = Good ideas\nWeek22~26 (06/01~29) 網路文章 Elon Musk emails employees about \u0026rsquo;extensive and damaging sabotage\u0026rsquo; by employee\n樹大招風\u0026hellip;.但內部管理是否有問題?\n溝通一直是最難處理的問題之一, 尤其是資訊不對等的情況下.\n網路資源 esp32-websocket\nwebsocket component for esp-idf.\n讀書心得 論文學習 ","permalink":"https://oopsmonk.github.io/posts/2018-05-29-2018month6/","summary":"More bad ideas + Generosity = Good ideas\nWeek22~26 (06/01~29) 網路文章 Elon Musk emails employees about \u0026rsquo;extensive and damaging sabotage\u0026rsquo; by employee\n樹大招風\u0026hellip;.但內部管理是否有問題?\n溝通一直是最難處理的問題之一, 尤其是資訊不對等的情況下.\n網路資源 esp32-websocket\nwebsocket component for esp-idf.\n讀書心得 論文學習 ","title":"Hell Yeah! Keep Fighting"},{"content":"Okinawa Churaumi Aquarium\nKouri Bridge - The Longest Bridge in Okinawa\nWeek18~21 (05/04~25) 網路文章 Students are being prepared for jobs that no longer exist. Here\u0026rsquo;s how that could change.\nNBC關於美國高中教育的深入報導, 提到現在的教育方式已經無法保證讓學生找到理想的工作，尤其是技職生. 文中提到几個點:\n高中準時畢業的人有84%, 後來70%直升大學. 雖然學校盡力教導讓學生面對未來, 但學校也不知將來會是如何, 因為計劃跟不上變化. “We’re preparing kids for these jobs of tomorrow, but we really don’t even know what they are,” 2016年的調查, 只有34%的高中生(12th-graders) 對學習感到興趣. 公立大學(University of Massachusetts Lowell)1年的學費大約37萬台幣($12,496USD), 私立大學(Elmhurst College)學費約140萬台幣($47,121USD), 另一所公立大學(University of Minnesota)學費約91萬台幣($30,514USD). 另外自己查了一下哈佛大學每年學費138萬台幣(46,340USD), 以上都是只有學費, 如果加上宿舍及雜費大約是202萬台幣($67,580USD). 至2017年底美國的學貸已高達1.38兆美元, 房貸8.88兆美元, 信用卡債8340億美元. 53%大學生有學貸. Ref: https://www.newyorkfed.org/newsevents/news/research/2018/rp180213 醫護助理平均年薪67萬台幣($22,600USD), 2017年金融保險業年薪中位數約306萬台幣($102，510), 科技業約303萬台幣($101，430), 政府單位約295萬台幣($98,830), 所有職業中位數約113萬台幣($37,690). Ref: https://www.bls.gov/ooh/math/actuaries.htm#tab-5 網路資源 Linux Syscall Reference\n讀書心得 如將mali gup dirver編成kernel module, gator無法支援gpu profiling, 是因為kernel 3.15-rc1後for_each_kernel_tracepoint 只能找到built-in tracepoints. 如要找module裡的tracepoints 需要使用register_tracepoint_module_notifier 及 unregister_tracepoint_module_notifier, 這樣的好處是縮小kernel image size, 及module loaded後才會做profile. 這個問題存在gator 5.x版, 後來在v6.1(Dec. 2016)已修正問題\nkernel-4.1, gatorv5.22 (2016/1/19) #if LINUX_VERSION_CODE \u0026gt;= KERNEL_VERSION(3, 15, 0) /* scan kernel built in tracepoints */ for_each_kernel_tracepoint(gator_save_tracepoint, NULL); /* register for notification of new tracepoint modules */ register_tracepoint_module_notifier(\u0026amp;tracepoint_notifier_block); #endif kernel tracepoints have become unregisterable from modules as of 3.15-rc1\n","permalink":"https://oopsmonk.github.io/posts/2018-04-30-2018month5/","summary":"Okinawa Churaumi Aquarium\nKouri Bridge - The Longest Bridge in Okinawa\nWeek18~21 (05/04~25) 網路文章 Students are being prepared for jobs that no longer exist. Here\u0026rsquo;s how that could change.\nNBC關於美國高中教育的深入報導, 提到現在的教育方式已經無法保證讓學生找到理想的工作，尤其是技職生. 文中提到几個點:\n高中準時畢業的人有84%, 後來70%直升大學. 雖然學校盡力教導讓學生面對未來, 但學校也不知將來會是如何, 因為計劃跟不上變化. “We’re preparing kids for these jobs of tomorrow, but we really don’t even know what they are,” 2016年的調查, 只有34%的高中生(12th-graders) 對學習感到興趣. 公立大學(University of Massachusetts Lowell)1年的學費大約37萬台幣($12,496USD), 私立大學(Elmhurst College)學費約140萬台幣($47,121USD), 另一所公立大學(University of Minnesota)學費約91萬台幣($30,514USD). 另外自己查了一下哈佛大學每年學費138萬台幣(46,340USD), 以上都是只有學費, 如果加上宿舍及雜費大約是202萬台幣($67,580USD). 至2017年底美國的學貸已高達1.38兆美元, 房貸8.","title":"What Does The Fox Say?"},{"content":"Algorithm, Blockchain, Coursera\n真心推Coursera上的Data Structures and Algorithms Specialization, 挑有興趣的就好.\n2017年底至今拿了4張Certifications, Algorithms on Graphs是比較有趣的課程.\n其它3張是Algorithmic Toolbox, Data Structures, Algorithms on Strings\nWeek14 (04/06) 讀書心得 Burrows-Wheeler Transform - data compression\nCyclic rotation Sorting Last column Inverting Burrows-wheeler transform\nMark the occurrence of characters Putting sorted bwt string to frist column Knuth–Morris–Pratt - string searching algorithm (or KMP algorithm)\nSuffix array - a sorted array of all suffixes of a string.\nWeek15 (04/13) Week16 (04/20) Week17 (04/27) 網路文章 World’s first IOTA Smart Charging Station\n哦哦哦！M2M.\n網路資源 IOTA Doc\nIOTA Transactions, Confirmation and Consensus\n讀書心得 初步理解The Tangle, 雖IOTA強調是應用在IoT, 但以我目前的理解要能應用在IoT device似乎還有點距離, 像arduino或raspberry pi這類的跑full node根本無法跑或很吃力, 需要再深入研究swarm/sensor node在做些什麼.\n","permalink":"https://oopsmonk.github.io/posts/2018-04-02-2018month4/","summary":"Algorithm, Blockchain, Coursera\n真心推Coursera上的Data Structures and Algorithms Specialization, 挑有興趣的就好.\n2017年底至今拿了4張Certifications, Algorithms on Graphs是比較有趣的課程.\n其它3張是Algorithmic Toolbox, Data Structures, Algorithms on Strings\nWeek14 (04/06) 讀書心得 Burrows-Wheeler Transform - data compression\nCyclic rotation Sorting Last column Inverting Burrows-wheeler transform\nMark the occurrence of characters Putting sorted bwt string to frist column Knuth–Morris–Pratt - string searching algorithm (or KMP algorithm)\nSuffix array - a sorted array of all suffixes of a string.\nWeek15 (04/13) Week16 (04/20) Week17 (04/27) 網路文章 World’s first IOTA Smart Charging Station","title":"Tangled"},{"content":"Debug, Debug, Debug\u0026hellip;, Muscle Up Tips\nWeek9 (03/02) 讀書心得 FBI談判協商術\n積極聆聽, 鏡像模仿, 極端錨點, 開放型/測試型/校準型問題, 對事不對人, 每個人都怕失去, 成見使人盲目, 假設提供指引.\nThe power of \u0026ldquo;No\u0026rdquo;, Three types of \u0026ldquo;Yes\u0026rdquo;, The power of \u0026ldquo;Right\u0026rdquo;, Emotion is one of the keys, Be Honest.\nThinking fast and slow.\nWeek10 (03/09) 網路資源 Chris Voss: Never Split the Difference\nWeek11 (03/16) 網路文章 Android Treble: blessing or trouble?\nDiving into SDCardFS: How Google’s FUSE Replacement Will Reduce I/O Overhead\nWeek12 (03/23) 網路文章 How to Perform Muscle Ups Without Wrecking Your Shoulders\nRotated Grip and Grip Width Pull Up Behind the Bar, Not Under It Use Your Legs As Counterbalance Keep Your Elbows from Lifting Up and Out Week13 (03/30) 網路資源 RIOT- The friendly OS for IoT\nRIOT provides multiple network stacks, including IPv6, 6LoWPAN, or Content centric networking and standard protocols such as RPL, User Datagram Protocol (UDP), Transmission Control Protocol (TCP), and CoAP.\nArduino這類的應用會需要OS嗎?\n","permalink":"https://oopsmonk.github.io/posts/2018-03-01-2018month3/","summary":"Debug, Debug, Debug\u0026hellip;, Muscle Up Tips\nWeek9 (03/02) 讀書心得 FBI談判協商術\n積極聆聽, 鏡像模仿, 極端錨點, 開放型/測試型/校準型問題, 對事不對人, 每個人都怕失去, 成見使人盲目, 假設提供指引.\nThe power of \u0026ldquo;No\u0026rdquo;, Three types of \u0026ldquo;Yes\u0026rdquo;, The power of \u0026ldquo;Right\u0026rdquo;, Emotion is one of the keys, Be Honest.\nThinking fast and slow.\nWeek10 (03/09) 網路資源 Chris Voss: Never Split the Difference\nWeek11 (03/16) 網路文章 Android Treble: blessing or trouble?\nDiving into SDCardFS: How Google’s FUSE Replacement Will Reduce I/O Overhead","title":"Never Split the Difference"},{"content":"Android, Chinese New Year, blockchain, Cache miss\nWeek5 (02/02) 這個月雖然有年假但比平常更忙！ 結論: 放假不一定放鬆, 想專心做事 :-)\n網路文章 Processor Pipeline\nGallery of Processor Cache Effects\nUsing Streamline to Guide Cache Optimization\n參考這篇分析Kodi17.6影片播放時的L1/L2 cache access情況, 播放2160p影片時L1/L2 data ratios不高分別在0.046/0.18, 使用Kodi18更少分別為0.041/0.16.\n另外Kodi18在記憶體使用上比17.6減少3.6%, cache miss 減少47~55%. Cache Refill Ratios算法\nL1 data ratio: $CacheDataRefill/$CacheDataAccess\nL2 data ratio: $CacheL2DataRefill/$CacheL2DataAccess\n網路資源 Blockchain Demo\n大略的介紹blockchain, 簡單明瞭.\n","permalink":"https://oopsmonk.github.io/posts/2018-01-26-2018month2/","summary":"Android, Chinese New Year, blockchain, Cache miss\nWeek5 (02/02) 這個月雖然有年假但比平常更忙！ 結論: 放假不一定放鬆, 想專心做事 :-)\n網路文章 Processor Pipeline\nGallery of Processor Cache Effects\nUsing Streamline to Guide Cache Optimization\n參考這篇分析Kodi17.6影片播放時的L1/L2 cache access情況, 播放2160p影片時L1/L2 data ratios不高分別在0.046/0.18, 使用Kodi18更少分別為0.041/0.16.\n另外Kodi18在記憶體使用上比17.6減少3.6%, cache miss 減少47~55%. Cache Refill Ratios算法\nL1 data ratio: $CacheDataRefill/$CacheDataAccess\nL2 data ratio: $CacheL2DataRefill/$CacheL2DataAccess\n網路資源 Blockchain Demo\n大略的介紹blockchain, 簡單明瞭.","title":"cache not cash..."},{"content":"Android, Algorithms\nWeek1 (01/05) 讀書心得 Algorithms on Graphs - Week5 給出座標上n個點:\n找出最短路徑(the shortest path) 分群(Clustering) 為Minimun Spanning Tree相關問題, 可以使用Kruskal’s MST Algorithm 及Disjoint-set 來解.\nfor all u ∈ V : MakeSet(v ) X ← empty set // a set with solution edges sort the edges E by weight for all {u, v } ∈ E in non-decreasing weight order: if Find(u) != Find(v): add {u, v } to X Union(u, v ) return X Week2 (01/12) 網路文章 Android编译系统中的Android.bp、Blueprint与Soong\nWeek3 (01/19) Vim tip: file encryption\nUsage :help 'cm' Set default encrypt method: :set cm=zip, :set cm=blowfish or :set cm=blowfish2\n網路文章 Preventing burnout for programmers\nTurning Design Mockups Into Code With Deep Learning\n網路資源 jq is a lightweight and flexible command-line JSON processor.\nJSON filter in command-line.\nHow can I handle command-line options and arguments in my script easily?\nParsing optional arguments in bash: \u0026lsquo;shift\u0026rsquo; and \u0026lsquo;getopts\u0026rsquo;.\n讀書心得 Deep Learning: A Critical Appraisal PFD\nWeek4 (01/26) None\n","permalink":"https://oopsmonk.github.io/posts/2018-01-02-2018month1/","summary":"Android, Algorithms\nWeek1 (01/05) 讀書心得 Algorithms on Graphs - Week5 給出座標上n個點:\n找出最短路徑(the shortest path) 分群(Clustering) 為Minimun Spanning Tree相關問題, 可以使用Kruskal’s MST Algorithm 及Disjoint-set 來解.\nfor all u ∈ V : MakeSet(v ) X ← empty set // a set with solution edges sort the edges E by weight for all {u, v } ∈ E in non-decreasing weight order: if Find(u) != Find(v): add {u, v } to X Union(u, v ) return X Week2 (01/12) 網路文章 Android编译系统中的Android.","title":"Is there a shortcut?"},{"content":"SEAndroid, Algorithms, Numpy\nAndroid N -\u0026gt; O 被自己的石頭砸到腳 對於晶片廠來說Android決解了軟體開發的問題, 也加速了ODM/OEM的開發時程.\n沒錯\u0026hellip;但對於手機/電視之外的應用..存在些問題.\n另外差異化及客制帶來些不定時炸彈.\nSepolicy for Android Treble 使用numpy array修改pixel values. 網路資源 Machine Learning 101 - Jason Mayes\nNew year\u0026rsquo;s resolutions IELTS overall 6.5 Data Structures and Algorithms Specialization Master of Computer Science in Data Science ","permalink":"https://oopsmonk.github.io/posts/2017-11-24-2017month12/","summary":"SEAndroid, Algorithms, Numpy\nAndroid N -\u0026gt; O 被自己的石頭砸到腳 對於晶片廠來說Android決解了軟體開發的問題, 也加速了ODM/OEM的開發時程.\n沒錯\u0026hellip;但對於手機/電視之外的應用..存在些問題.\n另外差異化及客制帶來些不定時炸彈.\nSepolicy for Android Treble 使用numpy array修改pixel values. 網路資源 Machine Learning 101 - Jason Mayes\nNew year\u0026rsquo;s resolutions IELTS overall 6.5 Data Structures and Algorithms Specialization Master of Computer Science in Data Science ","title":"Resolution and Revolution! "},{"content":"A Note about sepolicy in Android Oreo.\nFirst thing first SELinux documents:\nSELinux for Android 8.0 What is SELinux? What is SEAndroid? SELinux Policy Concepts and Overview Android sepolicy files Policy path: /system/sepolicy BOARD_SEPOLICY_DIR (device/$VENDOR/$DEVICE/sepolicy/, device/$VENDOR/$DEVICE/common/sepolicy/) Policy Macros: system/sepolicy/public/te_macros system/sepolicy/public/global_macros system/sepolicy/public/ioctl_macros system/sepolicy/public/neverallow_macros system/sepolicy/private/mls_macros system/sepolicy/reqd_mask/mls_macros Security Context: file_contexts, labeling files infilesystem. property_contexts, labeling android system/vendor properties genfs_contexts, Pre-file labeling for /proc files, generic filesystem security contexts. seapp_contexts, used by zygote and installd via libselinux, mapping app UID andseinfofor /data/data directory hwservice_contexts, for hwservice manager to check vndservice_contestx, for vndservice manager to check service_contexts, for service manager to check Type Enforcement *.te Composing Policy for Android trebel Add domains for a service\nAdd security context depend on service type:\nHardware service\nDefine service type in hwservice.te\ntype vnd_foo_hwservice, hwservice_manager_type;\nLabeling hwservice in hwservice_contexts\nvendor.realtek.foo::IfooAPI u:object_r:vnd_foo_hwservice:s0 Vendor service Define service type in vndservice.te\ntype foo_service, vndservice_manager_type; Labeling vndservice in vndservice_contexts\nfooservice u:object_r:foo_service:s0 System service Define service type in service.te\ntype foo_service, service_manager_type; Labeling system service in service_contexts\nfooservice u:object_r:foo_service:s0 Add domain and type enforcement configuration\nCreate new foo.te file\nDefine service doamin and file attributes\ntype foo, domain; type foo_exec, exec_type, vendor_file_type, file_type; init_daemon_domain(foo) Add file security context in file_contexts\n/vendor/bin/foo u:object_r:foo_exec:s0 Building policy files There are typically seven SELinux related files under an Android device (see more details here):\nselinux_version sepolicy: binary output after combining policy files (security_classes, initial_sids, *.te, etc) file_contexts property_contexts seapp_contexts service_contexts system/etc/mac_permissions.xml Building file_contexts.bin find file_contexts in /system/sepolicy and BOARD_SEPOLICY_DIR\noutput files:\nout/target/product/$DEVICE/obj/ETC/nonplat_file_contexts_intermediates/nonplat_file_contexts\nout/target/product/$DEVICE/obj/ETC/plat_file_contexts_intermediates/plat_file_contexts\nbinary file:\nout/target/product/$DEVICE/obj/ETC/file_contexts.bin_intermediates/file_contexts.bin\ninstall to root/file_contexts.bin\nBuilding policy configuration find security_classes, initial_sids, *.te, genfs_contexts, and port_contexts in /system/sepolicy and BOARD_SEPOLICY_DIR\nconfigure file:\nout/target/product/$DEVICE/obj/ETC/plat_sepolicy.cil_intermediates/plat_policy.conf\nout/target/product/$DEVICE/obj/ETC/nonplat_sepolicy.cil_intermediates/nonplat_policy.conf\nout/target/product/$DEVICE/obj/ETC/general_sepolicy.conf_intermediates/general_sepolicy.conf\ninstall to /root/sepolicy\n","permalink":"https://oopsmonk.github.io/posts/2017-12-20-sepolicy-for-android-treble/","summary":"A Note about sepolicy in Android Oreo.\nFirst thing first SELinux documents:\nSELinux for Android 8.0 What is SELinux? What is SEAndroid? SELinux Policy Concepts and Overview Android sepolicy files Policy path: /system/sepolicy BOARD_SEPOLICY_DIR (device/$VENDOR/$DEVICE/sepolicy/, device/$VENDOR/$DEVICE/common/sepolicy/) Policy Macros: system/sepolicy/public/te_macros system/sepolicy/public/global_macros system/sepolicy/public/ioctl_macros system/sepolicy/public/neverallow_macros system/sepolicy/private/mls_macros system/sepolicy/reqd_mask/mls_macros Security Context: file_contexts, labeling files infilesystem. property_contexts, labeling android system/vendor properties genfs_contexts, Pre-file labeling for /proc files, generic filesystem security contexts. seapp_contexts, used by zygote and installd via libselinux, mapping app UID andseinfofor /data/data directory hwservice_contexts, for hwservice manager to check vndservice_contestx, for vndservice manager to check service_contexts, for service manager to check Type Enforcement *.","title":"Sepolicy for Android Treble"},{"content":"SELinux, Arm Tech Symposia 2017 Taiwan, golang, IoT\nWeek44 (11/03) 網路資源 Firmware Updates over Low-Power Wide Area Networks\nEnabling firmware updates over LPWAN\nARMmbed/lorawan-fota-demo\n滿有趣的問題, IoT建置會預期device要能長達10年的壽命, 但10年間的變化是很大的.\nWeek45 (11/10) 網路文章 Android SELinux Treble\nAndroid O 為了加速產品開發, 在framework上有重大的改變, 使用了Treble.\nVender, ODM, OEM有各自需要維護的partitions.\nWeek46 (11/17) 網路文章 Neural fuzzing: applying DNN to software security testing\n好奇其它的nural networks的應用, 常看到CNN.\n網路資源 hacdias/filemanager\n感覺不錯用的web filemanager, 目前很有活力, 送了一個PR不到1天就被merge了.\n讀書心得 因為把玩hacdias/filemanager看了一下A Tour of Go在語法上還不太能適應, 不過還滿容易上手的, Method跟Interface的用法還要再研究一下, Concurrency也要花一點時間了解, 必竟concurrency是最大的賣點吧!\n還有python使用上會有package dependency問題有點頭痛, golang編成binray的方式可以省掉這個麻煩, but 要如何方便的debug web front-end? 這可能要看一下go.rice.\n但魚與熊掌仍不可兼得\u0026hellip;package dependency, cross-platform, realtime debug.\nPolicy Configuration of SELinux and SEAndroid\nWeek47 (11/24) 網路文章 Bundle HTML, CSS, And JavaScript To Be Served In A Golang Application\nThe 6 Simple Steps Elon Musk Uses to Solve Any Problem\nAsk a question. Gather as much evidence as possible about it. Develop hypotheses based on the evidence. Draw a conclusion. Attempt to disprove the conclusion. If nobody can invalidate your conclusion, then you\u0026rsquo;re probably right. 讀書心得 What is domain transitions? SELinux/Tutorials/How does a process get into a certain context\nSELinux by default inherits contexts, be it from processes (on fork) or parent files/directories\nContexts of processes can change on execute of a command from that process\u0026rsquo; context, but only under the conditions that\nthe target file context is executable for the source domain the target file context is marked as an entrypoint for the target domain the source domain is allowed to transition to the target domain What are xxx_contexts?? securty context file. file_contexts, labeling files in filesystem. property_contexts, labeling android system/vendor properties\ngenfs_contexts, Pre-file labeling for /proc files, generic filesystem security contexts.\nseapp_contexts, used by zygote and installd via libselinux, mapping app UID and seinfo for /data/data directory\nhwservice_contexts, for hwservicemanager to check\nvndservice_contestx, for vndservicemanager to check\n*.te, Type Enforcement configuration, define policy for file type, process domain\n","permalink":"https://oopsmonk.github.io/posts/2017-10-27-2017month11/","summary":"SELinux, Arm Tech Symposia 2017 Taiwan, golang, IoT\nWeek44 (11/03) 網路資源 Firmware Updates over Low-Power Wide Area Networks\nEnabling firmware updates over LPWAN\nARMmbed/lorawan-fota-demo\n滿有趣的問題, IoT建置會預期device要能長達10年的壽命, 但10年間的變化是很大的.\nWeek45 (11/10) 網路文章 Android SELinux Treble\nAndroid O 為了加速產品開發, 在framework上有重大的改變, 使用了Treble.\nVender, ODM, OEM有各自需要維護的partitions.\nWeek46 (11/17) 網路文章 Neural fuzzing: applying DNN to software security testing\n好奇其它的nural networks的應用, 常看到CNN.\n網路資源 hacdias/filemanager\n感覺不錯用的web filemanager, 目前很有活力, 送了一個PR不到1天就被merge了.\n讀書心得 因為把玩hacdias/filemanager看了一下A Tour of Go在語法上還不太能適應, 不過還滿容易上手的, Method跟Interface的用法還要再研究一下, Concurrency也要花一點時間了解, 必竟concurrency是最大的賣點吧!","title":"Preparing a preparation?! It's nonsense..."},{"content":"A Note for SELinux and SEAndroid policy configuration.\nSEAndroid Security-Enhanced Linux in Android\nSELinux for Android 8 - Treble mode\nSEAndroid安全機制中的文件安全上下文關聯分析 - file_context\nSEAndroid安全機制中的進程安全上下文關聯分析 - process\nAndroid 8 Treble mode: Kernel early mount PRODUCT_FULL_TREBLE, PRODUCT_FULL_TREBLE_OVERRIDE, BOARD_SEPOLICY_DIRS Android 4.3 ~ 6 TE macro define: external/sepolicy/te_macros\nAndroid 8 TE macro define: system/sepolicy/te_macros\n##################################### # domain_trans(olddomain, type, newdomain) # Allow a transition from olddomain to newdomain # upon executing a file labeled with type. # This only allows the transition; it does not # cause it to occur automatically - use domain_auto_trans # if that is what you want. # define(`domain_trans\u0026#39;, ` # Old domain may exec the file and transition to the new domain. allow $1 $2:file { getattr open read execute }; allow $1 $3:process transition; # New domain is entered by executing the file. allow $3 $2:file { entrypoint open read execute getattr }; # New domain can send SIGCHLD to its caller. ifelse($1, `init\u0026#39;, `\u0026#39;, `allow $3 $1:process sigchld;\u0026#39;) # Enable AT_SECURE, i.e. libc secure mode. dontaudit $1 $3:process noatsecure; # XXX dontaudit candidate but requires further study. allow $1 $3:process { siginh rlimitinh }; \u0026#39;) ##################################### # domain_auto_trans(olddomain, type, newdomain) # Automatically transition from olddomain to newdomain # upon executing a file labeled with type. # define(`domain_auto_trans\u0026#39;, ` # Allow the necessary permissions. domain_trans($1,$2,$3) # Make the transition occur by default. type_transition $1 $2:process $3; \u0026#39;) ##################################### # tmpfs_domain(domain) # Define and allow access to a unique type for # this domain when creating tmpfs / shmem / ashmem files. define(`tmpfs_domain\u0026#39;, ` type $1_tmpfs, file_type; type_transition $1 tmpfs:file $1_tmpfs; allow $1 $1_tmpfs:file { read write getattr }; allow $1 tmpfs:dir { getattr search }; \u0026#39;) ##################################### # init_daemon_domain(domain) # Set up a transition from init to the daemon domain # upon executing its binary. define(`init_daemon_domain\u0026#39;, ` domain_auto_trans(init, $1_exec, $1) tmpfs_domain($1) \u0026#39;) apol - SELinux policy analysis tool sudo apt install setools-gui SELinux Configuring the SELinux Policy\nSecurity context: subject(process) and object(file, socket, IPC object\u0026hellip;) in the system is assigned a collection of security attributes.\nSecurity identifiers (SIDs): an integer that is mapped by the security server to a security context at runtime.\nThe policy configuration sources must be compiled into a binary representation before it can be read by the kernel.\nThe policy compilation involves three steps:\nall configuration files are concatenated together. m4 marco processor is applied to the resulting concatenation to expand macros. checkpolicy policy compiler run to generate the binary representation. Applying the File Contexts, restorecon utility can be run to restore a specific list of files to their original settings from the file contexts configuration.\nThe chcon utility is used to set the security context of a file to a specified value. The usage is similar to the chown or chmod\naudit: type=1400 audit(1388534435.223:4): avc: denied { read } for pid=1643 comm=\u0026#34;resize2fs\u0026#34; name=\u0026#34;__properties__\u0026#34; dev=\u0026#34;tmpfs\u0026#34; ino=1078 scontext=u:r:init_resize:s0 tcontext=u:object_r:properties_device:s0 tclass=dir permissive=0 // The init_resize domain is being denied permissions to read with the properties_device type. audit: type=1400 audit(1388534435.223:5): avc: denied { open } for pid=1643 comm=\u0026#34;resize2fs\u0026#34; path=\u0026#34;/proc/stat\u0026#34; dev=\u0026#34;proc\u0026#34; ino=4026532361 scontext=u:r:init_resize:s0 tcontext=u:object_r:proc_stat:s0 tclass=file permissive=0 // The init_resize domain is being denied permissions to open with the proc_stat type. type=1400 audit(1388534436.507:69): avc: denied { read write } for pid=1771 comm=\u0026#34;android.hardwar\u0026#34; name=\u0026#34;vndbinder\u0026#34; dev=\u0026#34;tmpfs\u0026#34; ino=2351 scontext=u:r:hal_graphics_composer_default:s0 tcontext=u:object_r:vndbinder_device:s0 tclass=chr_file permissive=0 // The hal_graphics_composer_default domain is being denied permissions to read and write with the vndbinder_device type. type=1400 audit(1388534436.571:70): avc: denied { execute } for pid=1778 comm=\u0026#34;surfaceflinger\u0026#34; path=\u0026#34;/vendor/lib/hw/android.hardware.graphics.allocator@2.0-impl.so\u0026#34; dev=\u0026#34;mmcblk0p17\u0026#34; ino=388 scontext=u:r:surfaceflinger:s0 tcontext=u:object_r:vendor_file:s0 tclass=file permissive=0 // The surfaceflinger domain is being denied permissions to execute with the vendor_file type. scontext: the source security context\ntcontext: the target security context\ntclass: the target security class\nTE Statements Attribute Declarations\nA type attribute is a name that can be used to identify a set of types with a similar property.\nattribute domain; attribute privuser; attribute privrole; Type Declarations\nThe TE configuration language requires that every type be declared.\nEach type declaration specifies a primary name for the type, an optional set of aliases for the type, and an optional set of attributes for the type.\nDuring runtime, the example security server always uses the primary name to identify the type when it returns the security context for a SID.\nAliases can be used to provide shorthand forms or synonyms for a type, but have no significance from a security perspective. Primary names and alias names exist in a single type name space and must all be unique.\ntype sshd_t, domain, privuser, privrole, privlog, privowner; type sshd_exec_t, file_type, exec_type, sysadmfile; type sshd_tmp_t, file_type, sysadmfile, tmpfile; type sshd_var_run_t, file_type, sysadmfile, pidfile; The sshd_t type is the domain of the daemon process. The sshd_exec_t type is the type of the sshd executable.\nThe sshd_tmp_t and sshd_var_run_t types are the types for temporary files and PID files, respectively, that are created by the daemon process.\nEach of these types has a set of associated attributes that are used in rules within the TE configuration.\nTE Transition Rules\nTE transition rules specify the new domain for a process or the new type for an object.\nCreate new domain\nCreate new xxx.te file for the process Add TE declaration and rules Ex:\n# file name: logrotate.te # new type declaration type logrotate_t, domain, privowner; type logrotate_exec_t, file_type, sysadmfile, exec_type; # grant new domain via macro general_domain_access(logrotate_t) app_domain(logrotate_t) init_daemon_domain(logrotate_t) # permission rules allow logrotate_t var_log_t:dir rw_dir_perms; allow logrotate_t var_log_t:file create_file_perms; Case study on Android Oreo Computing context error: invalid_context\ninit: Context getfilecon init: security_compute_create type=1401 audit(1388534436.075:60): op=security_compute_sid invalid_context=u:r:vendor:s0 scontext=u:r:init:s0 tcontext=u:object_r:vendor_exec:s0 tclass=process init: mycon u:r:init:s0 , filecon u:object_r:vendor_exec:s0 , Context rc = -1 init: could not get context while starting \u0026#39;seserver\u0026#39; Solution:\nCreate TE configuration file and new domain for seserver\n# file name: seserver.te type seserver, domain; type seserver_exec, exec_type, vendor_file_type, file_type; init_daemon_domain(seserver) allow seserver vndbinder_device:chr_file ioctl; ","permalink":"https://oopsmonk.github.io/posts/2017-11-17-policy-configuration-of-selinux-and-seandroid/","summary":"A Note for SELinux and SEAndroid policy configuration.\nSEAndroid Security-Enhanced Linux in Android\nSELinux for Android 8 - Treble mode\nSEAndroid安全機制中的文件安全上下文關聯分析 - file_context\nSEAndroid安全機制中的進程安全上下文關聯分析 - process\nAndroid 8 Treble mode: Kernel early mount PRODUCT_FULL_TREBLE, PRODUCT_FULL_TREBLE_OVERRIDE, BOARD_SEPOLICY_DIRS Android 4.3 ~ 6 TE macro define: external/sepolicy/te_macros\nAndroid 8 TE macro define: system/sepolicy/te_macros\n##################################### # domain_trans(olddomain, type, newdomain) # Allow a transition from olddomain to newdomain # upon executing a file labeled with type.","title":"Policy Configuration of SELinux and SEAndroid"},{"content":"Some metrics for ARM Mali performance analysis in DS-5 Streamline or MGD.\nDS-5 Streamline Mali-470 (Utgard) GPU Bandwidth = (Words read, master + Words written, master) * Bus Width\nOverdraw = Fragments Passed Z/stencil count * Number of Cores / Resolution * FPS\nGPU Bandwidth = (38342943+38661456) * (128/8) = 1232070384 bytes/s = 1174.99 MB/s Overdraw = (79194586+79152584+79112550+79117609)/(1920x1080) = 152.67\nMali-T820 (Midgard) Job Slots\nJS0: fragment shading. JS1: vertex, geometry, compute, and tiling. JS2: vertex, geometry, and compute. Fragment Percentage = (JS0 Active / GPU frequency) * 100\nVertex percentage = (JS1 Active / Frequency) * 100\nLoad Store CPI = Full Pipeline issues / Load Store Instruction Words Completed\nGPU Bandwidth = (External read beats + External write beats) * Bus Width\nOverdraw = Fragment Threads Started * Number of Cores/ Resolution * FPS\nGPU Bandwidth = (35942654+29615172) * (128/8) = 1048925216 bytes/s = 1000.33 MB/s\nFragment Percentage = (10347901 / 10351030) * 100 = 99.96%\nVertex percentage = ( 1635340 / 10351030) * 100 = 15.79%\nMali Graphic Debugger(MGD) GPU Budget\nTotal vertex cycle count/frame/pixel = vertex cycles / frame buffer pixels\nTotal fragment cycle count/frame/pixel = fragment cycles / frame buffer pixels\nTotal cycle count/frame/pixel = fragment cycle + vertex cycle\nMali-470 (Utgard) T470MP4@750MHz with 1920x1080 resolution, application rendering framebuffer 512x512.\nTotal vertex cycle count/frame/pixel = 1224001 / (512 * 512) ~= 4.66 cycles/frame/pixel\nTotal fragment cycle count/frame/pixel = 6429459 / (512 * 512) = 24.52 cycles/frame/pixel\nTotal cycle count/frame/pixel = 24.52+4.66 = 29.18 cycles/frame/pixel\nvertexCycleBudget = (750M cycles/sec) / (60 frames/sec * 108926) = 114.75 cycles/frame/vertex\nMali-T820 (Midgard) T820MP3@620MHz with 1920x1080 resolution, application rendering framebuffer 512x512.\nTotal vertex cycle count/frame/pixel = 919273 / (512 * 512) = 3.5 cycles/frame/pixel\nTotal fragment cycle count/frame/pixel = 6713456 / (512 * 512) = 25.6 cycles/frame/pixel\nTotal cycle count/frame/pixel = 29.1 cycles/frame/pixel\nvertexCycleBudget = (620M * 3 cycles/sec) / (60 frames/sec * 92141) = 672.88 cycles/frame/vertex\nReferences:\nGPU Processing Budget Approach to Game Development\nMali Midgard Family Performance Counters\nUsing Streamline to Guide Cache Optimization\nMali GPU Tools: A Case Study, Part 1\nUsing Streamline to Optimize Applications for Mali GPUs\nPerformance Analysis and Debugging with Mali.pdf\n","permalink":"https://oopsmonk.github.io/posts/2017-11-01-arm-mali-profiling-metrics/","summary":"Some metrics for ARM Mali performance analysis in DS-5 Streamline or MGD.\nDS-5 Streamline Mali-470 (Utgard) GPU Bandwidth = (Words read, master + Words written, master) * Bus Width\nOverdraw = Fragments Passed Z/stencil count * Number of Cores / Resolution * FPS\nGPU Bandwidth = (38342943+38661456) * (128/8) = 1232070384 bytes/s = 1174.99 MB/s Overdraw = (79194586+79152584+79112550+79117609)/(1920x1080) = 152.67\nMali-T820 (Midgard) Job Slots\nJS0: fragment shading. JS1: vertex, geometry, compute, and tiling.","title":"ARM Mali Profiling Metrics"},{"content":"ARM performance, Algorithms\nIn fact, there is no universal benchmark tool.\nWeek40 (10/06) 網路文章 Why do we learn algorithms?\nWhy do we need so many sorting algorithms?\nWhy do we need to learn different sorting algorithms when the STL sort function is already available to us in C++?\n網路資源 The Algorithms\n不同程式語言演算法的實現.\nevery-programmer-should-know\nData Structure Visualizations\n演算法視覺化\nWeek41 (10/13) 網路文章 GPU Processing Budget Approach to Game Development\nGPU budget是估算處理1 pixel的cycle cost, 單位是cycles/frame/pixel\n先估算fragment/vertex budget理論值再透過MGD分析當下的budget做比較, 如MGD算出來的budget較高, 表示GPU loading過重.\nWeek42 (10/20) 網路文章 Analyzing Performance of Mobile Games\n透過DS-5 Streamline分析GUP/CPU/Bandwidth bound, GPU在不同的架構(Utgard, Midgard)下需要使用不同的算法.\nWeek43 (10/27) 網路文章 Regular Expressions in Programming Languages: The Story of C++\n","permalink":"https://oopsmonk.github.io/posts/2017-09-29-2017month10/","summary":"ARM performance, Algorithms\nIn fact, there is no universal benchmark tool.\nWeek40 (10/06) 網路文章 Why do we learn algorithms?\nWhy do we need so many sorting algorithms?\nWhy do we need to learn different sorting algorithms when the STL sort function is already available to us in C++?\n網路資源 The Algorithms\n不同程式語言演算法的實現.\nevery-programmer-should-know\nData Structure Visualizations\n演算法視覺化\nWeek41 (10/13) 網路文章 GPU Processing Budget Approach to Game Development\nGPU budget是估算處理1 pixel的cycle cost, 單位是cycles/frame/pixel","title":"What's wrong with benchmarks?"},{"content":"I have a build environment with make4.1 and JDK8 for Android N/O, but JDK6 and make3.81 are required by Android KitKat.\nHere is a way to create a clean environment for Android KK.\nCreate a new environment in current Ubuntu 16.04 install schroot and debootstrap\nsudo apt install schroot debootstrap\nif xenial no exist, update to latest version of debootstrap\nls -l /usr/share/debootstrap/scripts/xenial\nConfigure new environment edit /etc/schroot/schroot.conf\n[Build_KK] description=ubuntu16.04 Android_KK type=directory directory=/srv/chroot/Build_KK users=oopsmonk groups=oopsmonk root-groups=root profile=default Adding Mount points edit /etc/schroot/default/fstab\n/opt /opt none rw,bind\t0 0 /home/oopsmonk/2t /home/oopsmonk/2t none rw,bind 0\t0 Installing new system $ mkdir -p /srv/chroot/Build_KK $ sudo debootstrap --arch amd64 xenial /srv/chroot/Build_KK/ http://archive.ubuntu.com/ubuntu Using new environment Login to new environment\n$ schroot -c Build_KK -u oopsmonk Install packages edit /etc/apt/sources.list\ndeb http://archive.ubuntu.com/ubuntu xenial main\nchange to\ndeb http://archive.ubuntu.com/ubuntu xenial main restricted universe\n$ sudo apt update $ sudo apt install curl git subversion python wget xz-utils vim make ccache cmake lsof unzip u-boot-tools zip m4 bison $ sudo apt install g++-multilib gcc-multilib lib32ncurses5-dev lib32readline-dev lib32z1-dev libxml2-utils bc $ sudo apt install xsltproc flex gperf $ wget https://bootstrap.pypa.io/get-pip.py $ sudo python get-pip.py JDK6 for Android KK Put JDKs in /opt that we can share with the original env or the third env and it can reduce HDD space for creating new envs.\nunzip sun-jdk-1.6.0.37.tgz to /opt/\n$ sudo update-alternatives --install /usr/bin/javac javac /opt/sun-jdk-1.6.0.37/bin/javac 0 $ sudo update-alternatives --install /usr/bin/java java /opt/sun-jdk-1.6.0.37/bin/java 0 $ sudo update-alternatives --install /usr/bin/javaws javaws /opt/sun-jdk-1.6.0.37/bin/javaws 0 Make 3.81 for Android KK $ wget \u0026#34;http://ftp.gnu.org/gnu/make/make-3.81.tar.bz2\u0026#34; $ tar xjf make-3.81.tar.bz2 $ cd make-3.81 $ ./configure \u0026amp;\u0026amp; make $ sudo make install $ hash -r make $ make --version GNU Make 3.81 Copyright (C) 2006 Free Software Foundation, Inc. This is free software; see the source for copying conditions. There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. Ready to build!\nIn this case, 881MB is used by the new environment, so we should reserve 1GB space or more for creating a new environment.\n$ sudo du -hs /srv/chroot/Build_KK 881M /srv/chroot/Build_KK ","permalink":"https://oopsmonk.github.io/posts/2017-10-24-building-different-android-version/","summary":"I have a build environment with make4.1 and JDK8 for Android N/O, but JDK6 and make3.81 are required by Android KitKat.\nHere is a way to create a clean environment for Android KK.\nCreate a new environment in current Ubuntu 16.04 install schroot and debootstrap\nsudo apt install schroot debootstrap\nif xenial no exist, update to latest version of debootstrap\nls -l /usr/share/debootstrap/scripts/xenial\nConfigure new environment edit /etc/schroot/schroot.conf\n[Build_KK] description=ubuntu16.04 Android_KK type=directory directory=/srv/chroot/Build_KK users=oopsmonk groups=oopsmonk root-groups=root profile=default Adding Mount points edit /etc/schroot/default/fstab","title":"Building Different Android Version Using schroot"},{"content":"Jigsaw Puzzle, Hidden layers, New SoC, Algorithm basics, HTC\nWeek35 (09/01) 第一次完成520片的拼圖, 花了4個晚上的時間, 大約12小時吧?!\n下次記得顏色鮮明的圖會比較愜意些.\nWeek36 (09/08) 網路文章 Credit firm Equifax says 143m Americans\u0026rsquo; social security numbers exposed in hack\n在新聞公開前高層就己賣掉市值1.8m的股票!!\n網路資源 Google Developer Documentation Style Guide\nGoogle公佈了內部文件撰寫的格式及注意事項.\nNeural Networks and Deep Learning - Week 3 Tuning hidden layer size\niterations: 5000\nlearning_rate: 1.2\nactivation: sigmoid\nAccuracy for 1 hidden units: 67.5 % Accuracy for 2 hidden units: 67.25 % Accuracy for 3 hidden units: 90.75 % Accuracy for 4 hidden units: 90.5 % Accuracy for 5 hidden units: 91.25 % Accuracy for 20 hidden units: 90.0 % Accuracy for 50 hidden units: 90.25 % Interpretation:\nThe larger models (with more hidden units) are able to fit the training set better, until eventually the largest models overfit the data. The best hidden layer size seems to be around n_h = 5. Indeed, a value around here seems to fits the data well without also incurring noticable overfitting. You will also learn later about regularization, which lets you use very large models (such as n_h = 50) without much overfitting. Optional questions:\nWhat happens when you change the tanh activation for a sigmoid activation or a ReLU activation? Play with the learning_rate. What happens? What if we change the dataset? 這個case在hidden layers為3,4,5時看起來差異不大, 15層時就有overfit發生. Week37 (09/15) 每次有新的IC出來暫存器多少會有些改動, 讓tool透過chip id去解決相容性問題, 到最後多少會有些歷史的包袱.\n之後再多出個几顆就需要重構, 否則爾後解決相容性的問題會越來越花時間.\nC -\u0026gt; python -\u0026gt; javascript -\u0026gt; HTML 這之間資料的處理是個頭痛的問題.\n這週就在看spec, 開發新功能及相容性上渡過了, 處理相容性的時間佔了10%左右, 可喜可賀.\nWeek38 (09/22) 網路文章 The definitive guide on how to use static, class or abstract methods in Python\nWhat is the unbound method in python2 and python3?? decorators for method: static, abstract, class.\n網路資源 Sketchpad 可以在browser上直接畫圖的工具, 很多筆刷可以選.\n目前是4.1版, export出來的Drawing.shetchpad 似乎不能再import回去, 這檔unzip後是sketch.json看起來像是記錄座標及功能, upload sketch.json也沒有反應. 讀書心得 一般在學習演算法會用到的:\nMathematics\nAlgebra: linear equations, invert a matrix, find the rank of a matrix, compute the determinat of a matrix, all of the above can be done with Gaussian elimination. Number Theory: Greatest Common Divisor(GCD), Euclidean Algorithm, Congruence \u0026amp; Modulo Operation, Multiplicative Inverse, Chinese Remainder Theorem Combinatorics: Binomial Coefficients, Fibonacci Sequence, Closed Form Geometry: 2D Vector Operations, Line-Line Intersection, Circumcircle of a Triangle, Area of a Triangle, Area of a Simple Polygon Data Structures\nQueue \u0026amp; Stack Heap \u0026amp; Priority Queue Union-Find Structure (Disjoint-set data structure) Binary Search Tree (BST) Fenwick Tree Lowest Common Ancestor (LCA) Reference: CS 97SI: Introduction to Programming Contests\nWeek35 (09/29) 網路文章 Google signs agreement with HTC, continuing our big bet on hardware\nMotorola redux? Google appears set to buy HTC\nHTC員工去Google薪水多50萬？聘書洩底\nOops\u0026hellip;.Google might buy a dying Android OEM again.\n總之看好唱衰的都有\u0026hellip;Google也不是第一次買硬體了, 這次向\u0026quot;世界工廠\u0026quot;又邁了一大步.\n之前M公司12.5B轉手價2.9B給L公司.\n這次H入手價1.1B, 說好不是\u0026rsquo;acquisition\u0026rsquo;, 買人不買技術??\n讀書心得 Power Verbs in English\nPower Verbs for Resume Writing\nDROVE, LAUNCHED, JUMP-STARTED, PIONEERED, EXECUTED\nSPEARHEADED, CREATED, INITIATED, ACCELERATED, CONSOLIDATED\nAction Verbs\nPower/Action verbs 要有基本的了解\n","permalink":"https://oopsmonk.github.io/posts/2017-08-29-2017month9/","summary":"Jigsaw Puzzle, Hidden layers, New SoC, Algorithm basics, HTC\nWeek35 (09/01) 第一次完成520片的拼圖, 花了4個晚上的時間, 大約12小時吧?!\n下次記得顏色鮮明的圖會比較愜意些.\nWeek36 (09/08) 網路文章 Credit firm Equifax says 143m Americans\u0026rsquo; social security numbers exposed in hack\n在新聞公開前高層就己賣掉市值1.8m的股票!!\n網路資源 Google Developer Documentation Style Guide\nGoogle公佈了內部文件撰寫的格式及注意事項.\nNeural Networks and Deep Learning - Week 3 Tuning hidden layer size\niterations: 5000\nlearning_rate: 1.2\nactivation: sigmoid\nAccuracy for 1 hidden units: 67.5 % Accuracy for 2 hidden units: 67.25 % Accuracy for 3 hidden units: 90.","title":"Waterline?"},{"content":"Install caffe framework and run Faster R-CNN demo on Ubuntu 16.04.\nTest environment CPU: Intel(R) Core(TM) i3-4130 CPU @ 3.40GHz 4-Cores\nGPU: ASUSTeK GeForce GTX 1060 with 6GB Memory\nHD: WDC WD5000AAKX\nOS: Ubuntu 16.04\nTest Flow Install software requirement Video pre-processing: get jpeg images from source video Image Labeling Use Faster R-CNN to genrate trained model Run Faster R-CNN demo Requirement Hardware:\nGood graphic card with large memory (6GB memory is okay, but it has problem in VGG traing.)\nSoftware:\nNvidia Driver CUDA 8.0 Python Packages OpenBLAS Caffe and pycaffe Install Software Requirements Update Nvidia Driver\nhttps://launchpad.net/~graphics-drivers/+archive/ubuntu/ppa\nsudo add-apt-repository ppa:graphics-drivers/ppa sudo apt-get update sudo apt-get install nvidia-375 #You can use the latest one. # reboot system Install commands: Install.txt\nTraining data setup Generate image samples from video import cv2 print(cv2.__version__) vidcap = cv2.VideoCapture(\u0026#39;video_file.mp4\u0026#39;) success,image = vidcap.read() count = 0 success = True while success: success,image = vidcap.read() print \u0026#39;Read a new frame: \u0026#39;, success cv2.imwrite(\u0026#34;frame%d.jpg\u0026#34; % count, image) # save frame as JPEG file count += 1 Image label tool https://github.com/tzutalin/labelImg\nTraining dataset setup Put all image files in\npy-faster-rcnn/data/VOCdevkit2007/VOC2007/JPEGImages\nPut all annotation files in\npy-faster-rcnn/data/VOCdevkit2007/VOC2007/Annotations\nGenerate test.txt, train.txt, trainval.txt, val.txt by these rules:\ntrainval.txt: ½ of the whole dataset\ntest.txt: ½ of the whole dataset\ntrain.txt: ½ of the trainval.txt val.txt: ½ of the trainval.txt\nIn my case:\nAnnotation files: 241 JPEJImage files: 362 test.txt: 116 samples train.txt: 62 samples trainval.txt: 125 samples val.txt: 62 samples py-faster-rcnn/data/VOCdevkit2007/VOC2007/ ├── Annotations │ └── *.xml ├── Annotations-back ├── ImageSets │ └── Main │ ├── test.txt │ ├── train.txt │ ├── trainval.txt │ └── val.txt └── JPEGImages └── *.jpg Part of test.txt\nframe1230 frame1240 frame1260 frame1370 frame1380 frame1390 frame1400 frame1410 frame1420 frame1430 ... 116 lines Part of train.txt\nframe1210 frame1250 frame1280 frame1300 frame1320 frame1340 frame1360 frame2040 ... 62 lines Part of trainval.txt\nframe1200 frame1210 frame1220 frame1250 frame1270 frame1280 frame1290 frame1300 frame1310 ... 125 lines Part of val.txt\nframe1200 frame1220 frame1270 frame1290 frame1310 frame1330 frame1350 frame2030 frame2050 ... 63 lines ZF model configure My clases number is 6, including the background class:\nModify num_classes to 6 Modify num_output in the cls_score layer to 6 Modify num_output in the bbox_pred layer to 4 * 6 diff --git a/models/pascal_voc/ZF/faster_rcnn_alt_opt/faster_rcnn_test.pt b/models/pascal_voc/ZF/faster_rcnn_alt_opt/faster_rcnn_test.pt index b24aae4..fc1d677 100644 --- a/models/pascal_voc/ZF/faster_rcnn_alt_opt/faster_rcnn_test.pt +++ b/models/pascal_voc/ZF/faster_rcnn_alt_opt/faster_rcnn_test.pt @@ -303,7 +303,7 @@ layer { bottom: \u0026#34;fc7\u0026#34; top: \u0026#34;cls_score\u0026#34; inner_product_param { - num_output: 21 + num_output: 6 } } layer { @@ -312,7 +312,7 @@ layer { bottom: \u0026#34;fc7\u0026#34; top: \u0026#34;bbox_pred\u0026#34; inner_product_param { - num_output: 84 + num_output: 24 } } layer { diff --git a/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_fast_rcnn_train.pt b/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_fast_rcnn_train.pt index 3d98184..d7c7f26 100644 --- a/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_fast_rcnn_train.pt +++ b/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_fast_rcnn_train.pt @@ -11,7 +11,7 @@ layer { python_param { module: \u0026#39;roi_data_layer.layer\u0026#39; layer: \u0026#39;RoIDataLayer\u0026#39; - param_str: \u0026#34;\u0026#39;num_classes\u0026#39;: 21\u0026#34; + param_str: \u0026#34;\u0026#39;num_classes\u0026#39;: 6\u0026#34; } } @@ -244,7 +244,7 @@ layer { param { lr_mult: 1.0 } param { lr_mult: 2.0 } inner_product_param { - num_output: 21 + num_output: 6 weight_filler { type: \u0026#34;gaussian\u0026#34; std: 0.01 @@ -263,7 +263,7 @@ layer { param { lr_mult: 1.0 } param { lr_mult: 2.0 } inner_product_param { - num_output: 84 + num_output: 24 weight_filler { type: \u0026#34;gaussian\u0026#34; std: 0.001 diff --git a/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_rpn_train.pt b/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_rpn_train.pt index adf8605..c54e40d 100644 --- a/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_rpn_train.pt +++ b/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_rpn_train.pt @@ -8,7 +8,7 @@ layer { python_param { module: \u0026#39;roi_data_layer.layer\u0026#39; layer: \u0026#39;RoIDataLayer\u0026#39; - param_str: \u0026#34;\u0026#39;num_classes\u0026#39;: 21\u0026#34; + param_str: \u0026#34;\u0026#39;num_classes\u0026#39;: 6\u0026#34; } } diff --git a/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_fast_rcnn_train.pt b/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_fast_rcnn_train.pt index 262ed65..1a424a2 100644 --- a/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_fast_rcnn_train.pt +++ b/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_fast_rcnn_train.pt @@ -11,7 +11,7 @@ layer { python_param { module: \u0026#39;roi_data_layer.layer\u0026#39; layer: \u0026#39;RoIDataLayer\u0026#39; - param_str: \u0026#34;\u0026#39;num_classes\u0026#39;: 21\u0026#34; + param_str: \u0026#34;\u0026#39;num_classes\u0026#39;: 6\u0026#34; } } @@ -244,7 +244,7 @@ layer { param { lr_mult: 1.0 } param { lr_mult: 2.0 } inner_product_param { - num_output: 21 + num_output: 6 weight_filler { type: \u0026#34;gaussian\u0026#34; std: 0.01 @@ -263,7 +263,7 @@ layer { param { lr_mult: 1.0 } param { lr_mult: 2.0 } inner_product_param { - num_output: 84 + num_output: 24 weight_filler { type: \u0026#34;gaussian\u0026#34; std: 0.001 diff --git a/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_rpn_train.pt b/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_rpn_train.pt index 336b05b..bc0db0c 100644 --- a/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_rpn_train.pt +++ b/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_rpn_train.pt @@ -8,7 +8,7 @@ layer { python_param { module: \u0026#39;roi_data_layer.layer\u0026#39; layer: \u0026#39;RoIDataLayer\u0026#39; - param_str: \u0026#34;\u0026#39;num_classes\u0026#39;: 21\u0026#34; + param_str: \u0026#34;\u0026#39;num_classes\u0026#39;: 6\u0026#34; } } Dataset Script My classes: kuaikuai, lays, soda, biscuit, noodle\ndiff --git a/lib/datasets/imdb.py b/lib/datasets/imdb.py index b56bf0a..93c85a4 100644 --- a/lib/datasets/imdb.py +++ b/lib/datasets/imdb.py @@ -108,6 +108,10 @@ class imdb(object): oldx2 = boxes[:, 2].copy() boxes[:, 0] = widths[i] - oldx2 - 1 boxes[:, 2] = widths[i] - oldx1 - 1 + for b in range(len(boxes)): + if boxes[b][2] \u0026lt; boxes[b][0]: + boxes[b][0] = 0 + assert (boxes[:, 2] \u0026gt;= boxes[:, 0]).all() entry = {\u0026#39;boxes\u0026#39; : boxes, \u0026#39;gt_overlaps\u0026#39; : self.roidb[i][\u0026#39;gt_overlaps\u0026#39;], diff --git a/lib/datasets/pascal_voc.py b/lib/datasets/pascal_voc.py index b55f2f6..7a3473d 100644 --- a/lib/datasets/pascal_voc.py +++ b/lib/datasets/pascal_voc.py @@ -28,11 +28,12 @@ class pascal_voc(imdb): else devkit_path self._data_path = os.path.join(self._devkit_path, \u0026#39;VOC\u0026#39; + self._year) self._classes = (\u0026#39;__background__\u0026#39;, # always index 0 - \u0026#39;aeroplane\u0026#39;, \u0026#39;bicycle\u0026#39;, \u0026#39;bird\u0026#39;, \u0026#39;boat\u0026#39;, - \u0026#39;bottle\u0026#39;, \u0026#39;bus\u0026#39;, \u0026#39;car\u0026#39;, \u0026#39;cat\u0026#39;, \u0026#39;chair\u0026#39;, - \u0026#39;cow\u0026#39;, \u0026#39;diningtable\u0026#39;, \u0026#39;dog\u0026#39;, \u0026#39;horse\u0026#39;, - \u0026#39;motorbike\u0026#39;, \u0026#39;person\u0026#39;, \u0026#39;pottedplant\u0026#39;, - \u0026#39;sheep\u0026#39;, \u0026#39;sofa\u0026#39;, \u0026#39;train\u0026#39;, \u0026#39;tvmonitor\u0026#39;) + \u0026#39;kuaikuai\u0026#39;, \u0026#39;lays\u0026#39;, \u0026#39;soda\u0026#39;, \u0026#39;biscuit\u0026#39;, \u0026#39;noodle\u0026#39;) + # \u0026#39;aeroplane\u0026#39;, \u0026#39;bicycle\u0026#39;, \u0026#39;bird\u0026#39;, \u0026#39;boat\u0026#39;, + # \u0026#39;bottle\u0026#39;, \u0026#39;bus\u0026#39;, \u0026#39;car\u0026#39;, \u0026#39;cat\u0026#39;, \u0026#39;chair\u0026#39;, + # \u0026#39;cow\u0026#39;, \u0026#39;diningtable\u0026#39;, \u0026#39;dog\u0026#39;, \u0026#39;horse\u0026#39;, + # \u0026#39;motorbike\u0026#39;, \u0026#39;person\u0026#39;, \u0026#39;pottedplant\u0026#39;, + # \u0026#39;sheep\u0026#39;, \u0026#39;sofa\u0026#39;, \u0026#39;train\u0026#39;, \u0026#39;tvmonitor\u0026#39;) self._class_to_ind = dict(zip(self.classes, xrange(self.num_classes))) self._image_ext = \u0026#39;.jpg\u0026#39; self._image_index = self._load_image_set_index() update imdb.py and pascal_voc.py\ncd lib/datasets/ rm imdb.pyc pascal_voc.py # start python to compile pyc import py_compile py_compile.compile(r\u0026#39;imdb.py\u0026#39;) py_compile.compile(r\u0026#39;pascal_voc.py\u0026#39;) Speed up training for test only For make sure the training process works properly.\nModify train_faster_rcnn_alt_opt.py\ndiff --git a/tools/train_faster_rcnn_alt_opt.py b/tools/train_faster_rcnn_alt_opt.py index e49844a..1dafe3f 100755 --- a/tools/train_faster_rcnn_alt_opt.py +++ b/tools/train_faster_rcnn_alt_opt.py @@ -77,8 +77,9 @@ def get_solvers(net_name): [net_name, n, \u0026#39;stage2_fast_rcnn_solver30k40k.pt\u0026#39;]] solvers = [os.path.join(cfg.MODELS_DIR, *s) for s in solvers] # Iterations for each training stage - max_iters = [80000, 40000, 80000, 40000] - # max_iters = [100, 100, 100, 100] + # max_iters = [20000, 10000, 20000, 10000] + # max_iters = [80000, 40000, 80000, 40000] + max_iters = [100, 100, 100, 100] # Test prototxt for the RPN rpn_test_prototxt = os.path.join( cfg.MODELS_DIR, net_name, n, \u0026#39;rpn_test.pt\u0026#39;) Modify solvers\ndiff --git a/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_fast_rcnn_solver30k40k.pt b/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_fast_rcnn_solver30k40k.pt index 0180e7c..40636f0 100644 --- a/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_fast_rcnn_solver30k40k.pt +++ b/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_fast_rcnn_solver30k40k.pt @@ -3,7 +3,7 @@ train_net: \u0026#34;models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_fast_rcnn_train.pt\u0026#34; base_lr: 0.001 lr_policy: \u0026#34;step\u0026#34; gamma: 0.1 -stepsize: 30000 +stepsize: 30 display: 20 average_loss: 100 momentum: 0.9 diff --git a/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_rpn_solver60k80k.pt b/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_rpn_solver60k80k.pt index 23a7c6a..3f116dd 100644 --- a/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_rpn_solver60k80k.pt +++ b/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_rpn_solver60k80k.pt @@ -3,7 +3,7 @@ train_net: \u0026#34;models/pascal_voc/ZF/faster_rcnn_alt_opt/stage1_rpn_train.pt\u0026#34; base_lr: 0.001 lr_policy: \u0026#34;step\u0026#34; gamma: 0.1 -stepsize: 60000 +stepsize: 50 display: 20 average_loss: 100 momentum: 0.9 diff --git a/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_fast_rcnn_solver30k40k.pt b/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_fast_rcnn_solver30k40k.pt index a666def..2271d67 100644 --- a/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_fast_rcnn_solver30k40k.pt +++ b/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_fast_rcnn_solver30k40k.pt @@ -3,7 +3,7 @@ train_net: \u0026#34;models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_fast_rcnn_train.pt\u0026#34; base_lr: 0.001 lr_policy: \u0026#34;step\u0026#34; gamma: 0.1 -stepsize: 30000 +stepsize: 30 display: 20 average_loss: 100 momentum: 0.9 diff --git a/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_rpn_solver60k80k.pt b/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_rpn_solver60k80k.pt index 15d3da7..9d57101 100644 --- a/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_rpn_solver60k80k.pt +++ b/models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_rpn_solver60k80k.pt @@ -3,7 +3,7 @@ train_net: \u0026#34;models/pascal_voc/ZF/faster_rcnn_alt_opt/stage2_rpn_train.pt\u0026#34; base_lr: 0.001 lr_policy: \u0026#34;step\u0026#34; gamma: 0.1 -stepsize: 60000 +stepsize: 50 display: 20 average_loss: 100 momentum: 0.9 Outupt When you try to start a new round of training, you need to delete two cache files generated by last time.\nOne is /py-faster-rcnn/data/cache (delete the folder)\nThe other is /py-faster-rcnn/data/VOCdevkit2007/annotation_cache (if it exist, delete the folder)\n# if retain find . -name \u0026#39;*.pyc\u0026#39; | xargs rm # start training ./experiments/scripts/faster_rcnn_alt_opt.sh 0 ZF pascal_voc ... VOC07 metric? Yes Reading annotation for 1/116 Reading annotation for 101/116 Saving cached annotations to /home/dlsummer/RCNN-install/py-faster-rcnn/data/VOCdevkit2007/annotations_cache/annots.pkl AP for kuaikuai = 0.6687 AP for lays = 0.6286 AP for soda = 0.7081 AP for biscuit = 0.9091 AP for noodle = 0.4354 Mean AP = 0.6700 ~~~~~~~~ Results: 0.669 0.629 0.708 0.909 0.435 0.670 ~~~~~~~~ -------------------------------------------------------------- Results computed with the **unofficial** Python eval code. Results should be very close to the official MATLAB eval code. Recompute with `./tools/reval.py --matlab ...` for your paper. -- Thanks, The Management -------------------------------------------------------------- real 344m5.757s user 298m23.512s sys 45m38.792s Demo cp output/faster_rcnn_alt_opt/voc_2007_trainval/*.caffemodel ./data/faster_rcnn_models/ ## or cp output/faster_rcnn_alt_opt/voc_2007_trainval/zf_fast_rcnn_stage2_iter_100.caffemodel data/faster_rcnn_models/MY_ZF_faster_rcnn_final.caffemodel ## putting test images cp data/VOCdevkit2007/VOC2007/JPEGImages/???.jpg data/demo/ ## ex ## cp data/VOCdevkit2007/VOC2007/JPEGImages/G25_000?00.jpg data/demo/ ## run demo ./tools/demo_save_im.py --net zf Troubleshooting SSH: no display issue $ ./tool/demo.py Demo for data/demo/000456.jpg Detection took 0.198s for 300 object proposals Traceback (most recent call last): File \u0026#34;./tools/demo.py\u0026#34;, line 149, in \u0026lt;module\u0026gt; demo(net, im_name) File \u0026#34;./tools/demo.py\u0026#34;, line 98, in demo vis_detections(im, cls, dets, thresh=CONF_THRESH) File \u0026#34;./tools/demo.py\u0026#34;, line 47, in vis_detections fig, ax = plt.subplots(figsize=(12, 12)) File \u0026#34;/usr/local/lib/python2.7/dist-packages/matplotlib/pyplot.py\u0026#34;, line 1202, in subplots fig = figure(**fig_kw) File \u0026#34;/usr/local/lib/python2.7/dist-packages/matplotlib/pyplot.py\u0026#34;, line 535, in figure **kwargs) File \u0026#34;/usr/local/lib/python2.7/dist-packages/matplotlib/backends/backend_tkagg.py\u0026#34;, line 81, in new_figure_manager return new_figure_manager_given_figure(num, figure) File \u0026#34;/usr/local/lib/python2.7/dist-packages/matplotlib/backends/backend_tkagg.py\u0026#34;, line 89, in new_figure_manager_given_figure window = Tk.Tk() File \u0026#34;/usr/lib/python2.7/lib-tk/Tkinter.py\u0026#34;, line 1818, in __init__ self.tk = _tkinter.create(screenName, baseName, className, interactive, wantobjects, useTk, sync, use) _tkinter.TclError: no display name and no $DISPLAY environment variable Install Xming, Teamviewer or use X11 forwarding ssh -X\nhttp://blog.csdn.net/j790675692/article/details/52693761 Modify ./tool/demo.py diff --git a/tools/demo.py b/tools/demo.py index 631c68a..5016da5 100755 --- a/tools/demo.py +++ b/tools/demo.py @@ -13,6 +13,9 @@ Demo script showing detections in sample images. See README.md for installation instructions before running. \u0026#34;\u0026#34;\u0026#34; +import matplotlib +matplotlib.use(\u0026#39;Agg\u0026#39;) + import _init_paths from fast_rcnn.config import cfg from fast_rcnn.test import im_detect @@ -67,7 +72,9 @@ def vis_detections(im, class_name, dets, thresh=0.5): fontsize=14) plt.axis(\u0026#39;off\u0026#39;) plt.tight_layout() - plt.draw() + #plt.draw() + pic_name = class_name + \u0026#39;_\u0026#39; + im_name + plt.savefig(pic_name) def demo(net, image_name): \u0026#34;\u0026#34;\u0026#34;Detect object classes in an image using pre-computed object proposals.\u0026#34;\u0026#34;\u0026#34; AttributeError: \u0026lsquo;module\u0026rsquo; object has no attribute \u0026rsquo;text_format\u0026rsquo; $ ./experiments/scripts/faster_rcnn_alt_opt.sh 0 VGG16 pascal_voc [libprotobuf WARNING google/protobuf/io/coded_stream.cc:78] The total number of bytes read was 553432430 I0804 08:22:22.416573 2399 net.cpp:816] Ignoring source layer pool5 I0804 08:22:22.539361 2399 net.cpp:816] Ignoring source layer relu7 I0804 08:22:22.539386 2399 net.cpp:816] Ignoring source layer drop7 I0804 08:22:22.539389 2399 net.cpp:816] Ignoring source layer fc8 I0804 08:22:22.539392 2399 net.cpp:816] Ignoring source layer prob Process Process-1: Traceback (most recent call last): File \u0026#34;/usr/lib/python2.7/multiprocessing/process.py\u0026#34;, line 258, in _bootstrap self.run() File \u0026#34;/usr/lib/python2.7/multiprocessing/process.py\u0026#34;, line 114, in run self._target(*self._args, **self._kwargs) File \u0026#34;./tools/train_faster_rcnn_alt_opt.py\u0026#34;, line 129, in train_rpn max_iters=max_iters) File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/fast_rcnn/train.py\u0026#34;, line 157, in train_net pretrained_model=pretrained_model) File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/fast_rcnn/train.py\u0026#34;, line 51, in __init__ pb2.text_format.Merge(f.read(), self.solver_param) AttributeError: \u0026#39;module\u0026#39; object has no attribute \u0026#39;text_format\u0026#39; install protobuf==2.6.0\n$ sudo pip install protobuf==2.6.0 Ref: http://blog.csdn.net/qq_32768743/article/details/74639381\nOut of Memory I0804 08:28:56.610743 2742 net.cpp:270] This network produces output rpn_loss_bbox I0804 08:28:56.610782 2742 net.cpp:283] Network initialization done. I0804 08:28:56.610920 2742 solver.cpp:60] Solver scaffolding done. Loading pretrained model weights from data/imagenet_models/VGG16.v2.caffemodel [libprotobuf WARNING google/protobuf/io/coded_stream.cc:537] Reading dangerously large protocol message. If the message turns out to be larger than 2147483647 bytes, parsing will be halted for security reasons. To increase the limit (or to disable these warnings), see CodedInputStream::SetTotalBytesLimit() in google/protobuf/io/coded_stream.h. [libprotobuf WARNING google/protobuf/io/coded_stream.cc:78] The total number of bytes read was 553432430 I0804 08:28:56.840101 2742 net.cpp:816] Ignoring source layer pool5 I0804 08:28:56.961663 2742 net.cpp:816] Ignoring source layer relu7 I0804 08:28:56.961685 2742 net.cpp:816] Ignoring source layer drop7 I0804 08:28:56.961688 2742 net.cpp:816] Ignoring source layer fc8 I0804 08:28:56.961689 2742 net.cpp:816] Ignoring source layer prob Solving... F0804 08:28:57.365995 2742 syncedmem.cpp:56] Check failed: error == cudaSuccess (2 vs. 0) out of memory *** Check failure stack trace: *** ^C dlsummer@dlsummer-BM1AF-BP1AF-BM6AF:~/RCNN-install/py-faster-rcnn$ free -m total used free shared buff/cache available Mem: 11887 237 10480 17 1168 11350 Swap: 12159 0 12159 The graphic car out of memory Tried to train ZF model. GTX1060 may not have enough memory for VGG16. (I\u0026rsquo;m not sure the GPU is 6G ver. or 3G ver.)\nIn ZF model, you should modify:\nstage1_rpn_train.pt line 11 stage1.fast_rcnn_train.pt line 14, line 247 (In layer \u0026ldquo;cls_score\u0026rdquo;), line 266 (In layer \u0026ldquo;bbox_pred\u0026rdquo;) stage2_rpn_train.pt line 11 stage2.fast_rcnn_train.pt line 14, line 247 (In layer \u0026ldquo;cls_score\u0026rdquo;), line 266 (In layer \u0026ldquo;bbox_pred\u0026rdquo;) faster_rcnn_test.pt line 306 (In layer \u0026ldquo;cls_score\u0026rdquo;), line 315 (In layer \u0026ldquo;bbox_pred\u0026rdquo;) TypeError: \u0026rsquo;numpy.float64\u0026rsquo; object cannot be interpreted as an index Process Process-3: Traceback (most recent call last): File \u0026#34;/usr/lib/python2.7/multiprocessing/process.py\u0026#34;, line 258, in _bootstrap self.run() File \u0026#34;/usr/lib/python2.7/multiprocessing/process.py\u0026#34;, line 114, in run self._target(*self._args, **self._kwargs) File \u0026#34;./tools/train_faster_rcnn_alt_opt.py\u0026#34;, line 196, in train_fast_rcnn max_iters=max_iters) File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/fast_rcnn/train.py\u0026#34;, line 160, in train_net model_paths = sw.train_model(max_iters) File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/fast_rcnn/train.py\u0026#34;, line 101, in train_model self.solver.step(1) File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/roi_data_layer/layer.py\u0026#34;, line 144, in forward blobs = self._get_next_minibatch() File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/roi_data_layer/layer.py\u0026#34;, line 63, in _get_next_minibatch return get_minibatch(minibatch_db, self._num_classes) File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/roi_data_layer/minibatch.py\u0026#34;, line 55, in get_minibatch num_classes) File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/roi_data_layer/minibatch.py\u0026#34;, line 100, in _sample_rois fg_inds, size=fg_rois_per_this_image, replace=False) File \u0026#34;mtrand.pyx\u0026#34;, line 1187, in mtrand.RandomState.choice (numpy/random/mtrand/mtrand.c:18864) TypeError: \u0026#39;numpy.float64\u0026#39; object cannot be interpreted as an index Solution:\nhttps://github.com/rbgirshick/py-faster-rcnn/issues/481\nThere seems to be a similar error caused by line 173 in lib/roi_data_layer/minibatch.py.\ncls = clss[ind]\nThis is then used to slice bbox_targets[], however it is not an int and throws an error after hours of training. Change it to,\ncls = int(clss[ind])\nYou will save yourself a headache.\nvi lib/roi_data_layer/minibatch.py\nline 173: cls = int(clss[ind])\ndiff --git a/lib/roi_data_layer/minibatch.py b/lib/roi_data_layer/minibatch.py index f4535b0..dc15c62 100644 --- a/lib/roi_data_layer/minibatch.py +++ b/lib/roi_data_layer/minibatch.py @@ -93,7 +93,7 @@ def _sample_rois(roidb, fg_rois_per_image, rois_per_image, num_classes): fg_inds = np.where(overlaps \u0026gt;= cfg.TRAIN.FG_THRESH)[0] # Guard against the case when an image has fewer than fg_rois_per_image # foreground RoIs - fg_rois_per_this_image = np.minimum(fg_rois_per_image, fg_inds.size) + fg_rois_per_this_image = int(np.minimum(fg_rois_per_image, fg_inds.size)) # Sample foreground regions without replacement if fg_inds.size \u0026gt; 0: fg_inds = npr.choice( @@ -105,8 +105,8 @@ def _sample_rois(roidb, fg_rois_per_image, rois_per_image, num_classes): # Compute number of background RoIs to take from this image (guarding # against there being fewer than desired) bg_rois_per_this_image = rois_per_image - fg_rois_per_this_image - bg_rois_per_this_image = np.minimum(bg_rois_per_this_image, - bg_inds.size) + bg_rois_per_this_image = int(np.minimum(bg_rois_per_this_image, + bg_inds.size)) # Sample foreground regions without replacement if bg_inds.size \u0026gt; 0: bg_inds = npr.choice( @@ -170,7 +170,7 @@ def _get_bbox_regression_labels(bbox_target_data, num_classes): bbox_inside_weights = np.zeros(bbox_targets.shape, dtype=np.float32) inds = np.where(clss \u0026gt; 0)[0] for ind in inds: - cls = clss[ind] + cls = int(clss[ind]) start = 4 * cls end = start + 4 bbox_targets[ind, start:end] = bbox_target_data[ind, 1:] ImportError: numpy.core.multiarray failed to import Traceback (most recent call last): File \u0026#34;./tools/train_faster_rcnn_alt_opt.py\u0026#34;, line 19, in \u0026lt;module\u0026gt; from datasets.factory import get_imdb File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/datasets/factory.py\u0026#34;, line 13, in \u0026lt;module\u0026gt; from datasets.coco import coco File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/datasets/coco.py\u0026#34;, line 20, in \u0026lt;module\u0026gt; from pycocotools.coco import COCO File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/pycocotools/coco.py\u0026#34;, line 58, in \u0026lt;module\u0026gt; import mask File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/pycocotools/mask.py\u0026#34;, line 3, in \u0026lt;module\u0026gt; import pycocotools._mask as _mask File \u0026#34;pycocotools/_mask.pyx\u0026#34;, line 20, in init pycocotools._mask File \u0026#34;__init__.pxd\u0026#34;, line 989, in numpy.import_array ImportError: numpy.core.multiarray failed to import Solution:\nsudo -H pip install --upgrade numpy\nTypeError: only length-1 arrays can be converted to Python scalars Process Process-3: Traceback (most recent call last): File \u0026#34;/usr/lib/python2.7/multiprocessing/process.py\u0026#34;, line 258, in _bootstrap self.run() File \u0026#34;/usr/lib/python2.7/multiprocessing/process.py\u0026#34;, line 114, in run self._target(*self._args, **self._kwargs) File \u0026#34;./tools/train_faster_rcnn_alt_opt.py\u0026#34;, line 196, in train_fast_rcnn max_iters=max_iters) File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/fast_rcnn/train.py\u0026#34;, line 160, in train_net model_paths = sw.train_model(max_iters) File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/fast_rcnn/train.py\u0026#34;, line 101, in train_model self.solver.step(1) File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/roi_data_layer/layer.py\u0026#34;, line 144, in forward blobs = self._get_next_minibatch() File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/roi_data_layer/layer.py\u0026#34;, line 63, in _get_next_minibatch return get_minibatch(minibatch_db, self._num_classes) File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/roi_data_layer/minibatch.py\u0026#34;, line 55, in get_minibatch num_classes) File \u0026#34;/home/dlsummer/RCNN-install/py-faster-rcnn/tools/../lib/roi_data_layer/minibatch.py\u0026#34;, line 100, in _sample_rois int(fg_inds), size=fg_rois_per_this_image, replace=False) TypeError: only length-1 arrays can be converted to Python scalars Solution\nvi lib/roi_data_layer/minibatch.py\nline 100: size=int(fg_rois_per_this_image)\n","permalink":"https://oopsmonk.github.io/posts/2017-08-31-faster-r-cnn-use-caffe-framework/","summary":"Install caffe framework and run Faster R-CNN demo on Ubuntu 16.04.\nTest environment CPU: Intel(R) Core(TM) i3-4130 CPU @ 3.40GHz 4-Cores\nGPU: ASUSTeK GeForce GTX 1060 with 6GB Memory\nHD: WDC WD5000AAKX\nOS: Ubuntu 16.04\nTest Flow Install software requirement Video pre-processing: get jpeg images from source video Image Labeling Use Faster R-CNN to genrate trained model Run Faster R-CNN demo Requirement Hardware:\nGood graphic card with large memory (6GB memory is okay, but it has problem in VGG traing.","title":"Faster R-CNN Use Caffe Framework"},{"content":"以前球隊在回防時, 教練總會說\u0026quot;快跑! 別回頭, 到定點再休息\u0026quot;.\n關於人生, 喘息點在哪兒? 我想就在滴水穿石之間!\nDeep Learning \u0026lt;\u0026ndash;\u0026gt; keep learning\nWeek31 (08/04) 網路文章 A Brief History of CNNs in Image Segmentation: From R-CNN to Mask R-CNN\nR-CNN: https://arxiv.org/abs/1311.2524\nVisual Recognition就是從這裡爆發了\u0026hellip; 透過Selective Search找到Region後丢給修改過的AlexNet學習, 最後再給Support Vector Machine (SVM) 這層CNN.\n原本設計的R-CNN就只做這些: 用Selective Search找region 透過pre-trained AlexNet去算特徵後交給SVM看region裡的是什麼鬼東西 最後透過線性回歸(linear regression)畫出物件的座標 Fast R-CNN: https://arxiv.org/abs/1504.08083\nRegion proposals using Selective Search. RoI (Region of Interest) Pooling\nCombine All Models into One Network\n將R-CNN的AlexNet, SVM, Regressor整合在一起變成單一個network Fast R-CNN instead used a single network to compute the extract image features (CNN), classify (SVM), and tighten bounding boxes (regressor).\nFaster R-CNN: https://arxiv.org/abs/1506.01497\n用SS找region的方法太慢, 又重覆計算, 改由RPN後, 整個framework只要訓練一個CNN.\nSpeeding Up Region Proposal: Selective Search is too slow.\nA single CNN is used to both carry out region proposals and classification.\nonly one CNN needs to be trained\nRegion Proposal Network(RPN) - How the Regions are Generated\nMask R-CNN: https://arxiv.org/abs/1703.06870\nExtending Faster R-CNN for Pixel Level Segmentation\nFacebook的reseachers發現RoIPool在選擇region時會有誤差, 所以利用RoiAlign來處理這個問題.\nRoiAlign - Realigning RoIPool to be More Accurate\n網路資源 CS231n Convolutional Neural Networks for Visual Recognition\nStanford的課程 - CS231n: CNNs for Visual Recognition.\n6 Free to Low-Cost Resources to Teach You Calculus in a Fun and Interactive Way\n對微積分有興趣可參考一下\n讀書心得 Deep learning 近來的發展主要是在convolutional neural networks(CNN)\nR-CNN(2014) -\u0026gt; Fast R-CNN(2015) -\u0026gt; Faster R-CNN(2016) -\u0026gt; Mask R-CNN(2017)\n自2010年開始Image Net每年都有發表ILSVRC(Large Scale Visual Recognition Challenge)結果\n在2015年時top-5 error rate為4.84%, 人眼辨識大約為5%, 造成了極大的影響.\n現在ILSVRC2017結果也公怖了, 基本上2015後top-5 error己經不是重點了吧.\nNeural Network training 簡單的說就是算權重, 像在做filter (low/high pass filter)\n每個hidden layer 處理的東西不同, ex: 點, 線, 面, 空間.\n後來Google brain 的reseachers在2014提出了GAN(Generative Adversarial Network), 基本架構是2個neural network相互較勁來學習.\nGAN主要可用在:\n造假圖, 也就是透過學習把原圖做成不同風格的圖片. 電腦對戰 動畫或gaming材質的處理, 用來生出不同材質的貼圖 Deap Learning發展方向:\n看圖說故事 軌跡預測 目前CNN的應用上大多使用VGG-16 pre-trained model, 再自行做fully connecte的訓練, 只需要少量的圖檔(300 or 600張)即可達到需求.\n簡單的說就是拿訓練好的network, 調整權重(weights), 再經過小量的訓練即可. R-CNN 及 Fast R-CNN用selective search找region裡有沒有東西, 是比較沒有效率的方法, input是使用224x224大小的圖, 所以𠩤圖需要scale down特徴值可能會失真.\n後來的Faster R-CNN可以看成是RPNs(Region Proposal Networks) + Fast R-CNN, 可以避免特徴值失真, 不用縮圖.\nRegion Proposal Network\nFaster R-CNN Training\nArtificial Inteligence - Object Localization and Detection\nPS:\nTop-5 error rate: 對一個label猜5次, 猜中的機率.\nNvidia GTX 1080 Ti GPU使用Faster R-CNN, 1秒大約可以處理3張圖.\nWeek32 (08/11) Week33 (08/18) 網路文章 Meet the Company That’s Using Face Recognition to Reshape China’s Tech Scene 大陸政府的加持對於新科技發展速度真是一大助力.\nWeek34 (08/25) 網路文章 Introduction to Trainspotting\nRaspberry Pi + TensorFlow 偵測火車行進方向\n網路資源 Mathcha\n較直覺的方式寫數學公式, 比起MathJax方便.\n","permalink":"https://oopsmonk.github.io/posts/2017-08-02-2017month8/","summary":"以前球隊在回防時, 教練總會說\u0026quot;快跑! 別回頭, 到定點再休息\u0026quot;.\n關於人生, 喘息點在哪兒? 我想就在滴水穿石之間!\nDeep Learning \u0026lt;\u0026ndash;\u0026gt; keep learning\nWeek31 (08/04) 網路文章 A Brief History of CNNs in Image Segmentation: From R-CNN to Mask R-CNN\nR-CNN: https://arxiv.org/abs/1311.2524\nVisual Recognition就是從這裡爆發了\u0026hellip; 透過Selective Search找到Region後丢給修改過的AlexNet學習, 最後再給Support Vector Machine (SVM) 這層CNN.\n原本設計的R-CNN就只做這些: 用Selective Search找region 透過pre-trained AlexNet去算特徵後交給SVM看region裡的是什麼鬼東西 最後透過線性回歸(linear regression)畫出物件的座標 Fast R-CNN: https://arxiv.org/abs/1504.08083\nRegion proposals using Selective Search. RoI (Region of Interest) Pooling\nCombine All Models into One Network\n將R-CNN的AlexNet, SVM, Regressor整合在一起變成單一個network Fast R-CNN instead used a single network to compute the extract image features (CNN), classify (SVM), and tighten bounding boxes (regressor).","title":"Going Deep"},{"content":"以前球隊在回防時, 教練總會說\u0026quot;快跑! 別回頭, 到定點再休息\u0026quot;.\n關於人生, 喘息點在哪兒? 我想就在滴水穿石之間!\nWeek27 (07/07) 網路文章 Elon Musk: The world\u0026rsquo;s population is accelerating toward collapse and nobody cares\n網路資源 Barbara Oakley: \u0026ldquo;Learning How to Learn\u0026rdquo; | Talks at Google\nWeek28 (07/14) 網路資源 Numpy Quick Start\nMathJax basic tutorial and quick reference\nMathJax語法速查及範例\nWeek29 (07/21) 網路文章 Path Guide: A New Approach to Indoor Navigation\n讀書心得 The Numpy Stack in Python\n用簡短的方式介紹numpy, pandas, matplotlib, scipy.\nnumpy: 在matrix, vector處理會比ptython built-in還快很多且方便. 主要的object type是numpy.array, 可以跟list object互相轉換. pandas: 強大的DataFrames在處理csv files時可輕鬆取出及處理想要的內容. pandas.DataFrame與pandas.Series是很重要的object. matplotlib: 把資料圖形化 scipy: 介紹了常態分佈(normal distribution)又稱高斯分佈(Gaussian distribution). Week30 (07/28) 網路文章 A Neural Network in 11 lines of Python\n詳細的說明ANN的實現方法, 但沒提到bias??\nRole of Bias in Neural Networks\nI think that biases are almost always helpful. In effect, a bias value allows you to shift the activation function to the left or right, which may be critical for successful learning.\nA Step by Step Backpropagation Example\nAndroid Programming 3D Graphics with OpenGL ES\n很完整的Android OpenGL ES教學, 如何init, 如何貼圖\u0026hellip;\n網路資源 Interactive LaTeX Editor\n有很多數學式子的寫法可以參考\n","permalink":"https://oopsmonk.github.io/posts/2017-07-03-2017month7/","summary":"以前球隊在回防時, 教練總會說\u0026quot;快跑! 別回頭, 到定點再休息\u0026quot;.\n關於人生, 喘息點在哪兒? 我想就在滴水穿石之間!\nWeek27 (07/07) 網路文章 Elon Musk: The world\u0026rsquo;s population is accelerating toward collapse and nobody cares\n網路資源 Barbara Oakley: \u0026ldquo;Learning How to Learn\u0026rdquo; | Talks at Google\nWeek28 (07/14) 網路資源 Numpy Quick Start\nMathJax basic tutorial and quick reference\nMathJax語法速查及範例\nWeek29 (07/21) 網路文章 Path Guide: A New Approach to Indoor Navigation\n讀書心得 The Numpy Stack in Python\n用簡短的方式介紹numpy, pandas, matplotlib, scipy.\nnumpy: 在matrix, vector處理會比ptython built-in還快很多且方便.","title":"Math"},{"content":"以前球隊在回防時, 教練總會說\u0026quot;快跑! 別回頭, 到定點再休息\u0026quot;.\n關於人生, 喘息點在哪兒? 我想就在滴水穿石之間!\nWeek22 (06/02) 讀書心得 OSDI: Memory Management\nKernel space的memory management, 要考慮到的問題, Internal/External fregmentation, physical/logical contiguous, buddy system, slab allocator.\nUser space的memory管理, page fault handler, Red-Black Tree / AVL Tree.\n論文學習 FarmBeats: An IoT Platform for Data-Driven Agriculture PDF ,Slides\nFarmBeats這套系統提出了几個解決方法:\n遠距傳輸, 以往的解法是用satellite或是手機訊號, 這裡是使用TVWS(TV White Space)以減少硬體成本, TVWS是利用數位電視未使用的頻寬做傳輸, 屬於低頻有傳輸距離長, 穿透力強的優點. 天氣感知系統, 透過OpenWeather API的資料來規劃電量的使用及電池的充電與否. 風力輔助系統, 收集農地的風向及風力數據, 透過飛行演算法(Flight Planning Algorithm)規劃出適當的路線, 減少逆風造成的額外耗電量. 本地影像及資料壓縮, 一般Drone的航空影像(Aerial Imagery)或sensors資料都是直接傳到雲端, 透過Farmbeats的gateway做中繼站並壓縮影像及sensors資料, 可支援1星期的在網路無法使用情況. Week23 (06/09) 網路文章 When should we use mutex and when should we use semaphore\n讀書心得 OSDI: Kernel Synchronization\nRace condition and synchronization issues.\nSeamphores/mutexes 是用spink locks現實, spink locks是由Atomic oprations來的.\nSpin lock速度: spin_lock \u0026lt; spin_lock_irq \u0026lt; spin_lock_iqrsave\nSemaphores: 是sleeping locks, 沒有disable kernel preemption, 把自己設為idle讓的task先做, 用在需要等比較久的時間, 在acquire spin lock後不能再acquire semaphore，但hold a semaphore可以再acquire a spin lock.\nMutex: 跟semaphore類似但只count one, semaphore會等所有的locks都release時才會離開sleep, Mutex是較簡單且效能較好的lock機制, 只想知道有沒有人acquire.\n論文學習 [An Evolutionary Study of Linux Memory Management for Fun and Profit]({{ site.baseurl }}{% post_url 2017-06-13-linux-memory-management %})\n這份研究分析2009~2015年之間4587筆有關memory management(mm)的patches, Linux版本由v2.6.32.1 ~ v4.0-rc4.\n主要的bug fix在: Memory Allocation, Garbage Collection (GC), Virtual Memory Management.\n大部份memory leak並不是因為忘了free, 而是錯誤的page fault handling和 free page的計算.\nMM較大的問題是很難去track正確的狀態.\n常用的data structures: Radix tree, Red-black tree, bitmap, list.\nOptimization patches主要有3種: data structure, memory policy, fast path.\nVirtual Memory Management是MM裡最大的component, 因為新的硬體及較大的容量, 而存在許多問題.\nMemory Resource Controller最大的問題是concurrency的處理.\nMemory Allocation主要問題在於checking/lock.\nGarbage Collection 透過policy design決定performance的trade-off, 需要一個scalable and coordinated的GC.\nWeek24 (06/16) 網路文章 Power Causes Brain Damage\nIntel Issues End-of-Life Notices for Galileo / Galileo 2, Edison and Joule Boards \u0026amp; Modules\nIntel的IoT開發平台負評不少丫.\n網路資源 A Candy Dispenser\n使用Android Things + Cloud Vision API. Demo\n讀書心得 OSDI: Interrupt and Interrupt Handling\nLinux 驅動的實現分為3個部份: 註冊(init_module), file operations(API), interrupt handler.\nLinux驅動分為3種類型: block device, character device, network device.\n以及2種裝置類別: vritual device driver, physical device driver.\nInterrupt handling會拆分為2個部份(top/bottom)處理, 減少interrupt disable時間, 讓系統反應更即時. Top Half: 執行時間要短, 中斷是disable的狀態\nBottom Half: 真正在處理中斷資料的地方, 這時可以允許被中斷\nTop and Bottom Halves\nLinux kernel設計了3種不同的bottom halves: softirq, tasklet, workqueue\nSoftirq用在硬碟, 網路卡, Timer 同個softirq在多核的CPU上是可以同時進行的, 所以concurrency要做好. tasklet是建在softirq之上, 但同一個tasklet無法在多核CPU同時進行. ksoftirqd是softirq daemon. top half把softirq(bottom half)叫起來的, 但有些softirq是自己把自己叫起來（ex:網路卡). Work queues是標準的thread, 可以sleep Week25 (06/23) 網路文章 Linux Performance\n介紹了一些分析工具, 也包括了\nBCC - Tools for BPF-based Linux IO analysis, networking, monitoring, and more\nperf-tools - Performance analysis tools\n網路資源 Stressful Application Test - userspace memory and IO test\n壓力測試工具\ncatapult\nCatapult是集合了Trace-viewer, Telemetry, Performance Dashboard, and Systrace的一個專案, 原本是用在Chromium performance analysis, 但也可使用在Android/Linux.\n讀書心得 OSDI: Filesystem and Block I/O\n從硬碟讀取資料會有2次的memroy copy: HDD DMA -\u0026gt; kernel space buffer -\u0026gt; user space buffer.\nFile I/O大略可分為2層\nfile system driver: ext4, fat32, NTFS\u0026hellip; device driver: Hard Disk, eMMC, USB storage\u0026hellip; Virtual file system 用來做為不同的file system drivers的介面, 管理inode (file)以及inode/dentry cache.\n主要的data structure\nsuperblock object: 用來表達一個file system inode object: 用來表達一個file及屬性 dentry object: 用來表達一個目錄 file object: 說明file被誰open及路徑 Week26 (06/30) 網路文章 5 tips for maximizing your lat exercises\nMuscle contraction matters.\nThe longer path of movement means more muscles are conducted. This article points out some mistakes I had done when I was a beginner years ago, and sometimes insufficient movement is because of muscle fatigue. Pilates is a good way for resilience.\n讀書心得 OSDI: Network Protocol and NIC Driver\n由網路架構可回顧之前所講的整個系統架構\nProcess management: fork, exec, kill, sheduler, spin lock, thread Memory management: free, malloc, GC, Allocator, Virtual Memory Device driver Block devices: File system Character devices: Keyboard, Mouse, Graphic card Network devices: net devices Socket操作行為很像file的操作.\n網路通訊協定7層在實作時並沒有上下關係, 只是表達每一層該做的事, ARP可能在user space, HTTP可能在kernel.\nkernel統一透過socketcall來處理socket連線, 第一個參數為要執行的動作(action)\nSDU vs PDU\nSDU(service data unit): OSI model中要傳送給下一層的資料.\nPDU(protocol data unit): OSI model中要由上層傳送過來的資料.\nSocket Buffer: 網路封包在傳送過程中, 在不同的層級會被加入不同的header或checksum(padding), 這個過程會造成多次的memory copy, socket buffer是為了加速及減少memory copy的overhead.\nSocket buffer是用來描述封包的meta data(data structure).\nNAPI(New API): 隨著網路的發展, network device(網卡)要處理的資料量越來越大(100Mbps/1Gbps/10Gbps), 這代表CPU要處理的interrupt變多並造成livelock.\nNAPI需要硬體支援, 是為了降低CPU處理interrupt的量, 結合interrupt及polling的設計, 當interrupt超過一定的量會disable interrupt改為polling處理網路封包.\n缺點: 某些case會有額外的IRQ latency. 有些硬體設計IRQ masking是較慢的, 頻繁的操作會影響系統.\nNew API\n","permalink":"https://oopsmonk.github.io/posts/2017-05-31-2017month6/","summary":"以前球隊在回防時, 教練總會說\u0026quot;快跑! 別回頭, 到定點再休息\u0026quot;.\n關於人生, 喘息點在哪兒? 我想就在滴水穿石之間!\nWeek22 (06/02) 讀書心得 OSDI: Memory Management\nKernel space的memory management, 要考慮到的問題, Internal/External fregmentation, physical/logical contiguous, buddy system, slab allocator.\nUser space的memory管理, page fault handler, Red-Black Tree / AVL Tree.\n論文學習 FarmBeats: An IoT Platform for Data-Driven Agriculture PDF ,Slides\nFarmBeats這套系統提出了几個解決方法:\n遠距傳輸, 以往的解法是用satellite或是手機訊號, 這裡是使用TVWS(TV White Space)以減少硬體成本, TVWS是利用數位電視未使用的頻寬做傳輸, 屬於低頻有傳輸距離長, 穿透力強的優點. 天氣感知系統, 透過OpenWeather API的資料來規劃電量的使用及電池的充電與否. 風力輔助系統, 收集農地的風向及風力數據, 透過飛行演算法(Flight Planning Algorithm)規劃出適當的路線, 減少逆風造成的額外耗電量. 本地影像及資料壓縮, 一般Drone的航空影像(Aerial Imagery)或sensors資料都是直接傳到雲端, 透過Farmbeats的gateway做中繼站並壓縮影像及sensors資料, 可支援1星期的在網路無法使用情況. Week23 (06/09) 網路文章 When should we use mutex and when should we use semaphore","title":"OSDI"},{"content":"Memory management主要的功能是page mapping, memory protection, and sharing, 但隨著時間不斷的演進已經算是kernel裡不小的subsystem.\n這份研究分析2009~2015年之間4587筆有關memory management(mm)的patches, Linux版本由v2.6.32.1 ~ v4.0-rc4.\nSource: An Evolutionary Study of Linux Memory Management for Fun and Profit\nMemory Bugs 5種bugs存在mm: memory error, checking, concurrency, logic and programming.\n透過heat map可清楚看到主要bug發生地方\n主要的bug fix在: Memory Allocation, Garbage Collection (GC), Virtual Memory Management.\n大部份memory leak並不是因為忘了free, 而是錯誤的page fault handling和 free page的計算.\nMM較大的問題是很難去track正確的狀態.\nMemory optimization 定義3種optimization patches\ndata structure: 避免nested data structure. Scalability的實現, scalability問題是因為locking for atomic access to shared data structures. memory policy: 使用合理的policy design (latency/throughput, sync/async, lazy/non-lazy, local/global, fairness/performance). fast path: 加速頻繁使用的source code, reduction跟lockless optimization是廣泛被使用. Optimistic barrier是為了減少呼叫barrier/fence system call時的synchronous overheads. (Code reduction, lockless optimization, new function, state caching, inline, code shifting, group excution, optimistic barrier) MM常見的Data structure Radix tree: In adress_space, 主要特色是有效率的存放(sparse)資料. Red-black tree: In vm_area_struct, 可快速的search, insert, delete. 相較於AVL 雖然在search上較快但需要額外的空間, insert/delete比較慢, rotation比較困難. Bitmap: 通常用在RAM的page indexing. List: 廣泛使用的DS, 例如LRU(Last Recently Used) list, 用來追蹤active/inactive pages. Data structure optimization Reducing software overhead(76.2%): 避免nested data structure. Improving scalability for data structure(23.8%): Most of the scalability issues are caused by locking for atomic access to shared data structures. Policy design tackling trade-offs Fast Path Memory Semantics Memory allocation: buddy system(page_alloc, slab, slub, slob)已成熟的發展, 但在maintain page status上有許多bug, 主要是checking/lock issues.\nMemory Resource Controller: 主要的patches都在memcontrol. Concurrency是最大的問題，其次Fault handler(OOM/page fault)在於錯的page status資訊.\nVirtual Memory Management: 是MM裡最大的一個component, 仍存在一堆bug, 因為新的硬體, 新的使用方法(huge page)\nGarbage Collection: vmscan的kswapd, shrinker, 和 other GC helper, 大多的patch為shrinker的policy design, 為了減少scan時的overhead和決定哪些space該free. shrinker是造成memory performance難以預測的原因. A scalable and coordinated GC is desirable.\n","permalink":"https://oopsmonk.github.io/posts/2017-06-13-linux-memory-management/","summary":"Memory management主要的功能是page mapping, memory protection, and sharing, 但隨著時間不斷的演進已經算是kernel裡不小的subsystem.\n這份研究分析2009~2015年之間4587筆有關memory management(mm)的patches, Linux版本由v2.6.32.1 ~ v4.0-rc4.\nSource: An Evolutionary Study of Linux Memory Management for Fun and Profit\nMemory Bugs 5種bugs存在mm: memory error, checking, concurrency, logic and programming.\n透過heat map可清楚看到主要bug發生地方\n主要的bug fix在: Memory Allocation, Garbage Collection (GC), Virtual Memory Management.\n大部份memory leak並不是因為忘了free, 而是錯誤的page fault handling和 free page的計算.\nMM較大的問題是很難去track正確的狀態.\nMemory optimization 定義3種optimization patches\ndata structure: 避免nested data structure. Scalability的實現, scalability問題是因為locking for atomic access to shared data structures.","title":"[Paper] - An Evolutionary Study of Linux Memory Management for Fun and Profit"},{"content":"How to use weston with DRM backend in Raspbian, and gets benchmark score by GLMark2.\nWith regards to hardware acceleration, We can enable VC4 driver through raspi-config.\n# update system and raspi-config script $ sudo apt-get update \u0026amp;\u0026amp; sudo apt-get upgrade $ sudo apt-get install raspi-config # enable Broadcom VC4 driver $ sudo raspi-config Advanced Options -\u0026gt; GL Driver -\u0026gt; GL (Full KMS) Test environment:\n2017-04-10-raspbian-jessie-lite HDMI 1080P 60Hz CPU/GPU use default settings(no overclock) Test packages:\nwayland 1.13.0 libdrm-2.4.81 mesa-17.1.1 pixman-0.34.0 cairo 1.15.4 weston 2.0.0 In my case, it took about 2.5 hours for clone and compile all packages, so go jogging is a great choice. :-)\nBuild script: RPi3_build_weston.sh\n$ cd ~ \u0026amp;\u0026amp; sudo su # ./RPi3_build_weston.sh all Run weston $ sudo su # export XDG_RUNTIME_DIR=/tmp/weston_runtime # mkdir $XDG_RUNTIME_DIR \u0026amp;\u0026amp; chmod 0700 $XDG_RUNTIME_DIR # export LD_LIBRARY_PATH=/usr/local/lib/ # weston --tty=2 --idle-time=0 -B drm-backend.so \u0026amp; Date: 2017-06-02 CST [09:52:59.501] weston 2.0.0 http://wayland.freedesktop.org Bug reports to: https://bugs.freedesktop.org/enter_bug.cgi?product=Wayland\u0026amp;component=weston\u0026amp;version=2.0.0 Build: 2.0.0 configure.ac: bump to version 2.0.0 for the official release (2017-02-24 16:19:03 -0800) [09:52:59.506] Command line: weston --tty=2 --idle-time=0 -B drm-backend.so [09:52:59.507] OS: Linux, 4.9.24-v7+, #993 SMP Wed Apr 26 18:01:23 BST 2017, armv7l [09:52:59.509] warning: XDG_RUNTIME_DIR \u0026#34;/tmp/weston_runtime\u0026#34; is not configured correctly. Unix access mode must be 0700 (current mode is 700), and must be owned by the user (current owner is UID 1001). Refer to your distribution on how to get it, or http://www.freedesktop.org/wiki/Specifications/basedir-spec on how to implement it. [09:52:59.513] Starting with no config file. [09:52:59.515] Output repaint window is 7 ms maximum. [09:52:59.516] Loading module \u0026#39;/usr/local/lib/libweston-2/drm-backend.so\u0026#39; [09:52:59.520] initializing drm backend [09:52:59.526] using /dev/dri/card0 [09:52:59.528] Loading module \u0026#39;/usr/local/lib/libweston-2/gl-renderer.so\u0026#39; [09:52:59.586] EGL client extensions: EGL_EXT_client_extensions EGL_EXT_platform_base EGL_KHR_client_get_all_proc_addresses EGL_KHR_debug EGL_EXT_platform_wayland EGL_MESA_platform_gbm [09:52:59.588] warning: neither EGL_EXT_swap_buffers_with_damage or EGL_KHR_swap_buffers_with_damage is supported. Performance could be affected. [09:52:59.588] EGL_KHR_surfaceless_context available [09:52:59.596] EGL version: 1.4 (DRI2) [09:52:59.596] EGL vendor: Mesa Project [09:52:59.596] EGL client APIs: OpenGL OpenGL_ES [09:52:59.597] EGL extensions: EGL_EXT_buffer_age EGL_EXT_image_dma_buf_import EGL_KHR_cl_event2 EGL_KHR_config_attribs EGL_KHR_create_context EGL_KHR_fence_sync EGL_KHR_get_all_proc_addresses EGL_KHR_gl_renderbuffer_image EGL_KHR_gl_texture_2D_image EGL_KHR_gl_texture_cubemap_image EGL_KHR_image EGL_KHR_image_base EGL_KHR_image_pixmap EGL_KHR_no_config_context EGL_KHR_reusable_sync EGL_KHR_surfaceless_context EGL_KHR_wait_sync EGL_MESA_configless_context EGL_MESA_drm_image EGL_MESA_image_dma_buf_export EGL_WL_bind_wayland_display [09:52:59.597] GL version: OpenGL ES 2.0 Mesa 17.1.1 (git-ca0a148) [09:52:59.598] GLSL version: OpenGL ES GLSL ES 1.0.16 [09:52:59.598] GL vendor: Broadcom [09:52:59.598] GL renderer: Gallium 0.4 on VC4 V3D 2.1 [09:52:59.598] GL extensions: GL_EXT_blend_minmax GL_EXT_multi_draw_arrays GL_EXT_texture_format_BGRA8888 GL_OES_compressed_ETC1_RGB8_texture GL_OES_depth24 GL_OES_element_index_uint GL_OES_fbo_render_mipmap GL_OES_mapbuffer GL_OES_rgb8_rgba8 GL_OES_stencil8 GL_OES_texture_3D GL_OES_texture_npot GL_OES_vertex_half_float GL_OES_EGL_image GL_OES_depth_texture GL_OES_packed_depth_stencil GL_EXT_texture_type_2_10_10_10_REV GL_OES_get_program_binary GL_APPLE_texture_max_level GL_EXT_discard_framebuffer GL_EXT_read_format_bgra GL_EXT_frag_depth GL_NV_fbo_color_attachments GL_OES_EGL_image_external GL_OES_EGL_sync GL_OES_vertex_array_object GL_EXT_unpack_subimage GL_NV_draw_buffers GL_NV_read_buffer GL_NV_read_depth GL_NV_read_depth_stencil GL_NV_read_stencil GL_EXT_draw_buffers GL_EXT_map_buffer_range GL_KHR_debug GL_OES_surfaceless_context GL_EXT_separate_shader_objects GL_EXT_compressed_ETC1_RGB8_sub_texture GL_EXT_draw_elements_base_vertex GL_EXT_texture_border_clamp GL_KHR_context_flush_control GL_OES_draw_elements_base_vertex GL_OES_texture_border_clamp [09:52:59.599] GL ES 2 renderer features: read-back format: BGRA wl_shm sub-image to texture: yes EGL Wayland extension: yes [09:52:59.601] event0 - [09:52:59.601] USB Keyboard: [09:52:59.601] is tagged by udev as: Keyboard [09:52:59.601] event0 - [09:52:59.601] USB Keyboard: [09:52:59.601] device is a keyboard [09:52:59.602] event1 - [09:52:59.602] USB Keyboard: [09:52:59.602] is tagged by udev as: Keyboard [09:52:59.602] event1 - [09:52:59.602] USB Keyboard: [09:52:59.602] device is a keyboard [09:52:59.603] event2 - [09:52:59.603] USB Optical Mouse: [09:52:59.603] is tagged by udev as: Mouse [09:52:59.603] event2 - [09:52:59.604] USB Optical Mouse: [09:52:59.604] device is a pointer [09:52:59.654] Registered plugin API \u0026#39;weston_drm_output_api_v1\u0026#39; of size 12 [09:52:59.655] Chosen EGL config details: RGBA bits: 8 8 8 0 swap interval range: 0 - 0 [09:52:59.655] Failed to initialize backlight [09:52:59.655] EDID data \u0026#39;BNQ\u0026#39;, \u0026#39;BenQ GW2265\u0026#39;, \u0026#39;87E05314019\u0026#39; [09:52:59.656] Output HDMI-A-1, (connector 24, crtc 65) mode 1920x1080@60.0, preferred, current mode 1920x1080@59.9 mode 1920x1080@60.0 mode 1920x1080@59.9 mode 1920x1080@50.0 mode 1920x1080@50.0 mode 1680x1050@59.9 mode 1600x900@60.0 mode 1280x1024@60.0 mode 1280x800@59.9 mode 1280x720@60.0 mode 1280x720@59.9 mode 1280x720@50.0 mode 1024x768@60.0 mode 800x600@60.3 mode 720x576@50.0 mode 720x576@50.0 mode 720x480@60.0 mode 720x480@59.9 mode 720x480@60.0 mode 720x480@59.9 mode 640x480@60.0 mode 640x480@59.9 [09:52:59.656] Compositor capabilities: arbitrary surface rotation: yes screen capture uses y-flip: yes presentation clock: CLOCK_MONOTONIC, id 1 presentation clock resolution: 0.000000001 s [09:52:59.657] Loading module \u0026#39;/usr/local/lib/weston/desktop-shell.so\u0026#39; [09:52:59.658] launching \u0026#39;/usr/local/libexec/weston-keyboard\u0026#39; [09:52:59.660] launching \u0026#39;/usr/local/libexec/weston-desktop-shell\u0026#39; could not load cursor \u0026#39;dnd-move\u0026#39; could not load cursor \u0026#39;dnd-copy\u0026#39; could not load cursor \u0026#39;dnd-none\u0026#39; could not load cursor \u0026#39;dnd-move\u0026#39; could not load cursor \u0026#39;dnd-copy\u0026#39; could not load cursor \u0026#39;dnd-none\u0026#39; xkbcommon: ERROR: couldn\u0026#39;t find a Compose file for locale \u0026#34;en_US.UTF-8\u0026#34; could not create XKB compose table for locale \u0026#39;en_US.UTF-8\u0026#39;. Disabiling compose xkbcommon: ERROR: couldn\u0026#39;t find a Compose file for locale \u0026#34;en_US.UTF-8\u0026#34; could not create XKB compose table for locale \u0026#39;en_US.UTF-8\u0026#39;. Disabiling compose could not load cursor \u0026#39;dnd-move\u0026#39; could not load cursor \u0026#39;dnd-copy\u0026#39; could not load cursor \u0026#39;dnd-none\u0026#39; xkbcommon: ERROR: couldn\u0026#39;t find a Compose file for locale \u0026#34;en_US.UTF-8\u0026#34; could not create XKB compose table for locale \u0026#39;en_US.UTF-8\u0026#39;. Disabiling compose weston-simple-egl score root@RPi3:/home/oopsmonk# weston-simple-egl has EGL_EXT_buffer_age and EGL_EXT_swap_buffers_with_damage 152 frames in 5 seconds: 30.400000 fps 151 frames in 5 seconds: 30.200001 fps 151 frames in 5 seconds: 30.200001 fps ^Csimple-egl exiting root@RPi3:/home/oopsmonk# weston-simple-egl -b has EGL_EXT_buffer_age and EGL_EXT_swap_buffers_with_damage 32542 frames in 5 seconds: 6508.399902 fps Draw call returned Invalid argument. Expect corruption. 30634 frames in 5 seconds: 6126.799805 fps 28265 frames in 5 seconds: 5653.000000 fps 34501 frames in 5 seconds: 6900.200195 fps 32658 frames in 5 seconds: 6531.600098 fps ^Csimple-egl exiting root@RPi3:/home/oopsmonk# weston-simple-egl -f has EGL_EXT_buffer_age and EGL_EXT_swap_buffers_with_damage 300 frames in 5 seconds: 60.000000 fps 300 frames in 5 seconds: 60.000000 fps 300 frames in 5 seconds: 60.000000 fps 300 frames in 5 seconds: 60.000000 fps 300 frames in 5 seconds: 60.000000 fps ^Csimple-egl exiting root@RPi3:/home/oopsmonk# weston-simple-egl -f -b has EGL_EXT_buffer_age and EGL_EXT_swap_buffers_with_damage 1350 frames in 5 seconds: 270.000000 fps 1325 frames in 5 seconds: 265.000000 fps 1325 frames in 5 seconds: 265.000000 fps ^Csimple-egl exiting GLMark2 root@RPi3:/home/oopsmonk# glmark2-es2-wayland ======================================================= glmark2 2014.03 ======================================================= OpenGL Information GL_VENDOR: Broadcom GL_RENDERER: Gallium 0.4 on VC4 V3D 2.1 GL_VERSION: OpenGL ES 2.0 Mesa 17.1.1 (git-ca0a148) ======================================================= [build] use-vbo=false: FPS: 281 FrameTime: 3.559 ms [build] use-vbo=true: FPS: 303 FrameTime: 3.300 ms [texture] texture-filter=nearest: FPS: 375 FrameTime: 2.667 ms [texture] texture-filter=linear: FPS: 345 FrameTime: 2.899 ms [texture] texture-filter=mipmap: FPS: 289 FrameTime: 3.460 ms [shading] shading=gouraud: FPS: 199 FrameTime: 5.025 ms [shading] shading=blinn-phong-inf: FPS: 145 FrameTime: 6.897 ms [shading] shading=phong: FPS: 85 FrameTime: 11.765 ms [shading] shading=cel: FPS: 84 FrameTime: 11.905 ms [bump] bump-render=high-poly: FPS: 80 FrameTime: 12.500 ms [bump] bump-render=normals: FPS: 461 FrameTime: 2.169 ms [bump] bump-render=height: FPS: 390 FrameTime: 2.564 ms [effect2d] kernel=0,1,0;1,-4,1;0,1,0;: FPS: 161 FrameTime: 6.211 ms [effect2d] kernel=1,1,1,1,1;1,1,1,1,1;1,1,1,1,1;: FPS: 85 FrameTime: 11.765 ms [pulsar] light=false:quads=5:texture=false: FPS: 314 FrameTime: 3.185 ms [desktop] blur-radius=5:effect=blur:passes=1:separable=true:windows=4: FPS: 40 FrameTime: 25.000 ms [desktop] effect=shadow:windows=4: FPS: 121 FrameTime: 8.264 ms [buffer] columns=200:interleave=false:update-dispersion=0.9:update-fraction=0.5:update-method=map: FPS: 59 FrameTime: 16.949 ms [buffer] columns=200:interleave=false:update-dispersion=0.9:update-fraction=0.5:update-method=subdata: FPS: 59 FrameTime: 16.949 ms [buffer] columns=200:interleave=true:update-dispersion=0.9:update-fraction=0.5:update-method=map: FPS: 75 FrameTime: 13.333 ms [ideas] speed=duration: FPS: 269 FrameTime: 3.717 ms [jellyfish] \u0026lt;default\u0026gt;: FPS: 138 FrameTime: 7.246 ms [terrain] \u0026lt;default\u0026gt;: FPS: 5 FrameTime: 200.000 ms [shadow] \u0026lt;default\u0026gt;: FPS: 106 FrameTime: 9.434 ms [refract] \u0026lt;default\u0026gt;: FPS: 21 FrameTime: 47.619 ms [conditionals] fragment-steps=0:vertex-steps=0: FPS: 392 FrameTime: 2.551 ms [conditionals] fragment-steps=5:vertex-steps=0: FPS: 259 FrameTime: 3.861 ms [conditionals] fragment-steps=0:vertex-steps=5: FPS: 389 FrameTime: 2.571 ms [function] fragment-complexity=low:fragment-steps=5: FPS: 357 FrameTime: 2.801 ms [function] fragment-complexity=medium:fragment-steps=5: FPS: 48 FrameTime: 20.833 ms [loop] fragment-loop=false:fragment-steps=5:vertex-steps=5: FPS: 329 FrameTime: 3.040 ms [loop] fragment-steps=5:fragment-uniform=false:vertex-steps=5: FPS: 329 FrameTime: 3.040 ms [loop] fragment-steps=5:fragment-uniform=true:vertex-steps=5: FPS: 119 FrameTime: 8.403 ms ======================================================= glmark2 Score: 203 ======================================================= GLMark2 Fullscreen root@RPi3:/home/oopsmonk# glmark2-es2-wayland --fullscreen ======================================================= glmark2 2014.03 ======================================================= OpenGL Information GL_VENDOR: Broadcom GL_RENDERER: Gallium 0.4 on VC4 V3D 2.1 GL_VERSION: OpenGL ES 2.0 Mesa 17.1.1 (git-ca0a148) ======================================================= [build] use-vbo=false: FPS: 183 FrameTime: 5.464 ms [build] use-vbo=true: FPS: 200 FrameTime: 5.000 ms [texture] texture-filter=nearest: FPS: 198 FrameTime: 5.051 ms [texture] texture-filter=linear: FPS: 192 FrameTime: 5.208 ms [texture] texture-filter=mipmap: FPS: 190 FrameTime: 5.263 ms [shading] shading=gouraud: FPS: 166 FrameTime: 6.024 ms [shading] shading=blinn-phong-inf: FPS: 162 FrameTime: 6.173 ms [shading] shading=phong: FPS: 134 FrameTime: 7.463 ms [shading] shading=cel: FPS: 128 FrameTime: 7.812 ms [bump] bump-render=high-poly: FPS: 77 FrameTime: 12.987 ms [bump] bump-render=normals: FPS: 202 FrameTime: 4.950 ms [bump] bump-render=height: FPS: 188 FrameTime: 5.319 ms [effect2d] kernel=0,1,0;1,-4,1;0,1,0;: FPS: 65 FrameTime: 15.385 ms [effect2d] kernel=1,1,1,1,1;1,1,1,1,1;1,1,1,1,1;: FPS: 33 FrameTime: 30.303 ms [pulsar] light=false:quads=5:texture=false: FPS: 173 FrameTime: 5.780 ms [desktop] blur-radius=5:effect=blur:passes=1:separable=true:windows=4: FPS: 16 FrameTime: 62.500 ms [desktop] effect=shadow:windows=4: FPS: 48 FrameTime: 20.833 ms [buffer] columns=200:interleave=false:update-dispersion=0.9:update-fraction=0.5:update-method=map: FPS: 51 FrameTime: 19.608 ms [buffer] columns=200:interleave=false:update-dispersion=0.9:update-fraction=0.5:update-method=subdata: FPS: 51 FrameTime: 19.608 ms [buffer] columns=200:interleave=true:update-dispersion=0.9:update-fraction=0.5:update-method=map: FPS: 51 FrameTime: 19.608 ms [ideas] speed=duration: FPS: 126 FrameTime: 7.937 ms [jellyfish] \u0026lt;default\u0026gt;: FPS: 70 FrameTime: 14.286 ms [terrain] \u0026lt;default\u0026gt;: FPS: 2 FrameTime: 500.000 ms [shadow] \u0026lt;default\u0026gt;: FPS: 84 FrameTime: 11.905 ms [refract] \u0026lt;default\u0026gt;: FPS: 17 FrameTime: 58.824 ms [conditionals] fragment-steps=0:vertex-steps=0: FPS: 205 FrameTime: 4.878 ms [conditionals] fragment-steps=5:vertex-steps=0: FPS: 122 FrameTime: 8.197 ms [conditionals] fragment-steps=0:vertex-steps=5: FPS: 209 FrameTime: 4.785 ms [function] fragment-complexity=low:fragment-steps=5: FPS: 176 FrameTime: 5.682 ms [function] fragment-complexity=medium:fragment-steps=5: FPS: 79 FrameTime: 12.658 ms [loop] fragment-loop=false:fragment-steps=5:vertex-steps=5: FPS: 171 FrameTime: 5.848 ms [loop] fragment-steps=5:fragment-uniform=false:vertex-steps=5: FPS: 172 FrameTime: 5.814 ms [loop] fragment-steps=5:fragment-uniform=true:vertex-steps=5: FPS: 58 FrameTime: 17.241 ms ======================================================= glmark2 Score: 121 ======================================================= GLMark2 repaint time glmark2 set eglSwapInterval() to 0, so it will not waite for vblank.\ncanvas_clear: glClearColor, glClearDepthf, glClear\nsence_draw: glBindBuffer, glBindBuffer\nsence_update: update frame counter and elapsed time\ncanvas_update: eglSwapBuffers, wl_display_roundtrip\ntotal_draw: canvas_clear + sence_draw + canvas_update\n","permalink":"https://oopsmonk.github.io/posts/2017-06-05-raspberrypi3-glmark2-using-weston-with-drm-backend/","summary":"How to use weston with DRM backend in Raspbian, and gets benchmark score by GLMark2.\nWith regards to hardware acceleration, We can enable VC4 driver through raspi-config.\n# update system and raspi-config script $ sudo apt-get update \u0026amp;\u0026amp; sudo apt-get upgrade $ sudo apt-get install raspi-config # enable Broadcom VC4 driver $ sudo raspi-config Advanced Options -\u0026gt; GL Driver -\u0026gt; GL (Full KMS) Test environment:\n2017-04-10-raspbian-jessie-lite HDMI 1080P 60Hz CPU/GPU use default settings(no overclock) Test packages:","title":"RaspberryPi3: GLMark2 using weston with DRM backend"},{"content":"以前球隊在回防時, 教練總會說\u0026quot;快跑! 別回頭, 到定點再休息\u0026quot;.\n關於人生, 喘息點在哪兒? 我想就在滴水穿石之間!\n主要在了解linux graphic system架構, 並分析wayland weston compositor/glmark2的repaint flow.\nWeek18 (05/05) 網路文章 和百年公斤原器說再見！七大國際單位制將改頭換面\n原來用抽像來定義實體早己行之有年.\n網路資源 C++ Language Interface Foundation (CLIF)\nGoogle 做了一個C++ wrapper generator, 目前看來只for Python, 目標是支援更多的語言.\nWeek19 (05/12) 網路文章 Weston repaint scheduling\nWeek20 (05/19) Wayland的weston compositor可透過wesgr來分析repaint過程. glmark2-es2-wayland 加入debug去看glmark repaint過程\n[18:50:21.959] canvas_clear 1510 us [18:50:21.960] scenc_draw 389 us [18:50:21.960] scenc_update 159 us [18:50:21.960] weston weston_output_repaint[+] [18:50:21.960] weston surface_flush_damage [18:50:21.960] weston surface_flush_damage [18:50:21.961] weston surface_flush_damage [18:50:21.961] weston surface_flush_damage [18:50:21.969] weston weston_output_repaint[-] [18:50:21.970] weston weston_output_finish_frame [18:50:21.972] weston weston_surface_commit_state [18:50:21.972] weston core_repaint_req [18:50:21.972] canvas_update 12193 us [18:50:21.972] glmark2 draw 14443 us 網路文章 Boosting Site Speed Using Brotli Compression\nLinkedIn 使用Brotli 壓縮提高網頁的瀏覽速度, 並使用JavaScript檔案做了Brotli, Zopfli, and gzip演算法比較,\n壓縮後的空間以gzip -6為基準Brotil -11結省30%, Brotli -5結省14%左右, Zopfli -1000結省約5%.\n時間上gzip -6 壓縮169ms, 解壓35ms, Brotli -11 壓縮11913ms, 解壓22ms, Brotli壓縮時間花的較長, 但解壓及壓縮率完勝.\n最終的A/B Test, 網頁在美國地區快了2~3.6%, 印度地區快了6~6.5%.\nLinkedIn 計劃採用Dynamic Brotli 處理動態資料(Base HTML document, JSON API responses, etc.), 也需要改善gzip以配合不支援Brotli的Browser.\nBrowser support:\nChrome version 49 Firefox version 44 Microsoft Edge version 15 Opera version 36 Safari version 10 How to: Brotli compression with Nginx\nngx_http_gzip_module\n網路資源 WebPage Speed Analysis\n網頁速度測試.\n交大線上課程- 作業系統設計與實作(OSDI)\nWeek21 (05/26) Ubuntu系統在screen lock後要unlock有時會卡在黑畫面, 這是個頭痛的問題, 通常在是編Android時去lock然後unlock就回不來.\n因為是偶爾發生, 之前都是reboot來解決, 發現這個問題存在很久, google到了一些相關的bug report, 看來暫時還是無解.\n試過使用sudo service lightdm restart\nblack screen after longer screen lock\nCan\u0026rsquo;t login after lock screen (black screen) ","permalink":"https://oopsmonk.github.io/posts/2017-05-31-2017month5/","summary":"以前球隊在回防時, 教練總會說\u0026quot;快跑! 別回頭, 到定點再休息\u0026quot;.\n關於人生, 喘息點在哪兒? 我想就在滴水穿石之間!\n主要在了解linux graphic system架構, 並分析wayland weston compositor/glmark2的repaint flow.\nWeek18 (05/05) 網路文章 和百年公斤原器說再見！七大國際單位制將改頭換面\n原來用抽像來定義實體早己行之有年.\n網路資源 C++ Language Interface Foundation (CLIF)\nGoogle 做了一個C++ wrapper generator, 目前看來只for Python, 目標是支援更多的語言.\nWeek19 (05/12) 網路文章 Weston repaint scheduling\nWeek20 (05/19) Wayland的weston compositor可透過wesgr來分析repaint過程. glmark2-es2-wayland 加入debug去看glmark repaint過程\n[18:50:21.959] canvas_clear 1510 us [18:50:21.960] scenc_draw 389 us [18:50:21.960] scenc_update 159 us [18:50:21.960] weston weston_output_repaint[+] [18:50:21.960] weston surface_flush_damage [18:50:21.960] weston surface_flush_damage [18:50:21.961] weston surface_flush_damage [18:50:21.961] weston surface_flush_damage [18:50:21.","title":"LGS Hell"},{"content":"Linux graphic 架構還滿複雜的, 在看時需要大略了解几個名詞及之間的關係.\nX Window System:\n目前來到第11版本所以叫X11, 是以X window System Core protocol為基礎的window system.\nwayland:\n由於X11太過複雜且在embbeded system中的效能不佳, 用來取代X window System Core protocol.\nweston (wayland compositor):\n以wayland protocol來實做的compositor做為參考的範例, 實用上會用Westeros, Clutter\u0026hellip;等.\nKMS/UMS:\nKernel mode-setting 及User mode-setting.\nOpenGL: 由Khronos Group制定的跨平台graphic API.\nGLX:\n是一個extension, 做為OpenGL與X window system之間的橋樑. 就像embedded system的EGL, MacOS的AGL.\nDRM(Direct Rendering Manager):\n為了防止世界被破壞, 保護世界的和平. 防止同時使用graphic buffer.\nDRI(Direct Rendering Infrastructure):\nMesa及DRM之間的橋樑. Ref: Introduction to the Direct Rendering Infrastructure\nCRTC (CRT Controller):\nCrtc is in charge of reading the framebuffer memory and routes the data to an encoder.\nOther resources:\nLinux GPU Driver Developer’s Guide\ndri-explanation.txt\nLinux Graphics Drivers: an Introduction\nDirect Rendering Manager (DRM)\nUsing Linux Media Controller for Wayland/Weston Renderer\nGraphics Stack Update\nGraphic Architectures Linux Graphics Stack 2013 Source\nIntel Graphics Stack Architecture Diagram Source\nWayland/X11 Graphics Architecture Source Android Graphics Architecture Source\n","permalink":"https://oopsmonk.github.io/posts/2017-05-30-linux-graphic-stack/","summary":"Linux graphic 架構還滿複雜的, 在看時需要大略了解几個名詞及之間的關係.\nX Window System:\n目前來到第11版本所以叫X11, 是以X window System Core protocol為基礎的window system.\nwayland:\n由於X11太過複雜且在embbeded system中的效能不佳, 用來取代X window System Core protocol.\nweston (wayland compositor):\n以wayland protocol來實做的compositor做為參考的範例, 實用上會用Westeros, Clutter\u0026hellip;等.\nKMS/UMS:\nKernel mode-setting 及User mode-setting.\nOpenGL: 由Khronos Group制定的跨平台graphic API.\nGLX:\n是一個extension, 做為OpenGL與X window system之間的橋樑. 就像embedded system的EGL, MacOS的AGL.\nDRM(Direct Rendering Manager):\n為了防止世界被破壞, 保護世界的和平. 防止同時使用graphic buffer.\nDRI(Direct Rendering Infrastructure):\nMesa及DRM之間的橋樑. Ref: Introduction to the Direct Rendering Infrastructure\nCRTC (CRT Controller):\nCrtc is in charge of reading the framebuffer memory and routes the data to an encoder.","title":"Linux Graphic Stack相關的名詞"},{"content":"How to enable and test gzip in Nginx.\nOfficial document: ngx_http_gzip_module\nEnable gzip I use Raspberry Pi System Monitor to test gzip module.\nModify /etc/nginx/sites-available/default to enable gzip.\nIn this case I only change the RpiMonitor website in the server, you can apply it to global by /etc/nginx/nginx.conf\nlocation /rpi { proxy_pass http://127.0.0.1:9999/RpiMonitor; } Change to\nlocation /rpi { proxy_pass http://127.0.0.1:9999/RpiMonitor; gzip on; gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript; gzip_proxied any; } Then reload nginx.conf via sudo nginx -s reload\nTest and Result Before gzip enable:\n$ curl -I -H \u0026#34;Accept-Encoding: gzip\u0026#34; http://xxx.xxx.com.tw/rpi/assets/javascriptrrd.wlibs.min.js HTTP/1.1 200 OK Server: nginx/1.6.2 Date: Fri, 19 May 2017 07:13:57 GMT Content-Type: application/javascript Content-Length: 212364 Connection: keep-alive Last-Modified: Tue, 30 Dec 2014 06:47:20 GMT Accept-Ranges: bytes After gzip enable:\n$ curl -I -H \u0026#34;Accept-Encoding: gzip\u0026#34; http://xxx.xxx.com.tw/rpi/assets/javascriptrrd.wlibs.min.js HTTP/1.1 200 OK Server: nginx/1.6.2 Date: Fri, 19 May 2017 07:14:37 GMT Content-Type: application/javascript Connection: keep-alive Last-Modified: Tue, 30 Dec 2014 06:47:20 GMT Content-Encoding: gzip WebPage Speed Analysis result:\nAdditional resource - How to: Brotli compression with Nginx\n","permalink":"https://oopsmonk.github.io/posts/2017-05-19-enable-gzip-compression-in-nginx/","summary":"How to enable and test gzip in Nginx.\nOfficial document: ngx_http_gzip_module\nEnable gzip I use Raspberry Pi System Monitor to test gzip module.\nModify /etc/nginx/sites-available/default to enable gzip.\nIn this case I only change the RpiMonitor website in the server, you can apply it to global by /etc/nginx/nginx.conf\nlocation /rpi { proxy_pass http://127.0.0.1:9999/RpiMonitor; } Change to\nlocation /rpi { proxy_pass http://127.0.0.1:9999/RpiMonitor; gzip on; gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript; gzip_proxied any; } Then reload nginx.","title":"Enable gzip compression in Nginx"},{"content":"以前球隊在回防時, 教練總會說\u0026quot;快跑! 別回頭, 到定點再休息\u0026quot;.\n關於人生, 喘息點在哪兒? 我想就在滴水穿石之間!\n失速的這個月\nWeek14 (04/07) 網路文章 Adding A New System Service To Android 5: Tips and How To\n由下到上打造一個android system service. HW -\u0026gt; HAL -\u0026gt; JNI -\u0026gt; Service -\u0026gt; Manager -\u0026gt; Registering.\nAdding New System Service in Android\nNative system service.\n33 Foods that Starve Cancer\n滿有趣的論點, 細胞沒有supplement會死亡沒錯, 但microscopic cancers能否自己生出新的血管?\n大部份的癌症無關基因, 超過40歲體內難免會有microscopic cells, 並可能轉變成cancer cells?\nWeek15 (04/14) img2ascii.py 參考網路上的做法, 加了些參數方便調整輸出的內容. pillow提供便利的API.\n網路文章 Every attempt to manage academia makes it worse\nGoodhart’s Law： \u0026ldquo;When a measure becomes a target, it ceases to be a good measure.\u0026rdquo;\n為了打分數而訂出的評分系統, 不就是考試?!\n衡量對錯本來就很難（也許本身就是個假議題）, 就像\u0026quot;找到一個對的人做對的事\u0026quot;.\nThe Cobra Effect： 在大公司應該是無可避免的. 網路資源 Python libhunt\n可用找lib, 比較lib之間的活躍程度, Code Quality L1是較差, L5較佳.\n除了python之外, 還有C++, Android, Java, Javascript\u0026hellip;等. 讀書心得 The Handstand Builder For Women - Week1\nRecap Week1, 有些人說Handstand不太需要flexibility, 我的經驗是stretches也是很重要的, 靈活的關節/彈性的肌肉能避免運動傷害. Reverse Plank: 有助於倒立時開胸姿態\nHandstand against the wall: 讓身體習慣倒立姿態\nCrescent Lunge/Seated Hamstring Stretch: 腿離地時腳筋的柔軟度很重要, 柔軟度不夠需要更大的肌力做平衡. Week16 (04/21) 網路文章 What is the difference between venv, pyvenv, pyenv, virtualenv, virtualenvwrapper, pipenv, etc?\n一般是用virtualenv測試module需要哪些python packages, pyenv來測試module在不同的python2.6, python2.7, python3.5, python3.6是否正常.\nvirtualenvwrapper是加強virtualenv的plugin, 將不同的環境放在同一個目錄方便管理.\nWhat is Data Science? 24 Fundamental Articles Answering This Question\nData Science要的是通才.\nbuildRoot study - 建立自己的作業系統\nBuildroot架構解析\n網路資源 free electrons Doc\nBuildroot and Embedded Linux 相關資源\n500 Data structures and algorithms interview questions and their solutions\n面試時的資料結構與演算法考題及解法, 來源: http://www.techiedelight.com/\n讀書心得 Telling children \u0026lsquo;hard work gets you to the top\u0026rsquo; is simply a lie\nWorking hard is the starting line, so much more is required.\nYou need to adapt yourself. You need to find the right way to speak to different people, at different times in different contexts. This is not compromising who you are, but rather adapting to the relevant surroundings. Week17 (04/28) 沒時間做leetcode Challenge\u0026hellip;.gg\n網路文章 Announcing WebKit for Wayland (WPE)\nThe Hello Wayland Tutorial\n網路資源 WebKit + Gstreamer + WebGL + Canvas + MSE + EME\nProgramming Wayland Clients\nlibinput\n讀書心得 摸摸Wayland/Weston/WPE, 了解大方向.\nBuildroot https://buildroot.org/docs.html, http://free-electrons.com/\n類似yocto, LFS(Linux From Scratch), free electrons這家公司有提供教育訓練.\nWPE （WebKit Wayland, Web Platform for Embedded）\n由Metrological及Igalia在開發, 主要用於基於Webkit2 + Wayland的平台.\nWebkit原本是 single process, Webkit2為mulit-process架構. https://trac.webkit.org/wiki/WebKit2\nWayland (Wayland protocol) https://wayland.freedesktop.org/docs/html/\n主要因為Linux X server太過於複雜及效能不佳(render,compositor都在window manager完成), 推出client-server 架構的protocol, 在client為render， server為compositor， 並分享memory buffer做到zero copy, 能夠確保每個output frame都是完整的.\nWiki - https://goo.gl/ukqgJC\nWeston (compositor/ wayland server):\nWayland裡的server side， 其它的有Westeros, Mutter, KWin\u0026hellip;\n在RPi 及 Xubuntu 系統把玩WPE/Wayland/Weston Buildroot for WPE - https://github.com/WebPlatformForEmbedded/buildroot\nRaspberry Pi 3 with WPE：\nmake raspberrypi3_wpe_defconfig \u0026amp;\u0026amp; make -j32\n可以編出output/images/sdcard.img\nraspberrypi3_wpe_ml_defconfig好像是使用mlbrwoser沒有詳細研究\nweston跑起來是使用fbdev-backend\n使用YoutubeTV\nwpe https://youtube.com/tv 可以播影片及用鍵盤操控， 無法使用滑鼠.\n跑起來後ps可看到\n703 root {wpe} /bin/sh /usr/bin/wpe https://youtube.com/tv 707 root WPELauncher https://youtube.com/tv 712 root /usr/bin/WPENetworkProcess 7 715 root /usr/bin/WPEWebProcess 14 -1 使用Youtube 網站\nwpe https://www.youtube.com 有畫面但無法操控\nwayland-build-tools - https://github.com/wayland-project/wayland-build-tools\nVirtualbox裝 Xubuntu 16.04.2 LTS測試, 跑起來是使用x11-backend\nleetcode Challenge - C lang 利用瑣碎的時間完成leetcode上基本(easy)的題目.\nNo20_ValidParentheses.c\n這個做法在malloc會有太大或太小的問題.\nNo155_MinStack.c\nminStackGetMin用for loop是偷懶的做法.\n","permalink":"https://oopsmonk.github.io/posts/2017-04-01-2017month4/","summary":"以前球隊在回防時, 教練總會說\u0026quot;快跑! 別回頭, 到定點再休息\u0026quot;.\n關於人生, 喘息點在哪兒? 我想就在滴水穿石之間!\n失速的這個月\nWeek14 (04/07) 網路文章 Adding A New System Service To Android 5: Tips and How To\n由下到上打造一個android system service. HW -\u0026gt; HAL -\u0026gt; JNI -\u0026gt; Service -\u0026gt; Manager -\u0026gt; Registering.\nAdding New System Service in Android\nNative system service.\n33 Foods that Starve Cancer\n滿有趣的論點, 細胞沒有supplement會死亡沒錯, 但microscopic cancers能否自己生出新的血管?\n大部份的癌症無關基因, 超過40歲體內難免會有microscopic cells, 並可能轉變成cancer cells?\nWeek15 (04/14) img2ascii.py 參考網路上的做法, 加了些參數方便調整輸出的內容. pillow提供便利的API.\n網路文章 Every attempt to manage academia makes it worse","title":"失速列車"},{"content":"Study USB MTP Device and Host mode in Android M.\nSource Code Cross Reference: Android 6.0.1_r10\nMTP Device Mode Enable device mode:\nSettings -\u0026gt; Developer options -\u0026gt; Select USB Configuration -\u0026gt; MTP\nUsbDeviceManager: Setting USB config to mtp\ndevice/lge/hammerhead/init.hammerhead.usb.rc : on property:sys.usb.config=mtp\nsystem/core/rootdir/init.usb.configfs.rc: on property:sys.usb.config=mtp \u0026amp;\u0026amp; property:sys.usb.configfs=1\nUSB plug to PC:\nMtpReceiver: listen to android.hardware.usb.action.USB_STATE and bring up MtpService\nUsbDeviceManager: get uevent USB_STATE=CONFIGURED from kernel\nMtpService: create MtpDatabase MtpDatabase: create volume and storage path\nMtpService: starting MTP server in MTP mode\nStart transfer data to PC:\nMtpDatabase: getObjectList storageID 65537 , formate 0 , parent -1\nMtpDatabase: object_query to get object from media provider.\nHandle UEVENT from Kernel, UsbHandler send MSG_UPDATE_STATE to UsbDeviceManager\nframeworks/base/services/usb/java/com/android/server/usb/UsbDeviceManager.java handleUsbState start MTPService\npackages/providers/MediaProvider/src/com/android/providers/media/MtpReceiver.java Set USB function: setCurrentFunction\nframeworks/base/core/java/android/hardware/usb/UsbManager.java MTP Host Mode UsbHostManager uses monitorUsbHostBus function to monitor usb’s event when system ready. monitorUsbHostBus is implemented at android_server_UsbHostManager_monitorUsbHostBus in JNI.\nframeworks/base/services/usb/java/com/android/server/usb/UsbHostManager.java frameworks/base/services/core/jni/com_android_server_UsbHostManager.cpp After receiving USB attach event(ACTION_USB_DEVICE_ATTACHED) UsbHostManager adds an USB device via endUsbDeviceAdded() function, and deviceAttached() is called to figure out which activity should be lunched. Meanwhile, MtpClient will try to open MTP device use openDeviceLocked() function.\nframeworks/base/services/usb/java/com/android/server/usb/UsbSettingsManager.java packages/apps/Gallery2/src/com/android/gallery3d/data/MtpClient.java In this case IngestActivity is selected from UsbSettingsManager::resolveActivity(). Because class is 6 and subclass is 1 in USB configuration that is matched in IngestActivity’s device_fileter.xml file.\npackages/apps/Gallery2/res/xml/device_filter.xml When IngestActivity is created, it will bind to IngestService which handled MTP protocol and provided MTP’s functionality.\npackages/apps/Gallery2/src/com/android/gallery3d/ingest/IngestActivity.java packages/apps/Gallery2/src/com/android/gallery3d/ingest/IngestService.java MTP device detection issue in host mode Android uses mClass, mSubclass, and mProtocal values in UsbInterface object to detect MTP devices.\nFor instance:\niPhone: UsbInterface[mId=0,mAlternateSetting=0,mName=null,mClass=6,mSubclass=1,mProtocol=1 Samsung: UsbInterface[mId=0,mAlternateSetting=0,mName=MTP,mClass=6,mSubclass=1,mProtocol=1 Sony: UsbInterface[mId=0,mAlternateSetting=0,mName=MTP,mClass=255,mSubclass=255,mProtocol=0 The Sony cannot recognised as a MTP device.\nWe can modify MtpClient and device_filter.xml to fix this issue.\nRelate source code packages/providers/MediaProvider/src/com/android/providers/media/MtpReceiver.java packages/providers/MediaProvider/src/com/android/providers/media/MtpService.java packages/providers/MediaProvider/AndroidManifest.xml frameworks/base/services/usb/java/com/android/server/usb/ frameworks/base/media/java/android/mtp/ frameworks/base/media/jni/android_mtp_* frameworks/av/media/mtp/ device/lge/hammerhead/init.hammerhead.usb.rc system/core/rootdir/init.usb.configfs.rc ","permalink":"https://oopsmonk.github.io/posts/2017-04-18-android-usb-media-transfer-protocol/","summary":"Study USB MTP Device and Host mode in Android M.\nSource Code Cross Reference: Android 6.0.1_r10\nMTP Device Mode Enable device mode:\nSettings -\u0026gt; Developer options -\u0026gt; Select USB Configuration -\u0026gt; MTP\nUsbDeviceManager: Setting USB config to mtp\ndevice/lge/hammerhead/init.hammerhead.usb.rc : on property:sys.usb.config=mtp\nsystem/core/rootdir/init.usb.configfs.rc: on property:sys.usb.config=mtp \u0026amp;\u0026amp; property:sys.usb.configfs=1\nUSB plug to PC:\nMtpReceiver: listen to android.hardware.usb.action.USB_STATE and bring up MtpService\nUsbDeviceManager: get uevent USB_STATE=CONFIGURED from kernel\nMtpService: create MtpDatabase MtpDatabase: create volume and storage path","title":"Android USB Media Transfer Protocol(MPT)"},{"content":"以前球隊在回防時, 教練總會說\u0026quot;快跑! 別回頭, 到定點再休息\u0026quot;.\n關於人生, 喘息點在哪兒? 我想就在滴水穿石之間!\nWeek9 (03/03) 228的4天連假讓這週過的特別快.\n網路文章 What Americans can learn from other food cultures Google breaks SHA-1 web crypto for good but Torvalds plays down impact on Git Announcing the first SHA1 collision Google 公怖與CWI Amsterdam合作生出了第一個SHA-1 collision, 對於使用SHA-1的Git來說會有什麼影響?\n目前看來是影響不大, 主因如下: Git remote 與 local 發生衝突時local並不會被override. 相較於Git, PDF檔是較容易被破解的. Git可能會計劃使用SHA3-256為新的hash algorithm.\n為什麼不選SHA256? \u0026ldquo;SHA256 acceleration is mainly an ARM thing\u0026rdquo; - Torvalds 網路資源 Math is Fun: Common Core Standards: 基本數學. 讀書心得 Learning How to Learn - Week1\n這週以科學研究來看大腦對於學習的反應 可以把學習看的很單純, 就是\u0026quot;不斷\u0026quot;的吸收及練習, \u0026ldquo;不斷\u0026quot;意指長遠的時間1年, 5年, 10年\u0026hellip;等, 而不是指當下不斷的行為. 很多名人傳記都有提及他們的看書習慣, Ex: Steven Jobs and Elon Musk. Think mode: focus, and diffuse. After leaning and sleeping brain form many synapses on the dendrite in your brain that is how your brain upgrade after a sleep or nap. Procrastination - The Pomodoro Technique: an intense 25 minutes followed by 5 minutes relaxation or a little reward. Memory - long term memory and working memory are two major memory systems. Research has shown that if you try to glue things into your memory by repeating something twenty times in one evening, for example, it won’t stick nearly as well as if you practice it the same number of times over several days. Sleep - When you sleep, your brain cells shrink, which allows toxins to be more easily washed away. Week10 (03/10) 網路文章 I Was Wrong About Speed Reading: Here are the Facts\nReading包含几種不同的方法: saccade, scan, and skim. 以前只知道scan and skim, 但saccadé是法文, 意思跟scan似乎是一樣的.\n在reading時有几個過程: fixate, saccade and process.\nSubvocalization是必要的, 用來幫助理解(process).\n從解剖學及神經學來看, 速讀是有極限的. 英文極限約500wpm, 超過這個速度還能讀懂文章, 我想對於文章內容很熟的成份居多.\n文中提到的tips其實就是six-way paragraphs的方法.\nGoogle’s new machine learning API recognizes objects in videos\n讀書心得 Tuesdays with Morrie\nThe Professor章節裡提到Morrie的悲慘的童年, 面對讀母親訃聞給父親陰影及弟弟生病的自責, 繼母看似是讓他脫胎換骨的開始.\n第四週談到死亡, Morrie的觀點是沒人會接受自己死亡的事實, 一旦接受死亡\u0026quot;you might not be as ambitious as you are\u0026rdquo;. 在述說大部份人們面對死亡是用較消極的方式.\n父母拉拔孩子長大的過程, 時而地獄時而天堂, 對孩子來說短暫十幾年卻影響了一輩子, 兩者皆得到了無限希望, 也相互學習.\n\u0026ldquo;Once you lean how to die, you learn how to live.\u0026rdquo; - Morrie, The Fourth Tuesday We Talk About Death, p82.\n從別人的死亡中來看待自己要如何過活, 你不會從自己的死亡中學到, 如果是, 那也許太晚了. \u0026ldquo;This is part of what a family is about, not just love, but letting others know there\u0026rsquo;s someone who is watching out for them.\u0026rdquo; - Morrie, The Fifth Tuesday We Talk About Family, p92. Learning How to Learn - Week2\n提到Chunking, 把學習看成是拼圖, chunks就是由小碎片形成的一塊塊大碎片, 將chunks慢慢拼在一起後看到輪廓, 接著看到想呈現的含意. 但學習終究不是拼圖, 可以完美的把小碎片放在正確位置.\n一昧的reread or draw concept效力不如recall來的好.\n初學者太專注於細節會降低學習的成效.\nRecall is a way to connect mini-chunks and help learn new materials.\nOverlearning cannot help learn deeply and may build a fence which is blocked out creativity.\nOne common mistake that learners make is to refuse to move on in their reading until they fully understand the material in the book in front of them. Chunks are best built up with: focused attention, understanding(of the basic idea), and practice(build a context from chunks). Deliberate practice: Focusing intently on the parts of the problem that are more difficult to you. Week11 (03/17) 網路文章 Be lucky - it\u0026rsquo;s an easy skill to learn\nThe difference between lucky and unlucky person - try everything.\nWhat does O(log n) mean exactly?\nThe most common attributes of logarithmic running-time function are that:\nthe choice of the next element on which to perform some action is one of several possibilities, and only one will need to be chosen.\nor\nthe elements on which the action is performed are digits of n\n網路資源 手機裡頭的 ARM 處理器\n手機裡的 ARM 處理器: 系列講座導論 3/15 聽宅色夫大大聊天, 回顧2007第一次用ARM926的美好回憶, 當時數位相框正夯, Android/iPone出現後即出現戲劇化的情況.\nFunctional C (pdf)\n讀書心得 Learning How to Learn - Week3\nProcrastination 是天性, what are cues of procrastination? find them and face them.\nTackling procrastination: TODO list, delay rewards, backup plans, be confidence and belief your system.\nUsing memory tricks to improve the long term memory. Ex: 餓的話每日熬一鷹. Group memory with familiar things.\nFor long term memory, repeating and practicing in one day is a bad idea. Week12 (03/24) 時間不夠用, 但事情總是急不得\u0026hellip; 每天要睡好睡滿, 避免鬼打牆!\n\u0026ldquo;Each night, when I go to sleep, I die. And the next morning, when I wake up, I am reborn.\u0026rdquo; - Mahatma Gandhi\n網路文章 10 Fundamental Truths That Will Change Your Life\n有時還是要提醒自己, 別太鑽牛角尖, 適時的退一步想清楚. 網路資源 Diagnosing Native Crashes\n說明可能造成crashe原因 讀書心得 Learning How to Learn - Week4(Final)\n多運用比喻法及想像力, 將學習內容比喻(套用)在不同的事物上.\nNo need for genius envy. Everyone has different gifts. When one door closes, another opens. Keep your chin up and your eye on the open door.\nThe Impostor syndrome是常見的現像.\nAbout Right/Left hemisphere, 常聽到的左右腦訓練, 應該是課程提到的diffuse/focus mode的運用, 研究指出做結論或畫big picture時用的是右腦, 左腦則是專心在細節.\n結論: 學習是急不得的, 需要長時間練習及不斷挑戰, 如同肌肉訓練. Thinking, slow and fast.\nTuesdays with Morrie\n關於年紀的恐懼及忌妒心都是有原因的, find it and let it go.\n金錢仍身外之物, 但Money這章節的著墨不多.\nThe satisfaction of lives not come from money, but because of you are needed. And understanding why you are needed is important. People always say, \u0026ldquo;Oh, if I were young again.\u0026rdquo; He smiled. \u0026ldquo;You know what that reflects? Unsatisfied lives. Unfulfilled lives. Lives that haven\u0026rsquo;t found meaning.\u0026rdquo; - Morrie, The Seventh Tuesday We Talk About the Fear of Aging, p118.\n\u0026ldquo;If you\u0026rsquo;re trying to show off for people at the top, forget it. They will look down at you anyhow. And if you\u0026rsquo;re trying to show off for people at the bottom, forget it. The will only envy you. Status will get you nowhere. Only an open heart will allow you to float equally between everyone.\u0026rdquo; - Morrie, The Eighth Tuesday We Talk About Money, p128.\nWeek13 (03/31) 網路文章 The Liberal government will announce legislation next month that will legalize marijuana in Canada by July 1, 2018.\nArcherMind Mediatek X20 Pro Development Board Adds 3G, 4G LTE and More I/Os\n2016/6/27 MTK表示發展96Boards.\nUsing vi-mode in your shell\nset -o vi 後可以在shell使用vi-mode, set -o emacs回到原來.\n網路資源 Workload Automation \u0026amp; LISA\n這2個ARM-software裡的專案值得研究看看, 先從WA開始. leetcode Challenge - C lang 利用瑣碎的時間完成leetcode上基本(easy)的題目.\nNo448_FindDisappearedNumbers\nrealloc一般用來enlarge size, 也可以用在shrinking, 但縮小是必要的嗎?\nNo485_MaxConsecutiveOnes\nNo189_RotateArray\n最直覺的方法是memcpy, 但space complexity = O(n), 題目要的是O(1).\nNo118_PascalTriangle \u0026amp; No119_PascalTriangleII\nRecursion是較方便的解法, 但花的時間超久, No119要注意integer overflow.\nNo414_ThirdMaximumNumber\n注意array裡會有重複的值及負數.\n","permalink":"https://oopsmonk.github.io/posts/2017-03-01-2017month3/","summary":"以前球隊在回防時, 教練總會說\u0026quot;快跑! 別回頭, 到定點再休息\u0026quot;.\n關於人生, 喘息點在哪兒? 我想就在滴水穿石之間!\nWeek9 (03/03) 228的4天連假讓這週過的特別快.\n網路文章 What Americans can learn from other food cultures Google breaks SHA-1 web crypto for good but Torvalds plays down impact on Git Announcing the first SHA1 collision Google 公怖與CWI Amsterdam合作生出了第一個SHA-1 collision, 對於使用SHA-1的Git來說會有什麼影響?\n目前看來是影響不大, 主因如下: Git remote 與 local 發生衝突時local並不會被override. 相較於Git, PDF檔是較容易被破解的. Git可能會計劃使用SHA3-256為新的hash algorithm.\n為什麼不選SHA256? \u0026ldquo;SHA256 acceleration is mainly an ARM thing\u0026rdquo; - Torvalds 網路資源 Math is Fun: Common Core Standards: 基本數學.","title":"Slow and Fast"},{"content":"Vi用慣了, 那在shell也可以vi-style嗎? 答案是可以的!\n這個方法可使用在常用的shell, 例如bash, ksh, zsh, mksh.\nbtw, mksh 是Android使用的shell, 但Ubuntu預設的dash 是不支援的.\n在shell中執行set -o vi 後按\u0026rsquo;i\u0026rsquo;進入insert mode, \u0026lsquo;ESC\u0026rsquo;為normal mode.\n回到原本的模式則是set -o emacs\n如下圖:\nReference: Using vi-mode in your shell\n","permalink":"https://oopsmonk.github.io/posts/2017-03-28-vi-mode-in-shell/","summary":"Vi用慣了, 那在shell也可以vi-style嗎? 答案是可以的!\n這個方法可使用在常用的shell, 例如bash, ksh, zsh, mksh.\nbtw, mksh 是Android使用的shell, 但Ubuntu預設的dash 是不支援的.\n在shell中執行set -o vi 後按\u0026rsquo;i\u0026rsquo;進入insert mode, \u0026lsquo;ESC\u0026rsquo;為normal mode.\n回到原本的模式則是set -o emacs\n如下圖:\nReference: Using vi-mode in your shell","title":"在Shell使用vi-mode"},{"content":"CWI Institute in Amsterdam and Google genrate two PDF documents with the same SHA-1 digest.\nGoogle security blog - Announcing the first SHA1 collision\nSHA-1 collistion and Git If a file A with X hash in local repository and with X hash in remote (SHA-1 collistion between local and remote), would overwrite the local version? Nope. If it has the same SHA1, it means that when we receive the object from the other end, we will not overwrite the object we already have.\nSo you have two cases of collision:\nthe inadvertent kind, \u0026hellip;\nThe attacker kind \u0026hellip;\n\u0026hellip;\nSo in this case, the collision is entirely a non-issue: you\u0026rsquo;ll get a \u0026ldquo;bad\u0026rdquo; repository that is different from what the attacker intended, but since you\u0026rsquo;ll never actually use his colliding object, it\u0026rsquo;s literally no different from the attacker just not having found a collision at all, but just using the object you already had (ie it\u0026rsquo;s 100% equivalent to the \u0026ldquo;trivial\u0026rdquo; collision of the identical file generating the same SHA1).\nSee above. The only dangerous kind of collision is the inadvertent kind, but that\u0026rsquo;s obviously also the very very unlikely kind.\nTorvalds @ Git- Re: Starting to think about sha-256?\nWill Git under attack? I haven\u0026rsquo;t seen the attack yet, but git doesn\u0026rsquo;t actually just hash the data, it does prepend a type/length field to it. That usually tends to make collision attacks much harder, because you either have to make the resulting size the same too, or you have to be able to also edit the size field in the header.\npdf\u0026rsquo;s don\u0026rsquo;t have that issue, they have a fixed header and you can fairly arbitrarily add silent data to the middle that just doesn\u0026rsquo;t get shown.\n\u0026hellip;\nPut another way: I doubt the sky is falling for git as a source control management tool. Do we want to migrate to another hash? Yes. Is it \u0026ldquo;game over\u0026rdquo; for SHA1 like people want to say? Probably not.\nI haven\u0026rsquo;t seen the attack details, but I bet\n(a) the fact that we have a separate size encoding makes it much harder to do on git objects in the first place\n(b) we can probably easily add some extra sanity checks to the opaque data we do have, to make it much harder to do the hiding of random data that these attacks pretty much always depend on.\nTorvalds @ Git- Re: SHA1 collisions found\nWhich one will be the next algorithm? SHA-256, SHA-3-256, and BLAKE2b-256 I\u0026rsquo;ve mentioned this on the list earlier, but here are the contenders in my view:\nSHA-256:\nCommon, but cryptanalysis has advanced. Preimage resistance (which is even more important than collision resistance) has gotten to 52 of 64 rounds. Pseudo-collision attacks are possible against 46 of 64 rounds. Slowest option.\nSHA-3-256:\nLess common, but has a wide security margin. Cryptanalysis is ongoing, but has not advanced much. Somewhat to much faster than SHA-256, unless you have SHA-256 hardware acceleration (which almost nobody does).\nBLAKE2b-256:\nLower security margin, but extremely fast (faster than SHA-1 and even MD5).\nMy recommendation has been for SHA-3-256, because I think it provides the best tradeoff between security and performance.\nbrian m. carlson @ Git- Re: SHA1 collisions found\nSo SHA256 acceleration is mainly an ARM thing, and nobody develops on ARM because there\u0026rsquo;s effectively no hardware that is suitable for developers. Even ARM people just use PCs (and they won\u0026rsquo;t be Goldmont Atoms).\nReduced-round SHA256 may have been broken, but on the other hand it\u0026rsquo;s been around for a lot longer too, so \u0026hellip;\nBut yes, SHA3-256 looks like the sane choice. Performance of hashing is important in the sense that it shouldn\u0026rsquo;t suck, but is largely secondary. All my profiles on real loads (well, my real loads) have shown that zlib performance is actually much more important than SHA1.\nTorvalds @ Git- Re: SHA1 collisions found\nReference: shattered.io\nThe first collision for full SHA-1\nGit - Re: SHA1 collisions found\n","permalink":"https://oopsmonk.github.io/posts/2017-03-03-the-first-sha1-collision/","summary":"CWI Institute in Amsterdam and Google genrate two PDF documents with the same SHA-1 digest.\nGoogle security blog - Announcing the first SHA1 collision\nSHA-1 collistion and Git If a file A with X hash in local repository and with X hash in remote (SHA-1 collistion between local and remote), would overwrite the local version? Nope. If it has the same SHA1, it means that when we receive the object from the other end, we will not overwrite the object we already have.","title":"The First SHA1 Collision"},{"content":"以前球隊在回防時, 教練總會說\u0026quot;快跑! 別回頭, 到定點再休息\u0026quot;.\n關於人生, 喘息點在哪兒? 我想就在滴水穿石之間!\nWeek7 (02/17) 發現minimal-mistakes上缺了繁中, 便開了個PR#838 沒想到很快就被merge, 效率真快.\n試玩BeautifulSoup 寫了個簡單的ck101Comics.py用來下載卡提諾×揪漫畫.\n網路文章 Diving Into Android \u0026lsquo;M\u0026rsquo; Doze \u0026amp; Diving into Doze Mode for Developers\nAndroid Doze在Nougat多了Light-Doze, Light-Doze的Maintenance Windows較短為了避免不同步問題, 當進入Deep-Doze(原本Marshmallow的Doze), Light-Doze會進入OVERRIDE不做任何事. 網路資源 E-book: Python for Informatics 讀書心得 Tuesdays with Morrie\n讀完The Classroom, 直到這章節都是在講Mitch離開大學後的生活及偶然聽到電視上提到Morrie, 師生俩如何再度搭上線. Morrie對Mitch有很深的情感, Mitch稱他為\u0026rsquo;Coach\u0026rsquo;. \u0026ldquo;Dying,\u0026rdquo; Morrie suddenly said, \u0026ldquo;is only one thing to be sad over, Mitch. Living unhappily is something else. So many of the people who come to visit me are unhappy.\u0026rdquo; - The Classroom, p35. 論文學習 POSIX Has Become Outdated\n透過libtrack觀察Andorid, OS X, and Ubuntu, 發現為了UX(user experience)與符合modern workload, 不同的OS實現原本不足且鮮少使用的POSIX abstractions, 其中IPC及Asynchronus I/O的部份更是被取代. 最後結論提到新的POSIX standard 需要著重於graphics, IPC, and threading. Week8 (02/24) 照顧小孩真的很殺時間, 尤其是老婆出國時.\n西班牙海鮮燉飯(Paella Marinera) 試了做一次, 覺得是道擺盤容易, 色彩豐富, 但想做的好吃要再練練的料理. 另外Tortilla de patatas整個失敗\u0026hellip;.\n網路文章 Common Errors in Student Research Papers\nWriting常見錯誤 Dear President Trump: Those jobs aren’t coming back, and why would we want them to?\n一口咬定回流的是Blue-collar? let\u0026rsquo;s see\u0026hellip; Several Earth-Like Planets Discovered Orbiting Nearby Star\nNASA找到7個類似地球的星球. NASA’s Spitzer Reveals Largest Batch of Earth-Size, Habitable-Zone Planets Around a Single Star 網路資源 Papers We Love: 列出很多可以找論文的地方. the morning paper: CS論文導讀. How to Make a Computer Operating System: 教您寫出一個OS. 讀書心得 Pied Piper of Hamelin\n在Six-Way Paragraphs裡出現的文章, 台灣就像Hamelin, 年輕人努力找尋自己的Moravia. The major 就像是政府, 企業, 學校\u0026hellip;等等.\nWisdom before experience is only words; wisdom after experience is of no avail. - Mark Van Doren Tuesdays with Morrie\n\u0026ldquo;I cry all the time now,\u0026rdquo; he said. \u0026ldquo;Never mind\u0026rdquo; - The First Thuesday, p51\n即使勇於面對死亡，大多數的人也是會因為周遭環境的影響或過往感到悲傷. \u0026ldquo;I mourn what I\u0026rsquo;ve lost. I mourn the slow, insidious way in which I\u0026rsquo;m dying. But then I stop mourning.\u0026rdquo; - The Second Tuesday, p57\nSelf-pity 不一定是壞事. \u0026ldquo;Sometimes you cannot believe that you see, you have be believe that you feel.\u0026rdquo; - The Second Tuesday, p61\n相信最深層, 最原始純粹的感覺. 論文學習 POSIX Abstractions in Modern Operating Systems: The Old, the New, and the Missing.\nslides, presentation\n這份論文研究的是Android4.3, 在Graphics部份Android4.4新的Hardware Composer (HWComposer1.3)到現在Android 7 (Nougat)的HWComposer2, 以及支援Vulkan等都是為了加強3D的處理效能.\n另外Android 只實現了69.7%的POSIX functions, 相較於Ubuntu(94.7%)及OS X(100%), 意途似乎很明顯了. ","permalink":"https://oopsmonk.github.io/posts/2017-02-28-2017month2/","summary":"以前球隊在回防時, 教練總會說\u0026quot;快跑! 別回頭, 到定點再休息\u0026quot;.\n關於人生, 喘息點在哪兒? 我想就在滴水穿石之間!\nWeek7 (02/17) 發現minimal-mistakes上缺了繁中, 便開了個PR#838 沒想到很快就被merge, 效率真快.\n試玩BeautifulSoup 寫了個簡單的ck101Comics.py用來下載卡提諾×揪漫畫.\n網路文章 Diving Into Android \u0026lsquo;M\u0026rsquo; Doze \u0026amp; Diving into Doze Mode for Developers\nAndroid Doze在Nougat多了Light-Doze, Light-Doze的Maintenance Windows較短為了避免不同步問題, 當進入Deep-Doze(原本Marshmallow的Doze), Light-Doze會進入OVERRIDE不做任何事. 網路資源 E-book: Python for Informatics 讀書心得 Tuesdays with Morrie\n讀完The Classroom, 直到這章節都是在講Mitch離開大學後的生活及偶然聽到電視上提到Morrie, 師生俩如何再度搭上線. Morrie對Mitch有很深的情感, Mitch稱他為\u0026rsquo;Coach\u0026rsquo;. \u0026ldquo;Dying,\u0026rdquo; Morrie suddenly said, \u0026ldquo;is only one thing to be sad over, Mitch. Living unhappily is something else. So many of the people who come to visit me are unhappy.","title":"新章"},{"content":"A study of adoptable storage in Android Marshmallow and Nougat.\nHow to Setup a Private Disk (External USB Storage) Android adoptable storage allow APP install to external storage that can reserve more internal space for other APPs.\nCreate Adoptable Storage Using Settings GUI Settings -\u0026gt; Storage \u0026amp; USB -\u0026gt; Portable storage -\u0026gt; Settings -\u0026gt; Format as internal\nUse sm (Storage Manager) Command Find disk id # sm list-disks disk:8,16 disk:8,0 Format as internal # sm partition disk:8,0 private # sm list-volumes all public:8,17 mounted 629C-FBAF emulated:8,2 unmounted null private mounted null emulated mounted null private:8,2 mounted 3f538e6e-e6a9-4163-ac1e-e4c6602b3c34 Now, it\u0026rsquo;s a private storage in system.\n# mount /dev/block/mmcblk0p1 /system ext4 ro,seclabel,noatime,data=ordered 0 0 /dev/block/mmcblk0p3 /cache ext4 rw,seclabel,nosuid,nodev,noatime,discard,journal_checksum,errors=continue,data=ordered 0 0 /dev/block/mmcblk0p2 /data ext4 rw,seclabel,nosuid,nodev,noatime,discard,journal_checksum,errors=continue,data=ordered 0 0 /dev/block/dm-0 /mnt/expand/3f538e6e-e6a9-4163-ac1e-e4c6602b3c34 ext4 rw,dirsync,seclabel,nosuid,nodev,noatime 0 0 Moving APP to External(Adoptable) Storage Not all APPs can move to external storage, only the APPs are declared android:installLocation attribute in the Androidmanifest.xml.\nThe value for installLocation are auto, internalOnly, and preferExternal.\n\u0026lt;manifest xmlns:android=\u0026#34;http://schemas.android.com/apk/res/android\u0026#34; android:installLocation=\u0026#34;preferExternal\u0026#34; ... \u0026gt; Install APP to External pm commands can use to select or find APP\u0026rsquo;s install location.\npm path PACKAGE\nGet the location path of the APP. pm get-install-location\nGet the global default install location which is stored in Settings database(default_install_location). pm set-install-location [0|1|2]\nSet default install location 0:auto, 1:internal, 2:external. pm install -f PATH\nInstall on internal storage. pm install -s PATH\nInstall on external storage. pm::makeInstallParams\nHow to Move APPs to External Moving around External and Internal storage:\nSettings Settings -\u0026gt; APPs -\u0026gt; package -\u0026gt; Storage -\u0026gt; Storage Used.\npm (Package Manager) Move APP between internal, and external storage.\npm move-package PACKAGE [internal|UUID]\nEx:\n# pm install /data/app-debug.apk # pm path com.oopsmonk.testinternalinstall package:/data/app/com.oopsmonk.testinternalinstall-1/base.apk # sm list-volumes emulated:8,2 unmounted null private mounted null emulated mounted null private:8,2 mounted 9c019bf2-bb58-4c81-9afe-8ed22d752f91 # pm move-package com.oopsmonk.testinternalinstall 9c019bf2-bb58-4c81-9afe-8ed22d752f91 # pm path com.oopsmonk.testinternalinstall package:/mnt/expand/9c019bf2-bb58-4c81-9afe-8ed22d752f91/app/com.oopsmonk.testinternalinstall-1/base.apk Gaming Rules Adoptable storage will create a new partition table and destroy data on the disk. System APP should not install on external storage. APPs data may lost if external storage was broken. You can create different external storage using separate disks. You should carefully consider whether to install APPs on external storage.\nHow Adoptable Storage Work? Vold(Volume Daemon) is in charge of creating and mounting storage include adoptable storage. It will create two partitions (android_meta and android_expand) for adoptable storage, the android_meta is a reserved space for feature use and android_expand is the external storage which is encrypted via dm-crypt.\nBoth partitions have specific type code.\nandroid_meta: 19A710A2-B3CA-11E4-B026-10604B889DCF android_expand: 193D1EA4-B3CA-11E4-B075-10604B889DCF The encrypt key is located in /data/misc/vold/expand_GUID.key.\nDeclare Adoptable Devices Vold parses mount flags from fstab.{ro.hardware}. As an adoptable device, the flags of voldmanaged and encryptable should be defined. In the meantime, vold.has_adoptable is set to 1.\nfstab.fugu\n/devices/*/dwc3-host.2/usb*\tauto\tauto\tdefaults\tvoldmanaged=usb:auto,encryptable=userdata vold/main\n/* Loop through entries looking for ones that vold manages */ bool has_adoptable = false; for (int i = 0; i \u0026lt; fstab-\u0026gt;num_entries; i++) { if (fs_mgr_is_voldmanaged(\u0026amp;fstab-\u0026gt;recs[i])) { if (fs_mgr_is_nonremovable(\u0026amp;fstab-\u0026gt;recs[i])) { LOG(WARNING) \u0026lt;\u0026lt; \u0026#34;nonremovable no longer supported; ignoring volume\u0026#34;; continue; } std::string sysPattern(fstab-\u0026gt;recs[i].blk_device); std::string nickname(fstab-\u0026gt;recs[i].label); int flags = 0; if (fs_mgr_is_encryptable(\u0026amp;fstab-\u0026gt;recs[i])) { flags |= android::vold::Disk::Flags::kAdoptable; has_adoptable = true; } if (fs_mgr_is_noemulatedsd(\u0026amp;fstab-\u0026gt;recs[i]) || property_get_bool(\u0026#34;vold.debug.default_primary\u0026#34;, false)) { flags |= android::vold::Disk::Flags::kDefaultPrimary; } vm-\u0026gt;addDiskSource(std::shared_ptr\u0026lt;VolumeManager::DiskSource\u0026gt;( new VolumeManager::DiskSource(sysPattern, nickname, flags))); } } property_set(\u0026#34;vold.has_adoptable\u0026#34;, has_adoptable ? \u0026#34;1\u0026#34; : \u0026#34;0\u0026#34;); return 0; fstab is parsed in fs_mgr_fstab.c\nstatic struct flag_list mount_flags[] = { { \u0026#34;noatime\u0026#34;, MS_NOATIME }, { \u0026#34;noexec\u0026#34;, MS_NOEXEC }, { \u0026#34;nosuid\u0026#34;, MS_NOSUID }, { \u0026#34;nodev\u0026#34;, MS_NODEV }, { \u0026#34;nodiratime\u0026#34;, MS_NODIRATIME }, { \u0026#34;ro\u0026#34;, MS_RDONLY }, { \u0026#34;rw\u0026#34;, 0 }, { \u0026#34;remount\u0026#34;, MS_REMOUNT }, { \u0026#34;bind\u0026#34;, MS_BIND }, { \u0026#34;rec\u0026#34;, MS_REC }, { \u0026#34;unbindable\u0026#34;, MS_UNBINDABLE }, { \u0026#34;private\u0026#34;, MS_PRIVATE }, { \u0026#34;slave\u0026#34;, MS_SLAVE }, { \u0026#34;shared\u0026#34;, MS_SHARED }, { \u0026#34;defaults\u0026#34;, 0 }, { 0, 0 }, }; static struct flag_list fs_mgr_flags[] = { { \u0026#34;wait\u0026#34;, MF_WAIT }, { \u0026#34;check\u0026#34;, MF_CHECK }, { \u0026#34;encryptable=\u0026#34;,MF_CRYPT }, { \u0026#34;forceencrypt=\u0026#34;,MF_FORCECRYPT }, { \u0026#34;fileencryption=\u0026#34;,MF_FILEENCRYPTION }, { \u0026#34;forcefdeorfbe=\u0026#34;,MF_FORCEFDEORFBE }, { \u0026#34;nonremovable\u0026#34;,MF_NONREMOVABLE }, { \u0026#34;voldmanaged=\u0026#34;,MF_VOLDMANAGED}, { \u0026#34;length=\u0026#34;, MF_LENGTH }, { \u0026#34;recoveryonly\u0026#34;,MF_RECOVERYONLY }, { \u0026#34;swapprio=\u0026#34;, MF_SWAPPRIO }, { \u0026#34;zramsize=\u0026#34;, MF_ZRAMSIZE }, { \u0026#34;verify\u0026#34;, MF_VERIFY }, { \u0026#34;noemulatedsd\u0026#34;, MF_NOEMULATEDSD }, { \u0026#34;notrim\u0026#34;, MF_NOTRIM }, { \u0026#34;formattable\u0026#34;, MF_FORMATTABLE }, { \u0026#34;slotselect\u0026#34;, MF_SLOTSELECT }, { \u0026#34;nofail\u0026#34;, MF_NOFAIL }, { \u0026#34;latemount\u0026#34;, MF_LATEMOUNT }, { \u0026#34;defaults\u0026#34;, 0 }, { 0, 0 }, }; Creating Private Partition Tracing the code flow via sm partition DISK private command.\nframeworks/base/cmds/sm/src/com/android/commands/sm/Sm.java\npublic void runPartition() throws RemoteException { final String diskId = nextArg(); final String type = nextArg(); if (\u0026#34;public\u0026#34;.equals(type)) { mSm.partitionPublic(diskId); } else if (\u0026#34;private\u0026#34;.equals(type)) { mSm.partitionPrivate(diskId); } else if (\u0026#34;mixed\u0026#34;.equals(type)) { final int ratio = Integer.parseInt(nextArg()); mSm.partitionMixed(diskId, ratio); } else { throw new IllegalArgumentException(\u0026#34;Unsupported partition type \u0026#34; + type); } } then VoldConnector issues partition command to Vold.\nMountService::partitionPrivate\nmConnector.execute(\u0026#34;volume\u0026#34;, \u0026#34;partition\u0026#34;, diskId, \u0026#34;private\u0026#34;); CommandListener::VolumeCmd::runCommand\nreturn sendGenericOkFail(cli, disk-\u0026gt;partitionPrivate()); Vold handles the partition request.\nDisk::partitionMixed\n# Force unmount all volumes destroyAllVolumes(); # Destory the GPT data structures and then exit. # /system/bin/sgdisk # --zap-all # /dev/block/vold/disk:8,0 // Zap sometimes returns an error when it actually succeeded, so // just log as warning and keep rolling forward. if ((res = ForkExecvp(cmd)) != 0) { LOG(WARNING) \u0026lt;\u0026lt; \u0026#34;Failed to zap; status \u0026#34; \u0026lt;\u0026lt; res; } # Create encrypt key and parition GUID for android_expand. if (ReadRandomBytes(16, partGuidRaw) || ReadRandomBytes(16, keyRaw)) { LOG(ERROR) \u0026lt;\u0026lt; \u0026#34;Failed to generate GUID or key\u0026#34;; return -EIO; } # Write key to /data/misc/vold/expand_GUID.key if (!WriteStringToFile(keyRaw, BuildKeyPath(partGuid))) { LOG(ERROR) \u0026lt;\u0026lt; \u0026#34;Failed to persist key\u0026#34;; return -EIO; } else { LOG(DEBUG) \u0026lt;\u0026lt; \u0026#34;Persisted key for GUID \u0026#34; \u0026lt;\u0026lt; partGuid; } # Run partition command via sgdisk tool # /system/bin/sgdisk # --new=0:0:+16M # --typecode=0:19A710A2-B3CA-11E4-B026-10604B889DCF # --change-name=0:android_meta # --new=0:0:-0 # --typecode=0:193D1EA4-B3CA-11E4-B075-10604B889DCF # --partition-guid=0:c245733cd8ed24d20047ba0c3213de60 # --change-name=0:android_expand # /dev/block/vold/disk:8,0 if ((res = ForkExecvp(cmd)) != 0) { LOG(ERROR) \u0026lt;\u0026lt; \u0026#34;Failed to partition; status \u0026#34; \u0026lt;\u0026lt; res; return res; } Mounting Private Partition After disk\u0026rsquo;s partition is changed, kernel rescans the disk and emits an uevent to notify Vold.\nVolumeManager::handleBlockEvent\ncase NetlinkEvent::Action::kAdd: { ... auto disk = new android::vold::Disk(eventPath, device, source-\u0026gt;getNickname(), flags); disk-\u0026gt;create(); mDisks.push_back(std::shared_ptr\u0026lt;android::vold::Disk\u0026gt;(disk)); break; } } break; } Disk::create\nnotifyEvent(ResponseCode::DiskCreated, StringPrintf(\u0026#34;%d\u0026#34;, mFlags)); # Read lable, size, and system path readMetadata(); # parsing partition table readPartitions(); Disk::readPartitions\n# Force unmount all volumes destroyAllVolumes(); # Parsing partition table # /system/bin/sgdisk # --android-dump # /dev/block/vold/disk:8,0 status_t res = ForkExecvp(cmd, output); # Encrypted storage is used GPT partition table only. # Starting to create private volume } else if (table == Table::kGpt) { const char* typeGuid = strtok(nullptr, kSgdiskToken); const char* partGuid = strtok(nullptr, kSgdiskToken); if (!strcasecmp(typeGuid, kGptBasicData)) { createPublicVolume(partDevice); } else if (!strcasecmp(typeGuid, kGptAndroidExpand)) { createPrivateVolume(partDevice, partGuid); } } ... # Notify MountService notifyEvent(ResponseCode::DiskScanned); Creating private volume Disk::createPrivateVolume\n# Verify GUID and encrypt key if (NormalizeHex(partGuid, normalizedGuid)) { LOG(WARNING) \u0026lt;\u0026lt; \u0026#34;Invalid GUID \u0026#34; \u0026lt;\u0026lt; partGuid; return; } std::string keyRaw; if (!ReadFileToString(BuildKeyPath(normalizedGuid), \u0026amp;keyRaw)) { PLOG(ERROR) \u0026lt;\u0026lt; \u0026#34;Failed to load key for GUID \u0026#34; \u0026lt;\u0026lt; normalizedGuid; return; } # Create private volume and format then destroy it. auto vol = std::shared_ptr\u0026lt;VolumeBase\u0026gt;(new PrivateVolume(device, keyRaw)); if (mJustPartitioned) { LOG(DEBUG) \u0026lt;\u0026lt; \u0026#34;Device just partitioned; silently formatting\u0026#34;; vol-\u0026gt;setSilent(true); vol-\u0026gt;create(); vol-\u0026gt;format(\u0026#34;auto\u0026#34;); vol-\u0026gt;destroy(); vol-\u0026gt;setSilent(false); } # volume create again mVolumes.push_back(vol); vol-\u0026gt;setDiskId(getId()); vol-\u0026gt;setPartGuid(partGuid); vol-\u0026gt;create(); VolumeBase::create\n# PrivateVolume::doCreate status_t res = doCreate(); # Notify MountService to mount volume use onVolumeCreatedLocked() notifyEvent(ResponseCode::VolumeCreated, StringPrintf(\u0026#34;%d \\\u0026#34;%s\\\u0026#34; \\\u0026#34;%s\\\u0026#34;\u0026#34;, mType, mDiskId.c_str(), mPartGuid.c_str())); PrivateVolume::doCreate\nif (CreateDeviceNode(mRawDevPath, mRawDevice)) { return -EIO; } // Recover from stale vold by tearing down any old mappings cryptfs_revert_ext_volume(getId().c_str()); // TODO: figure out better SELinux labels for private volumes unsigned char* key = (unsigned char*) mKeyRaw.data(); char crypto_blkdev[MAXPATHLEN]; int res = cryptfs_setup_ext_volume(getId().c_str(), mRawDevPath.c_str(), key, mKeyRaw.size(), crypto_blkdev); mDmDevPath = crypto_blkdev; if (res != 0) { PLOG(ERROR) \u0026lt;\u0026lt; getId() \u0026lt;\u0026lt; \u0026#34; failed to setup cryptfs\u0026#34;; return -EIO; } return OK; When MountService receives VOLUME_CREATED event from VolumeBase::create(), it calls Vold to do mount process.\nMountService::onEventLocked\n# Handle event from VolumeBase::create then get disk info. case VoldResponseCode.VOLUME_CREATED: { final String id = cooked[1]; final int type = Integer.parseInt(cooked[2]); final String diskId = TextUtils.nullIfEmpty(cooked[3]); final String partGuid = TextUtils.nullIfEmpty(cooked[4]); final DiskInfo disk = mDisks.get(diskId); final VolumeInfo vol = new VolumeInfo(id, type, disk, partGuid); mVolumes.put(id, vol); # Ack Vold to mount this volume. onVolumeCreatedLocked(vol); break; } MountService::handleMessage\n# Ack Vold to run mount command via vold/CommandListener. case H_VOLUME_MOUNT: { final VolumeInfo vol = (VolumeInfo) msg.obj; if (isMountDisallowed(vol)) { Slog.i(TAG, \u0026#34;Ignoring mount \u0026#34; + vol.getId() + \u0026#34; due to policy\u0026#34;); break; } try { mConnector.execute(\u0026#34;volume\u0026#34;, \u0026#34;mount\u0026#34;, vol.id, vol.mountFlags, vol.mountUserId); } catch (NativeDaemonConnectorException ignored) { } break; } CommandListener::VolumeCmd::runCommand\n} else if (cmd == \u0026#34;mount\u0026#34; \u0026amp;\u0026amp; argc \u0026gt; 2) { // mount [volId] [flags] [user] std::string id(argv[2]); auto vol = vm-\u0026gt;findVolume(id); if (vol == nullptr) { return cli-\u0026gt;sendMsg(ResponseCode::CommandSyntaxError, \u0026#34;Unknown volume\u0026#34;, false); } int mountFlags = (argc \u0026gt; 3) ? atoi(argv[3]) : 0; userid_t mountUserId = (argc \u0026gt; 4) ? atoi(argv[4]) : -1; vol-\u0026gt;setMountFlags(mountFlags); vol-\u0026gt;setMountUserId(mountUserId); # Call VolumeBase::mount() then PrivateVolume::doMount() int res = vol-\u0026gt;mount(); if (mountFlags \u0026amp; android::vold::VolumeBase::MountFlags::kPrimary) { vm-\u0026gt;setPrimary(vol); } return sendGenericOkFail(cli, res); } else if (cmd == \u0026#34;unmount\u0026#34; \u0026amp;\u0026amp; argc \u0026gt; 2) { Conclusion The prosess of adoptable storage is more simple than Full Disk Encryption\nUnmount all volumes. Create new GPT table, GUID, and encrypt key. Generate android_meta, android_expand, and shared (if ratio partition) partitions. Get block device added uevent from Kernel. Decrypt private volumes. Mount public and private volumes. Related Source code # Communicate with Vold and Framework. frameworks/base/services/core/java/com/android/server/MountService.java # Parse fstab. system/core/fs_mgr # Partition, mount, unmout, and format private volume # Genrate encrypt key. system/vold/ # Decrytp and encrypt private volume, crypto type name is \u0026#34;aes-cbc-essiv:sha256\u0026#34; system/vold/cryptfs.c # Partition tool external/gptfdisk/sgdisk.cc ","permalink":"https://oopsmonk.github.io/posts/2017-02-13-android-adoptable-storage/","summary":"A study of adoptable storage in Android Marshmallow and Nougat.\nHow to Setup a Private Disk (External USB Storage) Android adoptable storage allow APP install to external storage that can reserve more internal space for other APPs.\nCreate Adoptable Storage Using Settings GUI Settings -\u0026gt; Storage \u0026amp; USB -\u0026gt; Portable storage -\u0026gt; Settings -\u0026gt; Format as internal\nUse sm (Storage Manager) Command Find disk id # sm list-disks disk:8,16 disk:8,0 Format as internal # sm partition disk:8,0 private # sm list-volumes all public:8,17 mounted 629C-FBAF emulated:8,2 unmounted null private mounted null emulated mounted null private:8,2 mounted 3f538e6e-e6a9-4163-ac1e-e4c6602b3c34 Now, it\u0026rsquo;s a private storage in system.","title":"Android Adoptable Storage"},{"content":"Android APIs for media playback: MediaPlayer and MediaCodec.\nMediaPlayer mediaPlayer.setDataSource(path); //fd or url mediaPlayer.setDisplay(SurfaceHolder sh); //SurfaceView or VideoView mediaPlayer.prepare(); // MediaPlayer.start(); // MediaCodec /* init use MediaExtractor to get mime data create decoder by mime type configure decoder by video format and surface view */ MediaExtractor mExtractor; MediaCodec mDecoder; mExtractor = new MediaExtractor(); mExtractor.setDataSource(filePath); MediaFormat format = mExtractor.getTrackFormat(track_index); String mime = format.getString(MediaFormat.KEY_MIME); if mime.startsWith(\u0026#34;video/\u0026#34;) mExtractor.selectTrack(track_index); mDecoder = MediaCodec.createDecoderByType(mime); mDecoder.configure(format, surface, null, 0 /* Decoder */); mDecoder.start(); /*run start decode video, fill / empty buffer */ MediaCodecExample\nSimple Video Decode/Encode Flow FFmpeg Demultiplexer\nMux? Demux? Remux? Huh?\nGStreamer The Chromium Reference:\nA Weekend with GStreamer\nThe Chromium Projects\nHandy FFMPEG commands for all video processing needs\nHistory of Android Media Framework OpenCore (Android 1.0) OpenCore and Stagefright (Android 2.1, Eclair) stagefright框架（一）Video Playback的流程\nStagefright and AwesomePlayer (Android 4.0, Ice Cream Sandwich)\nStagefright and NuPlayer (Android 5.1, Lollipop)\nAndroid MediaPlayerService Architecture\nWhat are StagefrightPlayer, AwesomePlayer, NuPlayer, OpenCore, OpenMAX, and Exoplayer? OpenCore is a media framework witch is replaced by Stagefright in Android 2.x. Stagefright relies only on OpenMAX interface for all the codecs.\nStagefrightPlayer is an implement of AwesomePlayer, it call AwesomePlayer\u0026rsquo;s API. StagefrightPlayer Constructor\nNuPlayer and AwesomePlayer both are a player. At first NuPlayer is designed for stream playback, but it replaces AwesomePlayer in Android 5.1 (Lollipop).\nExoPlayer is an open source, application level media player built on top of Android’s low level media APIs, support Android 4.1 above(API level 16).\nExoPlayer Developer Guide\nIntroduction to Android ExoPlayer\nInterface ExoPlayer\nDive into Android 6 Media Framework Current Media Framework Application Framework\nAt the application framework level is the app\u0026rsquo;s code, which utilizes the android.media APIs to interact with the multimedia hardware. Binder IPC\nThe Binder IPC proxies facilitate communication over process boundaries. They are located in the frameworks/av/media/libmedia directory and begin with the letter \u0026ldquo;I\u0026rdquo;. Native Multimedia Framework\nAt the native level, Android provides a multimedia framework that utilizes the Stagefright engine for audio and video recording and playback. Stagefright comes with a default list of supported software codecs and you can implement your own hardware codec by using the OpenMax integration layer standard. For more implementation details, see the various MediaPlayer and Stagefright components located in frameworks/av/media. OpenMAX Integration Layer (IL)\nThe OpenMAX IL provides a standardized way for Stagefright to recognize and use custom hardware-based multimedia codecs called components. You must provide an OpenMAX plugin in the form of a shared library named libstagefrighthw.so. This plugin links your custom codec components to Stagefright. Your custom codecs must be implemented according to the OpenMAX IL component standard. AwesomePlayer is deprecated, but source code still in the path frameworks/av/media/libmediaplayerservice/StagefrightPlayer.cpp\nMedia Playback Architecture MediaPlayerFactory: For different format media files, there are different scoring rule for choosing player. Each factory must has its own score function implement.\nAndroid Multimedia Framework\nInside of Stagefright\nAndroid’s Stagefright Media Player Architecture\nMedia Playback Use MediaPlayer android多媒體框架之流媒體具體流程篇1\u0026mdash;-base on jellybean\nMedia Playback Use MediaExtractor Resources Stagefright vs Gstreamer\nAndroid多媒体开发\nHandy FFMPEG commands for all video processing needs\nMediaExtractor介绍\nImplement a custom codec\nNuPlayer for HTTP live streaming\n","permalink":"https://oopsmonk.github.io/posts/2016-06-16-android-media-framework/","summary":"Android APIs for media playback: MediaPlayer and MediaCodec.\nMediaPlayer mediaPlayer.setDataSource(path); //fd or url mediaPlayer.setDisplay(SurfaceHolder sh); //SurfaceView or VideoView mediaPlayer.prepare(); // MediaPlayer.start(); // MediaCodec /* init use MediaExtractor to get mime data create decoder by mime type configure decoder by video format and surface view */ MediaExtractor mExtractor; MediaCodec mDecoder; mExtractor = new MediaExtractor(); mExtractor.setDataSource(filePath); MediaFormat format = mExtractor.getTrackFormat(track_index); String mime = format.getString(MediaFormat.KEY_MIME); if mime.startsWith(\u0026#34;video/\u0026#34;) mExtractor.selectTrack(track_index); mDecoder = MediaCodec.createDecoderByType(mime); mDecoder.configure(format, surface, null, 0 /* Decoder */); mDecoder.","title":"Android Media Framework"},{"content":"After update system from Ubuntu 14.04 to 16.04, I got some problems, when I was building Android source code.\nopenjdk-7-jdk is gone Add PPA for OpenJDK7\nsudo add-apt-repository ppa:openjdk-r/ppa sudo apt remove openjdk-* icedtea-* icedtea6-* sudo apt update \u0026amp;\u0026amp; sudo apt install openjdk-7-jdk git ccache automake lzop bison gperf build-essential zip curl zlib1g-dev zlib1g-dev:i386 g++-multilib python-networkx libxml2-utils bzip2 libbz2-dev libbz2-1.0 libghc-bzlib-dev squashfs-tools pngcrush schedtool dpkg-dev liblz4-tool make optipng maven If you have other java version in system, make sure your java version is correct.\nsudo update-alternatives --config java sudo update-alternatives --config javac sudo update-alternatives --config javadoc sudo update-alternatives --config javap sudo update-alternatives --config javaws sudo update-alternatives --config jar Reference: [GUIDE] How to Setup Ubuntu 16.04 LTS Xenial Xerus for Compiling Android ROMs\nunsupported reloc 43 prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.11-4.6//x86_64-linux/include/c++/4.6/bits/basic_string.h:270: error: unsupported reloc 43 prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.11-4.6//x86_64-linux/include/c++/4.6/bits/basic_string.h:270: error: unsupported reloc 43 prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.11-4.6//x86_64-linux/include/c++/4.6/bits/basic_string.h:235: error: unsupported reloc 43 prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.11-4.6//x86_64-linux/include/c++/4.6/bits/basic_string.h:235: error: unsupported reloc 43 libnativehelper/JNIHelp.cpp:310: error: unsupported reloc 43 libnativehelper/JNIHelp.cpp:311: error: unsupported reloc 43 libnativehelper/JNIHelp.cpp:332: error: unsupported reloc 43 libnativehelper/JNIHelp.cpp:322: error: unsupported reloc 43 libnativehelper/JNIHelp.cpp:338: error: unsupported reloc 43 ... libnativehelper/JniInvocation.cpp:165: error: unsupported reloc 43 libnativehelper/JniInvocation.cpp:165: error: unsupported reloc 43 libnativehelper/JniInvocation.cpp:165: error: unsupported reloc 43 clang: error: linker command failed with exit code 1 (use -v to see invocation) build/core/host_shared_library_internal.mk:44: recipe for target \u0026#39;out/host/linux-x86/obj32/lib/libnativehelper.so\u0026#39; failed make: *** [out/host/linux-x86/obj32/lib/libnativehelper.so] Error 1 The older prebuilt toolchain have some problems with newer version of \u0026lsquo;as\u0026rsquo; in the native environment.\nThis error will show up when your environment is Ubuntu 16.04 and AOSP before May 7, 2106.\nTo solve this problem:\nModify build/core/clang/HOST_x86_common.mk diff --git a/core/clang/HOST_x86_common.mk b/core/clang/HOST_x86_common.mk index 0241cb6..77547b7 100644 --- a/core/clang/HOST_x86_common.mk +++ b/core/clang/HOST_x86_common.mk @@ -8,6 +8,7 @@ ifeq ($(HOST_OS),linux) CLANG_CONFIG_x86_LINUX_HOST_EXTRA_ASFLAGS := \\ --gcc-toolchain=$($(clang_2nd_arch_prefix)HOST_TOOLCHAIN_FOR_CLANG) \\ --sysroot=$($(clang_2nd_arch_prefix)HOST_TOOLCHAIN_FOR_CLANG)/sysroot \\ + -B$($(clang_2nd_arch_prefix)HOST_TOOLCHAIN_FOR_CLANG)/x86_64-linux/bin \\ -no-integrated-as CLANG_CONFIG_x86_LINUX_HOST_EXTRA_CFLAGS := \\ Use AOSP after May 7, 2016 Reference: https://android-review.googlesource.com/#/c/223100/\n","permalink":"https://oopsmonk.github.io/posts/2016-06-07-android-build-error-on-ubuntu-16-04-lts/","summary":"After update system from Ubuntu 14.04 to 16.04, I got some problems, when I was building Android source code.\nopenjdk-7-jdk is gone Add PPA for OpenJDK7\nsudo add-apt-repository ppa:openjdk-r/ppa sudo apt remove openjdk-* icedtea-* icedtea6-* sudo apt update \u0026amp;\u0026amp; sudo apt install openjdk-7-jdk git ccache automake lzop bison gperf build-essential zip curl zlib1g-dev zlib1g-dev:i386 g++-multilib python-networkx libxml2-utils bzip2 libbz2-dev libbz2-1.0 libghc-bzlib-dev squashfs-tools pngcrush schedtool dpkg-dev liblz4-tool make optipng maven If you have other java version in system, make sure your java version is correct.","title":"Android build error on Ubuntu 16.04 LTS"},{"content":"This study is based on Android Marshmallow.\nAndroid full disk encryption use dm-crypt, which works with block devices. Please refer to the following docs for more detail:\nFull Disk Encryption\nHow to setup full disk encryption Android support forceencrypt and encryptable encryption flags, and only support ext4 and f2fs file systems.\nSetup forceencrypt fstab.bullhead:\n/dev/block/platform/soc.0/f9824900.sdhci/by-name/userdata /data ext4 noatime,nosuid,nodev,barrier=1,data=ordered,nomblk_io_submit,noauto_da_alloc,errors=panic wait,check,forceencrypt=/dev/block/platform/soc.0/f9824900.sdhci/by-name/metadata Setup encryptable fstab.hammerhead:\n/dev/block/platform/msm_sdcc.1/by-name/userdata /data ext4 noatime,nosuid,nodev,barrier=1,data=ordered,nomblk_io_submit,noauto_da_alloc,errors=panic wait,check,encryptable=/dev/block/platform/msm_sdcc.1/by-name/metadata Related Properties and source code location Related source code:\ninit.rc: system/core/init/builtins.cpp fs_mgr: system/core/fs_mgr/fs_mgr.c Vold: system/vold/cryptfs.c Ext4Crypt: system/vold/Ext4Crypt.cpp VoldCryptCmdListener: system/vold/CryptCommandListener.cpp MountService: frameworks/base/services/core/java/com/android/server/MountService.java Properties:\nvold.decrypt: fs_mgr and Vold use this property to notify init.rc. vold.post_fs_data_done: Vold set it to 0 will trigger init.rc(on post-fs-data) to prepare necessary path in /data vold.encrypt_progress: Set by Vold to display the percentage value. vold.encrypt_time_remaining: Set by Vold for UX during encryption progress. ro.crypto.state: Set by init to declare encryption status. ro.crypto.type: Set by init to determine crypto type (file or block). ro.crypto.fs_crypto_blkdev: Set by Vold save the name of the crypto block device so we can mount it when restarting the framework. Encryptable flow As a encryptable device, you can use Settings to lunch a full disk encryption:\nSettings -\u0026gt; Security -\u0026gt; Encryption -\u0026gt; Encrypt (tablet/phone)\nEncryption confirm\nWhen you press Encrypt, CryptKeeperConfirm will call mountService.encryptStorage(), MountService use CryptdConnector send command cryptfs enablecrypto inplace default_password to start encrypt process.\nencrypt flags detection\nVold receive enablecrypto command and get encrypt parameters in fstab.{ro.hardware}\nSet or.crypto.state to unencrypted\nSet vold.decrypt to trigger_shutdown_framework\ninit.rc receive trigger_shutdown_framework to take down framework\nUnmount data\nVold unmount data partition and mount tmpfs to /data Set vold.encrypt_progress to 0\nSet vold.post_fs_data_done to 0 and wait DATA_PREP_TIMEOUT for init.rc set vold.post_fs_data_done to 1\ninit receive vold.post_fs_data_done will create necessary path in /data\nSet vold.encrypt_progress to 1\nVold set vold.decrypt to trigger_restart_min_framework and create crypto device via create_crypto_blk_dev()\nSave Key to /dev/block/platform/msm_sdcc.1/by-name/metadata\ninit receive trigger_restart_min_framework will bring up framework to show progress.\nEncrypt data\nVold call cryptfs_enable_all_volumes to do data encryption.\nCall update_progress() to set vold.encrypt_progress and vold.encrypt_time_remaining value.\nAfter encryption Vold set sys.powerctl to reboot.\nReboot system\u0026hellip;\nDetect encrypted /data\ninit.rc: mount_all ./fstab.{ro.hardware}\nVold fs_mgr_mount_all(): possibly an encryptable blkdev /dev/block/platform/msm_sdcc.1/by-name/userdata for mount /data type ext4 )\nVold fs_mgr_do_tmpfs_mount /data (mount tmpfs to /data).\nSet ro.crypto.state to encrypted\nSet ro.crypto.type to block\nSet vold.decrypt to trigger_default_encryption init.rc receive trigger_default_encryption will call defaultcrypto service to run cryptfs mountdefaultencrypted\nMount data Vold run mountdefaultencrypted\nCall test_mount_encrypted_fs() to verify password.\nSet ro.crypto.state to encrypted\nAttempt to mount the volume with default_password and succeeded\nUnmount tmpfs, and mount the real /data volume.\nSet vold.decrypt to trigger_restart_framework\nForceencrypt flow The difference with encryptable flag is that forceencrypt is auto encrypt at first boot, and no need to reboot during encrypt/decrypt.\n","permalink":"https://oopsmonk.github.io/posts/2016-04-29-android-full-disk-encryption-workflow/","summary":"This study is based on Android Marshmallow.\nAndroid full disk encryption use dm-crypt, which works with block devices. Please refer to the following docs for more detail:\nFull Disk Encryption\nHow to setup full disk encryption Android support forceencrypt and encryptable encryption flags, and only support ext4 and f2fs file systems.\nSetup forceencrypt fstab.bullhead:\n/dev/block/platform/soc.0/f9824900.sdhci/by-name/userdata /data ext4 noatime,nosuid,nodev,barrier=1,data=ordered,nomblk_io_submit,noauto_da_alloc,errors=panic wait,check,forceencrypt=/dev/block/platform/soc.0/f9824900.sdhci/by-name/metadata Setup encryptable fstab.hammerhead:\n/dev/block/platform/msm_sdcc.1/by-name/userdata /data ext4 noatime,nosuid,nodev,barrier=1,data=ordered,nomblk_io_submit,noauto_da_alloc,errors=panic wait,check,encryptable=/dev/block/platform/msm_sdcc.1/by-name/metadata Related Properties and source code location Related source code:","title":"Android Full Disk Encryption Workflow (default encryption)"},{"content":"Install requirements sudo apt-get install build-essential autoconf liblockdev1-dev \\ libudev-dev git libtool pkg-config cmake libxrandr-dev -y Python and Swing support (Optional)\nsudo apt-get install python-dev swig -y Checkout and build libcec source code The current version is libcec-3.0.1, but I got an error as follows:\nmake[2]: *** No rule to make target '1', needed by 'src/libcec/libcec.so.3.0.1'. Stop. Using libcec-3.0.0 instead of libcec-3.0.1, it\u0026rsquo;s work properly.\ngit clone https://github.com/Pulse-Eight/libcec.git cd libcec git checkout libcec-3.0.0 -b cec3.0.0 Checkout platform source\ncd libcec/src/platform git clone https://github.com/Pulse-Eight/platform.git . mkdir build \u0026amp;\u0026amp; cd $_ Build platform\ncmake -DCMAKE_CXX_COMPILER=g++-4.8 .. make \u0026amp;\u0026amp; sudo make install Modify ~/libcec/src/libcec/cmake/CheckPlatformSupport.cmake\ndiff --git a/src/libcec/cmake/CheckPlatformSupport.cmake b/src/libcec/cmake/CheckPlatformSupport.cmake index 828cdb2..b1ec498 100644 --- a/src/libcec/cmake/CheckPlatformSupport.cmake +++ b/src/libcec/cmake/CheckPlatformSupport.cmake @@ -75,9 +75,10 @@ else() endif() # raspberry pi - check_library_exists(bcm_host vchi_initialise \u0026#34;\u0026#34; HAVE_RPI_API) + check_library_exists(bcm_host bcm_host_init \u0026#34;\u0026#34; HAVE_RPI_API) if (HAVE_RPI_API) set(LIB_INFO \u0026#34;${LIB_INFO}, \u0026#39;RPi\u0026#39;\u0026#34;) + include_directories(/opt/vc/include /opt/vc/include/interface/vcos/pthreads /opt/vc/include/interface/vmcs_host/linux) list(APPEND CMAKE_REQUIRED_LIBRARIES \u0026#34;vcos\u0026#34;) list(APPEND CMAKE_REQUIRED_LIBRARIES \u0026#34;vchiq_arm\u0026#34;) set(CEC_SOURCES_ADAPTER_RPI adapter/RPi/RPiCECAdapterDetection.cpp Build libcec\ncd ~/libcec mkdir build \u0026amp;\u0026amp; cd $_ cmake -DBUILD_SHARED_LIBS=1 -DCMAKE_CXX_COMPILER=g++-4.8 .. The configuration on my pi\n-- Configured features: -- Pulse-Eight CEC Adapter: yes -- Pulse-Eight CEC Adapter detection: yes -- lockdev support: yes -- xrandr support: yes -- Raspberry Pi support: no -- TDA995x support: no -- Exynos support: no -- Python support: version 2.7.3 (2.7) -- lib info: compiled on Linux-3.18.11+, features: P8_USB, P8_detect, randr -- Configuring done -- Generating done Make and install library\nmake \u0026amp;\u0026amp; sudo make install Test libcec Testing Samsung UA46B6000VM\nYou can test via cec-client or libcec/src/pyCecClient/pyCecClient.py(if you built with python support). h for help and q for exit cec-client.\nAs a playback device:\noopsmonk@raspberrypi ~ $ sudo cec-client -t p [sudo] password for oopsmonk: == using device type \u0026#39;playback device\u0026#39; CEC Parser created - libCEC version 3.0.0 no serial port given. trying autodetect: path: Raspberry Pi com port: RPI opening a connection to the CEC adapter... DEBUG: [ 102] Broadcast (F): osd name set to \u0026#39;Broadcast\u0026#39; DEBUG: [ 104] InitHostCEC - vchiq_initialise succeeded DEBUG: [ 105] InitHostCEC - vchi_initialise succeeded DEBUG: [ 107] InitHostCEC - vchi_connect succeeded DEBUG: [ 109] logical address changed to Free use (e) DEBUG: [ 111] Open - vc_cec initialised NOTICE: [ 112] connection opened DEBUG: [ 114] \u0026lt;\u0026lt; Broadcast (F) -\u0026gt; TV (0): POLL DEBUG: [ 114] initiator \u0026#39;Broadcast\u0026#39; is not supported by the CEC adapter. using \u0026#39;Free use\u0026#39; instead TRAFFIC: [ 115] \u0026lt;\u0026lt; e0 DEBUG: [ 119] processor thread started DEBUG: [ 176] \u0026gt;\u0026gt; POLL sent DEBUG: [ 176] TV (0): device status changed into \u0026#39;present\u0026#39; DEBUG: [ 176] \u0026lt;\u0026lt; requesting vendor ID of \u0026#39;TV\u0026#39; (0) TRAFFIC: [ 177] \u0026lt;\u0026lt; e0:8c TRAFFIC: [ 369] \u0026gt;\u0026gt; 0f:87:00:00:f0 DEBUG: [ 369] TV (0): vendor = Samsung (0000f0) DEBUG: [ 371] \u0026gt;\u0026gt; TV (0) -\u0026gt; Broadcast (F): device vendor id (87) DEBUG: [ 372] expected response received (87: device vendor id) DEBUG: [ 373] replacing the command handler for device \u0026#39;TV\u0026#39; (0) NOTICE: [ 373] registering new CEC client - v3.0.0 DEBUG: [ 373] detecting logical address for type \u0026#39;playback device\u0026#39; DEBUG: [ 373] trying logical address \u0026#39;Playback 1\u0026#39; DEBUG: [ 373] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; Playback 1 (4): POLL TRAFFIC: [ 374] \u0026lt;\u0026lt; 44 TRAFFIC: [ 464] \u0026lt;\u0026lt; 44 DEBUG: [ 555] \u0026gt;\u0026gt; POLL not sent DEBUG: [ 555] using logical address \u0026#39;Playback 1\u0026#39; DEBUG: [ 555] Playback 1 (4): device status changed into \u0026#39;handled by libCEC\u0026#39; DEBUG: [ 555] Playback 1 (4): power status changed from \u0026#39;unknown\u0026#39; to \u0026#39;on\u0026#39; DEBUG: [ 555] Playback 1 (4): vendor = Pulse Eight (001582) DEBUG: [ 556] Playback 1 (4): CEC version 1.4 DEBUG: [ 556] AllocateLogicalAddresses - device \u0026#39;0\u0026#39;, type \u0026#39;playback device\u0026#39;, LA \u0026#39;4\u0026#39; DEBUG: [ 557] logical address changed to Playback 1 (4) DEBUG: [ 560] Playback 1 (4): osd name set to \u0026#39;CECTester\u0026#39; DEBUG: [ 560] Playback 1 (4): menu language set to \u0026#39;eng\u0026#39; DEBUG: [ 564] GetPhysicalAddress - physical address = 1000 DEBUG: [ 565] AutodetectPhysicalAddress - autodetected physical address \u0026#39;1000\u0026#39; DEBUG: [ 565] Playback 1 (4): physical address changed from ffff to 1000 DEBUG: [ 565] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; broadcast (F): physical adddress 1000 TRAFFIC: [ 565] \u0026lt;\u0026lt; 4f:84:10:00:04 NOTICE: [ 716] CEC client registered: libCEC version = 3.0.0, client version = 3.0.0, firmware version = 1, logical address(es) = Playback 1 (4) , physical address: 1.0.0.0, compiled on Linux-3.18.11+, features: P8_USB, P8_detect, randr, \u0026#39;RPi\u0026#39; DEBUG: [ 717] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; TV (0): OSD name \u0026#39;CECTester\u0026#39; TRAFFIC: [ 717] \u0026lt;\u0026lt; 40:47:43:45:43:54:65:73:74:65:72 DEBUG: [ 1018] \u0026lt;\u0026lt; requesting power status of \u0026#39;TV\u0026#39; (0) TRAFFIC: [ 1018] \u0026lt;\u0026lt; 40:8f waiting for input TRAFFIC: [ 1162] \u0026gt;\u0026gt; 04:90:00 DEBUG: [ 1162] TV (0): power status changed from \u0026#39;unknown\u0026#39; to \u0026#39;on\u0026#39; DEBUG: [ 1163] expected response received (90: report power status) DEBUG: [ 1165] \u0026gt;\u0026gt; TV (0) -\u0026gt; Playback 1 (4): report power status (90) Get CEC version\nver 0 DEBUG: [ 209560] \u0026lt;\u0026lt; requesting CEC version of \u0026#39;TV\u0026#39; (0) TRAFFIC: [ 209561] \u0026lt;\u0026lt; 40:9f TRAFFIC: [ 209718] \u0026gt;\u0026gt; 04:9e:04 DEBUG: [ 209718] TV (0): CEC version 1.3a DEBUG: [ 209720] \u0026gt;\u0026gt; TV (0) -\u0026gt; Playback 1 (4): cec version (9E) CEC version 1.3a DEBUG: [ 209723] expected response received (9E: cec version) Set inactive source\nis DEBUG: [ 281092] marking Playback 1 (4) as inactive source NOTICE: [ 281094] \u0026gt;\u0026gt; source deactivated: Playback 1 (4) NOTICE: [ 281095] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; broadcast (F): inactive source TRAFFIC: [ 281097] \u0026lt;\u0026lt; 40:9d:10:00 TRAFFIC: [ 283632] \u0026gt;\u0026gt; 0f:82:00:00 DEBUG: [ 283632] making TV (0) the active source DEBUG: [ 283635] \u0026gt;\u0026gt; TV (0) -\u0026gt; Broadcast (F): active source (82) TRAFFIC: [ 283850] \u0026gt;\u0026gt; 0f:80:10:00:00:00 DEBUG: [ 283852] \u0026gt;\u0026gt; TV (0) -\u0026gt; Broadcast (F): routing change (80) Set active source\nas DEBUG: [ 288309] making Playback 1 (4) the active source DEBUG: [ 288310] marking TV (0) as inactive source NOTICE: [ 288312] \u0026gt;\u0026gt; source activated: Playback 1 (4) DEBUG: [ 288314] sending active source message for \u0026#39;Playback 1\u0026#39; NOTICE: [ 288315] \u0026lt;\u0026lt; powering on \u0026#39;TV\u0026#39; (0) TRAFFIC: [ 288317] \u0026lt;\u0026lt; 40:04 NOTICE: [ 288379] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; broadcast (F): active source (1000) TRAFFIC: [ 288381] \u0026lt;\u0026lt; 4f:82:10:00 DEBUG: [ 288503] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; TV (0): menu state \u0026#39;activated\u0026#39; TRAFFIC: [ 288505] \u0026lt;\u0026lt; 40:8e:00 TRAFFIC: [ 288675] \u0026gt;\u0026gt; 04:8d:02 DEBUG: [ 288675] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; TV (0): menu state \u0026#39;activated\u0026#39; TRAFFIC: [ 288675] \u0026lt;\u0026lt; 40:8e:00 DEBUG: [ 288677] \u0026gt;\u0026gt; TV (0) -\u0026gt; Playback 1 (4): menu request (8D) TRAFFIC: [ 288853] \u0026gt;\u0026gt; 04:1a:01 DEBUG: [ 288853] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; TV (0): deck status \u0026#39;stop\u0026#39; TRAFFIC: [ 288853] \u0026lt;\u0026lt; 40:1b:1a DEBUG: [ 288855] \u0026gt;\u0026gt; TV (0) -\u0026gt; Playback 1 (4): give deck status (1A) Emit Standby command to TV\nstandby 0 NOTICE: [ 40210] \u0026lt;\u0026lt; putting \u0026#39;TV\u0026#39; (0) in standby mode TRAFFIC: [ 40212] \u0026lt;\u0026lt; 40:36 TRAFFIC: [ 40577] \u0026gt;\u0026gt; 0f:36 DEBUG: [ 40577] TV (0): power status changed from \u0026#39;on\u0026#39; to \u0026#39;standby\u0026#39; DEBUG: [ 40579] \u0026gt;\u0026gt; TV (0) -\u0026gt; Broadcast (F): standby (36) Power on TV\non 0 NOTICE: [ 57151] \u0026lt;\u0026lt; powering on \u0026#39;TV\u0026#39; (0) TRAFFIC: [ 57153] \u0026lt;\u0026lt; 40:04 DEBUG: [ 57215] TV (0): power status changed from \u0026#39;standby\u0026#39; to \u0026#39;in transition from standby to on\u0026#39; DEBUG: [ 63175] GetPhysicalAddress - physical address = 1000 NOTICE: [ 63176] physical address changed to 1000 DEBUG: [ 63176] physical address unchanged (1000) TRAFFIC: [ 70645] \u0026gt;\u0026gt; 0f:80:00:00:10:00 DEBUG: [ 70646] TV (0): power status changed from \u0026#39;in transition from standby to on\u0026#39; to \u0026#39;on\u0026#39; DEBUG: [ 70646] making Playback 1 (4) the active source NOTICE: [ 70646] \u0026gt;\u0026gt; source activated: Playback 1 (4) DEBUG: [ 70646] sending active source message for \u0026#39;Playback 1\u0026#39; NOTICE: [ 70646] \u0026lt;\u0026lt; powering on \u0026#39;TV\u0026#39; (0) TRAFFIC: [ 70647] \u0026lt;\u0026lt; 40:04 DEBUG: [ 70648] \u0026gt;\u0026gt; TV (0) -\u0026gt; Broadcast (F): routing change (80) NOTICE: [ 70737] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; broadcast (F): active source (1000) TRAFFIC: [ 70738] \u0026lt;\u0026lt; 4f:82:10:00 DEBUG: [ 70889] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; TV (0): menu state \u0026#39;activated\u0026#39; TRAFFIC: [ 70889] \u0026lt;\u0026lt; 40:8e:00 TRAFFIC: [ 71160] \u0026gt;\u0026gt; 0f:85 DEBUG: [ 71160] \u0026gt;\u0026gt; 0 requests active source NOTICE: [ 71161] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; broadcast (F): active source (1000) TRAFFIC: [ 71161] \u0026lt;\u0026lt; 4f:82:10:00 DEBUG: [ 71162] \u0026gt;\u0026gt; TV (0) -\u0026gt; Broadcast (F): request active source (85) TRAFFIC: [ 71402] \u0026gt;\u0026gt; 0f:80:00:00:10:00 DEBUG: [ 71403] Playback 1 (4) was already marked as active source NOTICE: [ 71403] \u0026gt;\u0026gt; source activated: Playback 1 (4) DEBUG: [ 71403] sending active source message for \u0026#39;Playback 1\u0026#39; NOTICE: [ 71403] \u0026lt;\u0026lt; powering on \u0026#39;TV\u0026#39; (0) TRAFFIC: [ 71403] \u0026lt;\u0026lt; 40:04 DEBUG: [ 71405] \u0026gt;\u0026gt; TV (0) -\u0026gt; Broadcast (F): routing change (80) NOTICE: [ 71554] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; broadcast (F): active source (1000) TRAFFIC: [ 71555] \u0026lt;\u0026lt; 4f:82:10:00 DEBUG: [ 71765] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; TV (0): menu state \u0026#39;activated\u0026#39; TRAFFIC: [ 71766] \u0026lt;\u0026lt; 40:8e:00 TRAFFIC: [ 71947] \u0026gt;\u0026gt; 0f:32:65:6e:67 DEBUG: [ 71947] TV (0): menu language set to \u0026#39;eng\u0026#39; TRAFFIC: [ 71948] \u0026gt;\u0026gt; 04:8d:02 DEBUG: [ 71948] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; TV (0): menu state \u0026#39;activated\u0026#39; TRAFFIC: [ 71948] \u0026lt;\u0026lt; 40:8e:00 DEBUG: [ 71950] \u0026gt;\u0026gt; TV (0) -\u0026gt; Broadcast (F): set menu language (32) DEBUG: [ 71952] \u0026gt;\u0026gt; TV (0) -\u0026gt; Playback 1 (4): menu request (8D) TRAFFIC: [ 72129] \u0026gt;\u0026gt; 04:1a:01 DEBUG: [ 72129] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; TV (0): deck status \u0026#39;stop\u0026#39; TRAFFIC: [ 72129] \u0026lt;\u0026lt; 40:1b:1a DEBUG: [ 72132] \u0026gt;\u0026gt; TV (0) -\u0026gt; Playback 1 (4): give deck status (1A) TRAFFIC: [ 72371] \u0026gt;\u0026gt; 04:8d:02 DEBUG: [ 72371] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; TV (0): menu state \u0026#39;activated\u0026#39; TRAFFIC: [ 72371] \u0026lt;\u0026lt; 40:8e:00 DEBUG: [ 72373] \u0026gt;\u0026gt; TV (0) -\u0026gt; Playback 1 (4): menu request (8D) TRAFFIC: [ 72642] \u0026gt;\u0026gt; 04:8d:02 DEBUG: [ 72643] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; TV (0): menu state \u0026#39;activated\u0026#39; TRAFFIC: [ 72643] \u0026lt;\u0026lt; 40:8e:00 DEBUG: [ 72645] \u0026gt;\u0026gt; TV (0) -\u0026gt; Playback 1 (4): menu request (8D) TRAFFIC: [ 75054] \u0026gt;\u0026gt; 04:8c DEBUG: [ 75055] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; TV (0): vendor id Pulse Eight (1582) TRAFFIC: [ 75055] \u0026lt;\u0026lt; 4f:87:00:15:82 DEBUG: [ 75057] \u0026gt;\u0026gt; TV (0) -\u0026gt; Playback 1 (4): give device vendor id (8C) TRAFFIC: [ 75275] \u0026gt;\u0026gt; 04:46 DEBUG: [ 75276] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; TV (0): OSD name \u0026#39;CECTester\u0026#39; TRAFFIC: [ 75276] \u0026lt;\u0026lt; 40:47:43:45:43:54:65:73:74:65:72 DEBUG: [ 75278] \u0026gt;\u0026gt; TV (0) -\u0026gt; Playback 1 (4): give osd name (46) TRAFFIC: [ 75744] \u0026gt;\u0026gt; 04:a0:00:00:f0:23 TRAFFIC: [ 75745] \u0026lt;\u0026lt; 40:a0:00:00:f0:24:00:80 DEBUG: [ 75746] \u0026gt;\u0026gt; TV (0) -\u0026gt; Playback 1 (4): vendor command with id (A0) TRAFFIC: [ 76037] \u0026gt;\u0026gt; 04:9f DEBUG: [ 76037] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; TV (0): cec version 1.4 TRAFFIC: [ 76037] \u0026lt;\u0026lt; 40:9e:05 DEBUG: [ 76039] \u0026gt;\u0026gt; TV (0) -\u0026gt; Playback 1 (4): get cec version (9F) TRAFFIC: [ 76214] \u0026gt;\u0026gt; 0f:85 DEBUG: [ 76214] \u0026gt;\u0026gt; 0 requests active source NOTICE: [ 76214] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; broadcast (F): active source (1000) TRAFFIC: [ 76214] \u0026lt;\u0026lt; 4f:82:10:00 DEBUG: [ 76216] \u0026gt;\u0026gt; TV (0) -\u0026gt; Broadcast (F): request active source (85) TRAFFIC: [ 76417] \u0026gt;\u0026gt; 04:8d:02 DEBUG: [ 76417] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; TV (0): menu state \u0026#39;activated\u0026#39; TRAFFIC: [ 76417] \u0026lt;\u0026lt; 40:8e:00 DEBUG: [ 76419] \u0026gt;\u0026gt; TV (0) -\u0026gt; Playback 1 (4): menu request (8D) TRAFFIC: [ 76595] \u0026gt;\u0026gt; 04:8d:02 DEBUG: [ 76595] \u0026lt;\u0026lt; Playback 1 (4) -\u0026gt; TV (0): menu state \u0026#39;activated\u0026#39; TRAFFIC: [ 76595] \u0026lt;\u0026lt; 40:8e:00 DEBUG: [ 76597] \u0026gt;\u0026gt; TV (0) -\u0026gt; Playback 1 (4): menu request (8D) Help\nh ================================================================================ Available commands: [tx] {bytes} transfer bytes over the CEC line. [txn] {bytes} transfer bytes but don\u0026#39;t wait for transmission ACK. [on] {address} power on the device with the given logical address. [standby] {address} put the device with the given address in standby mode. [la] {logical address} change the logical address of the CEC adapter. [p] {device} {port} change the HDMI port number of the CEC adapter. [pa] {physical address} change the physical address of the CEC adapter. [as] make the CEC adapter the active source. [is] mark the CEC adapter as inactive source. [osd] {addr} {string} set OSD message on the specified device. [ver] {addr} get the CEC version of the specified device. [ven] {addr} get the vendor ID of the specified device. [lang] {addr} get the menu language of the specified device. [pow] {addr} get the power status of the specified device. [name] {addr} get the OSD name of the specified device. [poll] {addr} poll the specified device. [lad] lists active devices on the bus [ad] {addr} checks whether the specified device is active. [at] {type} checks whether the specified device type is active. [sp] {addr} makes the specified physical address active. [spl] {addr} makes the specified logical address active. [volup] send a volume up command to the amp if present [voldown] send a volume down command to the amp if present [mute] send a mute/unmute command to the amp if present [self] show the list of addresses controlled by libCEC [scan] scan the CEC bus and display device info [mon] {1|0} enable or disable CEC bus monitoring. [log] {1 - 31} change the log level. see cectypes.h for values. [ping] send a ping command to the CEC adapter. [bl] to let the adapter enter the bootloader, to upgrade the flash rom. [r] reconnect to the CEC adapter. [h] or [help] show this help. [q] or [quit] to quit the CEC test client and switch off all connected CEC devices. ================================================================================ ","permalink":"https://oopsmonk.github.io/posts/2015-11-03-libcec-on-raspberry-pi/","summary":"Install requirements sudo apt-get install build-essential autoconf liblockdev1-dev \\ libudev-dev git libtool pkg-config cmake libxrandr-dev -y Python and Swing support (Optional)\nsudo apt-get install python-dev swig -y Checkout and build libcec source code The current version is libcec-3.0.1, but I got an error as follows:\nmake[2]: *** No rule to make target '1', needed by 'src/libcec/libcec.so.3.0.1'. Stop. Using libcec-3.0.0 instead of libcec-3.0.1, it\u0026rsquo;s work properly.\ngit clone https://github.com/Pulse-Eight/libcec.git cd libcec git checkout libcec-3.","title":"LibCEC on Raspberry Pi"},{"content":"Firefox is extremely slow on my system, include menu, right-click, tab opening\u0026hellip;etc.\nMozilla Firefox 40.0\nXubuntu 14.04 LTS 64-bit\nLinux 3.16.0-45-generic #60~14.04.1-Ubuntu SMP Fri Jul 24 21:16:23 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\nAfter I turned off hardware acceleration, everything is fine.\nType this in the browser\u0026rsquo;s address bar to trun it off:\nabout:preferences#advanced ","permalink":"https://oopsmonk.github.io/posts/2015-08-18-firefox-is-really-slow/","summary":"Firefox is extremely slow on my system, include menu, right-click, tab opening\u0026hellip;etc.\nMozilla Firefox 40.0\nXubuntu 14.04 LTS 64-bit\nLinux 3.16.0-45-generic #60~14.04.1-Ubuntu SMP Fri Jul 24 21:16:23 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\nAfter I turned off hardware acceleration, everything is fine.\nType this in the browser\u0026rsquo;s address bar to trun it off:\nabout:preferences#advanced ","title":"Firefox is Really Slow"},{"content":"Download Sublime Text 3 http://www.sublimetext.com/3\nInstall Package Control https://packagecontrol.io/installation#st3\nUse Ctrl + ` or View \u0026gt; Show Console open the Sublime Text console.\nCopy the text into console and press Enter to install Package Control.\nOnce finished installation, restart Sublime.\nInstall Markdown Preview package Open command palette via Ctrl + Shift + p or Preferences \u0026gt; Package Control from menu.\nAfter typing install and press Enter, it will pop-up a package menu.\nThen keep typing markdown preview, press Enter.\nThe package will be installed.\nTest Markdown Preview Open a Markdown file and make sure you choose right Build System.\nAnd, press Ctrl + b to build a HTML preview file that you can view on the Browser.\n","permalink":"https://oopsmonk.github.io/posts/2015-08-12-markdown-preview-use-sublime-text-3/","summary":"Download Sublime Text 3 http://www.sublimetext.com/3\nInstall Package Control https://packagecontrol.io/installation#st3\nUse Ctrl + ` or View \u0026gt; Show Console open the Sublime Text console.\nCopy the text into console and press Enter to install Package Control.\nOnce finished installation, restart Sublime.\nInstall Markdown Preview package Open command palette via Ctrl + Shift + p or Preferences \u0026gt; Package Control from menu.\nAfter typing install and press Enter, it will pop-up a package menu.","title":"Markdown Preview Use Sublime Text 3"},{"content":"I found some mystery visitors in nginx\u0026rsquo;s access log. I tried to figure out the location of those visitors and what they did.\nIP collection First copy nginx\u0026rsquo;s access log to a folder and save all logs into a single file.\n$ mkdir mysteryIPs \u0026amp;\u0026amp; cd $_ $ sudo cp /var/log/nginx/access.log.* . $ zcat access.log.* \u0026gt; access-gz.log $ cat access.log.1 \u0026gt;\u0026gt; access-gz.log $ cat access.log \u0026gt;\u0026gt; access-gz.log Remove LAN accesses from log file, for example my subnet IP rang is 192.168.x.x\n$ sed '/^192.168/d' ./access-gz.log \u0026gt; removeLAN.log Getting unique IP list.\n$ cat removeLAN.log | awk '{print $1}' | sort -u \u0026gt; uniqueIP Drawing visitors on the world map We have to know where are visitors from and mark them on map.\nI found an example of plotting GeoIP on map, PyGeoIpMap. But it took too long on geolocation when I was trying to use it. So I modified it, I use Geocoder instead of the original one.\nInstall dependencies for our python script\n$ sudo apt-get install python-numpy python-matplotlib python-mpltoolkits.basemap $ sudo pip install geocoder Here is the script Ggeoipmap.py, please right click to save.\n$ chmod +x Ggeoipmap.py $ ./Ggeoipmap.py -i uniqueIP -o ipmap.jpg [maxmind] 101.xxx.xx9 (1/332) country: Thailand [maxmind] 104.xxx.xx0 (2/332) country: Canada [maxmind] 104.xxx.xx(3/332) country: United States [maxmind] 104.xxx.xx (4/332) country: United States [maxmind] 104.xxx.xx (5/332) country: United States [maxmind] 104.xxx.xx1 (6/332) country: United States [maxmind] 108.xxx.xx (7/332) country: United States [maxmind] 110.xxx.xx0 (8/332) country: Thailand [maxmind] 111.xxx.xx (9/332) country: Taiwan [maxmind] 112.xxx.xx9 (10/332) country: Republic of Korea [maxmind] 112.xxx.xx5 (11/332) country: Republic of Korea [maxmind] 113.xxx.xx3 (12/332) country: China ... [mapquest] 94.xxx.xx.195 (331/332) country: TH [mapquest] 94.xx.xx.102 (332/332) country: PL Generating map and saving it to mapquest-ipmap.jpg You can find graphics prefixed with geocoding service providers.\n$ find . -name '*ipmap.jpg' ./yahoo-ipmap.jpg ./mapquest-ipmap.jpg ./tomtom-ipmap.jpg ./maxmind-ipmap.jpg ./osm-ipmap.jpg ./google-ipmap.jpg Yahoo\nMapQuest\nTOMTOM\nMaxMind\nOSM\nGoogle\nOther information from access log We can find more information from those logs, as follows.\nAccess counts per visitor\nDisplay access counts with each visitor.\n$ cat removeLAN.log | awk \u0026#39;{print $1}\u0026#39; | sort | uniq -c | sed \u0026#39;s/^[ \\t]*//\u0026#39; | sort -k1 -n 1 11x.xxx.xxx.187 1 1.x.xxx.xxx.0 1 11x.xxx.xxx.1 1 11x.xxx.xxx.225 1 11x.xxx.xxx 1 12x.xxx.xxx.111 13 1x.xxx.xxx.54 13 1x.xxx.xxx.12 13 2x.xxx.xxx.250 14 9x.xxx.xxx.69 15 1x.xxx.xxx.166 15 1x.xxx.xxx.167 15 1x.xxx.xxx.135 15 6x.xxx.xxx.8 17 2x.xxx.xxx.51 45 2x.xxx.xxx.56 52 2x.xxx.xxx.89 56 1x.xxx.xxx.5 62 1x.xxx.xxx.0 84 8x.xxx.xxx.6 85 1x.xxx.xxx.211 90 1x.xxx.xxx.3 100 1xx.xxx.x49 100 6xx.xxx.x6 101 1xx.xxx.x.1 101 8xx.xxx.x146 159 1xx.xxx.x28 $ Requests\nDisplay request and counts with visitors.\n$ cat removeLAN.log | awk \u0026#39;split($0, a, \u0026#34;\\\u0026#34;\u0026#34;) {$6 = \u0026#34;\\\u0026#34;\u0026#34;a[2]\u0026#34;\\\u0026#34;\u0026#34;} {print $1 \u0026#34; \u0026#34; $6}\u0026#39; | sort | uniq -c | sort -k 1 -n 23 1xx.xxx.xxx.231 \u0026#34;GET / HTTP/1.1\u0026#34; 23 5x.xxx.xxx.182 \u0026#34;GET http://www.baidu.com/ HTTP/1.1\u0026#34; 26 2xx.xxx.xxx.130 \u0026#34;\\x03\\x00\\x00)$\\xE0\\x00\\x00\\x00\\x00\\x00Cookie: mstshash=NCRACK_USER\u0026#34; 27 2xx.xxx.xxx.6 \u0026#34;GET http://www.baidu.com/ HTTP/1.1\u0026#34; 30 5xx.xxx.xxx.169 \u0026#34;GET http://www.baidu.com/ HTTP/1.1\u0026#34; 32 5xx.xxx.xxx.136 \u0026#34;GET http://www.baidu.com/ HTTP/1.1\u0026#34; 34 1xx.xxx.xxx.0 \u0026#34;GET / HTTP/1.1\u0026#34; 34 2xx.xxx.xxx.55 \u0026#34;GET http://www.baidu.com/ HTTP/1.1\u0026#34; 34 2xx.xxx.xxx.90 \u0026#34;GET http://www.baidu.com/ HTTP/1.1\u0026#34; 38 2xx.xxx.xxx.54 \u0026#34;GET http://www.baidu.com/ HTTP/1.1\u0026#34; 42 2xx.xxx.xxx.52 \u0026#34;GET http://www.baidu.com/ HTTP/1.1\u0026#34; 42 2xx.xxx.xxx.53 \u0026#34;GET http://www.baidu.com/ HTTP/1.1\u0026#34; 44 2xx.xxx.xxx.58 \u0026#34;GET http://www.baidu.com/ HTTP/1.1\u0026#34; 45 2xx.xxx.xxx.56 \u0026#34;GET http://www.baidu.com/ HTTP/1.1\u0026#34; 52 2xx.xxx.xxx.89 \u0026#34;GET http://www.baidu.com/ HTTP/1.1\u0026#34; 54 2xx.xxx.xxx.50 \u0026#34;GET http://www.baidu.com/ HTTP/1.1\u0026#34; 54 6x.xxx.xxx.229 \u0026#34;-\u0026#34; Counting Requests\nDisplay what kind of request from visitor.\n$ cat removeLAN.log | awk \u0026#39;split($0, a, \u0026#34;\\\u0026#34;\u0026#34;) {$6 = \u0026#34;\\\u0026#34;\u0026#34;a[2]\u0026#34;\\\u0026#34;\u0026#34;} {print $6}\u0026#39; | sort | uniq -c | sort -n 2 \u0026#34;GET /phpMyAdmin-2.2.3/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.2.6/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.3.0/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.3.1/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.3.2/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.3.3/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.3.4/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.3.5/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.3.6/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.3.7/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.3.8/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.3.9/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.4.0/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.4.1/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.4.2/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.4.3/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.4.4/ HTTP/1.1\u0026#34; 2 \u0026#34;GET /phpMyAdmin-2.4.5/ HTTP/1.1\u0026#34; 15 \u0026#34;GET //cpphpmyadmin/scripts/setup.php HTTP/1.1\u0026#34; 15 \u0026#34;GET //forum/phpmyadmin/scripts/setup.php HTTP/1.1\u0026#34; 15 \u0026#34;GET //_phpmyadmin/scripts/setup.php HTTP/1.1\u0026#34; 15 \u0026#34;GET //websql/scripts/setup.php HTTP/1.1\u0026#34; 16 \u0026#34;GET //php-my-admin/scripts/setup.php HTTP/1.1\u0026#34; 16 \u0026#34;GET //php/phpmyadmin/scripts/setup.php HTTP/1.1\u0026#34; 16 \u0026#34;GET //typo3/phpmyadmin/scripts/setup.php HTTP/1.1\u0026#34; 16 \u0026#34;GET //web/scripts/setup.php HTTP/1.1\u0026#34; 17 \u0026#34;GET //admin/phpmyadmin/scripts/setup.php HTTP/1.1\u0026#34; 17 \u0026#34;GET //admin/pma/scripts/setup.php HTTP/1.1\u0026#34; 17 \u0026#34;GET //admin/scripts/setup.php HTTP/1.1\u0026#34; 17 \u0026#34;GET //db/scripts/setup.php HTTP/1.1\u0026#34; 17 \u0026#34;GET //phpadmin/scripts/setup.php HTTP/1.1\u0026#34; 17 \u0026#34;GET //scripts/setup.php HTTP/1.1\u0026#34; 17 \u0026#34;GET //web/phpMyAdmin/scripts/setup.php HTTP/1.1\u0026#34; 17 \u0026#34;GET //xampp/phpmyadmin/scripts/setup.php HTTP/1.1\u0026#34; 18 \u0026#34;GET //dbadmin/scripts/setup.php HTTP/1.1\u0026#34; 18 \u0026#34;GET //mysql/scripts/setup.php HTTP/1.1\u0026#34; 18 \u0026#34;GET //phpMyAdmin-2/scripts/setup.php HTTP/1.1\u0026#34; 19 \u0026#34;GET /myadmin/scripts/setup.php HTTP/1.1\u0026#34; 19 \u0026#34;GET /pma/scripts/setup.php HTTP/1.1\u0026#34; 20 \u0026#34;GET //mysqladmin/scripts/setup.php HTTP/1.1\u0026#34; 20 \u0026#34;GET /phpMyAdmin/scripts/setup.php HTTP/1.1\u0026#34; 591 \u0026#34;GET http://www.baidu.com/ HTTP/1.1\u0026#34; 692 \u0026#34;GET / HTTP/1.1\u0026#34; Response Codes\nDisplay count of response codes.\n$ cat removeLAN.log | cut -d \u0026#39;\u0026#34;\u0026#39; -f3 | cut -d \u0026#39; \u0026#39; -f2 | sort | uniq -c | sort -rn 4567 200 1970 404 255 400 244 304 22 206 18 302 12 408 11 502 11 401 9 405 7 409 2 499 1 500 $ Weird requests\n\u0026#34;MZ\\x02\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x18\\x00\\x00\\x00\\x00\\x00\\x00\\x00G\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\u0026#34; \u0026#34;MZ\\x02\\x01\\x90\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00~\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x02\\x01\\x00\\xFF\\x01\\x00\\x00\\x01\\x00\\x00\\x00\\x00microsof-c5a626\\x00Windows XP Professional Service Pack 3 Version 5.1.2600\\x00Intel(R) Core(TM) i5-4200U CPU @ 1.60GHz\\x00\u0026#34; \u0026#34;POST /cgi-bin/php5?%2D%64+%61%6C%6C%6F%77%5F%75%72%6C%5F%69%6E%63%6C%75%64%65%3D%6F%6E+%2D%64+%73%61%66%65%5F%6D%6F%64%65%3D%6F%66%66+%2D%64+%73%75%68%6F%73%69%6E%2E%73%69%6D%75%6C%61%74%69%6F%6E%3D%6F%6E+%2D%64+%64%69%73%61%62%6C%65%5F%66%75%6E%63%74%69%6F%6E%73%3D%22%22+%2D%64+%6F%70%65%6E%5F%62%61%73%65%64%69%72%3D%6E%6F%6E%65+%2D%64+%61%75%74%6F%5F%70%72%65%70%65%6E%64%5F%66%69%6C%65%3D%70%68%70%3A%2F%2F%69%6E%70%75%74+%2D%64+%63%67%69%2E%66%6F%72%63%65%5F%72%65%64%69%72%65%63%74%3D%30+%2D%64+%63%67%69%2E%72%65%64%69%72%65%63%74%5F%73%74%61%74%75%73%5F%65%6E%76%3D%30+%2D%6E HTTP/1.1\u0026#34; \u0026#34;POST /cgi-bin/php-cgi?%2D%64+%61%6C%6C%6F%77%5F%75%72%6C%5F%69%6E%63%6C%75%64%65%3D%6F%6E+%2D%64+%73%61%66%65%5F%6D%6F%64%65%3D%6F%66%66+%2D%64+%73%75%68%6F%73%69%6E%2E%73%69%6D%75%6C%61%74%69%6F%6E%3D%6F%6E+%2D%64+%64%69%73%61%62%6C%65%5F%66%75%6E%63%74%69%6F%6E%73%3D%22%22+%2D%64+%6F%70%65%6E%5F%62%61%73%65%64%69%72%3D%6E%6F%6E%65+%2D%64+%61%75%74%6F%5F%70%72%65%70%65%6E%64%5F%66%69%6C%65%3D%70%68%70%3A%2F%2F%69%6E%70%75%74+%2D%64+%63%67%69%2E%66%6F%72%63%65%5F%72%65%64%69%72%65%63%74%3D%30+%2D%64+%63%67%69%2E%72%65%64%69%72%65%63%74%5F%73%74%61%74%75%73%5F%65%6E%76%3D%30+%2D%6E HTTP/1.1\u0026#34; \u0026#34;POST /cgi-bin/php.cgi?%2D%64+%61%6C%6C%6F%77%5F%75%72%6C%5F%69%6E%63%6C%75%64%65%3D%6F%6E+%2D%64+%73%61%66%65%5F%6D%6F%64%65%3D%6F%66%66+%2D%64+%73%75%68%6F%73%69%6E%2E%73%69%6D%75%6C%61%74%69%6F%6E%3D%6F%6E+%2D%64+%64%69%73%61%62%6C%65%5F%66%75%6E%63%74%69%6F%6E%73%3D%22%22+%2D%64+%6F%70%65%6E%5F%62%61%73%65%64%69%72%3D%6E%6F%6E%65+%2D%64+%61%75%74%6F%5F%70%72%65%70%65%6E%64%5F%66%69%6C%65%3D%70%68%70%3A%2F%2F%69%6E%70%75%74+%2D%64+%63%67%69%2E%66%6F%72%63%65%5F%72%65%64%69%72%65%63%74%3D%30+%2D%64+%63%67%69%2E%72%65%64%69%72%65%63%74%5F%73%74%61%74%75%73%5F%65%6E%76%3D%30+%2D%6E HTTP/1.1\u0026#34; \u0026#34;POST /cgi-bin/wlogin.cgi HTTP/1.1\u0026#34; \u0026#34;POST / HTTP/1.1\u0026#34; \u0026#34;POST /login.action HTTP/1.1\u0026#34; \u0026#34;POST /login.do HTTP/1.1\u0026#34; \u0026#34;POST /OvCgi/getnnmdata.exe HTTP/1.1\u0026#34; \u0026#34;POST /user.action HTTP/1.1\u0026#34; \u0026#34;\\x03\\x00\\x00)$\\xE0\\x00\\x00\\x00\\x00\\x00Cookie: mstshash=NCRACK_USER\u0026#34; \u0026#34;\\x04\\x01\\x1F\\x00\\x00\\x00\\x00\\x00\\x00\u0026#34; \u0026#34;\\x05\\x01\\x00\u0026#34; ","permalink":"https://oopsmonk.github.io/posts/2015-08-01-drawing-ip-geolocation-to-the-world-map/","summary":"I found some mystery visitors in nginx\u0026rsquo;s access log. I tried to figure out the location of those visitors and what they did.\nIP collection First copy nginx\u0026rsquo;s access log to a folder and save all logs into a single file.\n$ mkdir mysteryIPs \u0026amp;\u0026amp; cd $_ $ sudo cp /var/log/nginx/access.log.* . $ zcat access.log.* \u0026gt; access-gz.log $ cat access.log.1 \u0026gt;\u0026gt; access-gz.log $ cat access.log \u0026gt;\u0026gt; access-gz.log Remove LAN accesses from log file, for example my subnet IP rang is 192.","title":"Drawing IP Geolocation on World Map"},{"content":"This problem appered when I was checking out older tag from the Chromium project.\nWorking with Release Branches\n~/chromium_build/src$ git fetch --tags ~/chromium_build/src$ git checkout -b tag_35.0.1849.0 35.0.1849.0 ~/chromium_build/src$ gclient sync --with_branch_heads --jobs 16 Error log:\nSyncing projects: 100% ( 1/ 1) src src (ERROR) ---------------------------------------- [0:00:00] Started. ________ running 'git reset --hard HEAD' in '/home/sam.chen/chromium_source/src' [0:00:00] HEAD is now at 77bd011 Publish DEPS for Chromium 35.0.1849.0 [0:00:00] _____ src : Attempting rebase onto 77bd011602b1799f715591e697806c55e7ef8b7f... [0:00:00] Current branch tag_35.0.1849.0 is up to date. [0:00:00] ---------------------------------------- Error: 1\u0026gt; Dependency src specified more than once: 1\u0026gt; src(https://chromium.googlesource.com/chromium/src.git) [https://chromium.googlesource.com/chromium/src.git] 1\u0026gt; vs 1\u0026gt; src(https://chromium.googlesource.com/chromium/src.git) -\u0026gt; src(https://chromium.googlesource.com/chromium/src.git@ae69ae7642 35ccaac55fc44a3b5f3276ff34cb58) [https://chromium.googlesource.com/chromium/src.git@ae69ae764235ccaac55fc44a3b5f3276ff34cb58] You need to edit the .DEPS.git file, remove the entry \u0026lsquo;src\u0026rsquo; and then gcient sync --with_branch_heads.\n~/chromium_build/src$ git diff .DEPS.git diff --git a/.DEPS.git b/.DEPS.git index aa9f7a2a..81e870b 100644 --- a/.DEPS.git +++ b/.DEPS.git @@ -31,8 +31,6 @@ deps = { Var('git_url') + '/chromium/tools/commit-queue.git@7779c66e03aa5b87a2d7354387b3d16338da9e29', 'depot_tools': Var('git_url') + '/chromium/tools/depot_tools.git@9a8b066e52dff833016db0fcea69072814162ffe', - 'src': - Var('git_url') + '/chromium/src.git@ae69ae764235ccaac55fc44a3b5f3276ff34cb58', 'src/breakpad/src': Var('git_url') + '/external/google-breakpad/src.git@d7b5ea03d763b25445c198963034b49596da45f0', 'src/chrome/browser/resources/pdf/html_office': ~/chromium_build/src$ gclient sync --with_branch_heads --jobs 16 --force Reference:\nhttps://groups.google.com/a/chromium.org/forum/#!msg/chromium-dev/1iNTFLNjUQo/LgCPaxkbd-4J\n","permalink":"https://oopsmonk.github.io/posts/2015-07-31-dependency-src-specified-more-than-once/","summary":"This problem appered when I was checking out older tag from the Chromium project.\nWorking with Release Branches\n~/chromium_build/src$ git fetch --tags ~/chromium_build/src$ git checkout -b tag_35.0.1849.0 35.0.1849.0 ~/chromium_build/src$ gclient sync --with_branch_heads --jobs 16 Error log:\nSyncing projects: 100% ( 1/ 1) src src (ERROR) ---------------------------------------- [0:00:00] Started. ________ running 'git reset --hard HEAD' in '/home/sam.chen/chromium_source/src' [0:00:00] HEAD is now at 77bd011 Publish DEPS for Chromium 35.0.1849.0 [0:00:00] _____ src : Attempting rebase onto 77bd011602b1799f715591e697806c55e7ef8b7f.","title":"Dependency src specified more than once"},{"content":"First, check out and install the depot_tools package. $ git clone https://chromium.googlesource.com/chromium/tools/depot_tools.git $ export PATH=$PATH:/path/to/depot_tools Checkout source code $ mkdir ~/chromium_build \u0026amp;\u0026amp; cd $_ ~/chromium_build$ fetch --nohooks android //Configure GYP ~/chromium_build$ echo \u0026quot;{ 'GYP_DEFINES': 'OS=android', }\u0026quot; \u0026gt; chromium.gyp_env //Update projects from gyp files. //You may need to run this again when you have added new files, updated gyp files, or sync'ed your repository. ~/chromium_build$ gclient runhooks Environment setup ~/chromium_build$ sudo apt-get install openjdk-7-jdk //config default JDK ~/chromium_build$ sudo update-alternatives --config javac ~/chromium_build$ sudo update-alternatives --config java ~/chromium_build$ sudo update-alternatives --config javaws ~/chromium_build$ sudo update-alternatives --config javap ~/chromium_build$ sudo update-alternatives --config jar ~/chromium_build$ sudo update-alternatives --config jarsigner //install build dependencies ~/chromium_build$ src/build/install-build-deps-android.sh // Install Google Play Services ~/chromium_build$ src/third_party/android_tools/sdk/tools/android update sdk --no-ui --filter 57 Build ~/chromium_build$ cd ~/chromium_build/src //Full browser ~/chromium_build/src$ ninja -C out/Debug chrome_public_apk //WebView ~/chromium_build/src$ ninja -C out/Debug android_webview_apk //sync source ~/chromium_build/src$ gclient sync Android APK location: ~/chromium_source/src/out/Debug/apks/\nReference:\nAndroid Build Instructions\ndepot_tools_tutorial Manual Page\nGetting Around the Chromium Source Code Directory Structure\nOrganization of code for Android WebView\nDesign Documents HW Video Acceleration\n","permalink":"https://oopsmonk.github.io/posts/2015-07-31-build-android-webview-from-the-chromium-projects/","summary":"First, check out and install the depot_tools package. $ git clone https://chromium.googlesource.com/chromium/tools/depot_tools.git $ export PATH=$PATH:/path/to/depot_tools Checkout source code $ mkdir ~/chromium_build \u0026amp;\u0026amp; cd $_ ~/chromium_build$ fetch --nohooks android //Configure GYP ~/chromium_build$ echo \u0026quot;{ 'GYP_DEFINES': 'OS=android', }\u0026quot; \u0026gt; chromium.gyp_env //Update projects from gyp files. //You may need to run this again when you have added new files, updated gyp files, or sync'ed your repository. ~/chromium_build$ gclient runhooks Environment setup ~/chromium_build$ sudo apt-get install openjdk-7-jdk //config default JDK ~/chromium_build$ sudo update-alternatives --config javac ~/chromium_build$ sudo update-alternatives --config java ~/chromium_build$ sudo update-alternatives --config javaws ~/chromium_build$ sudo update-alternatives --config javap ~/chromium_build$ sudo update-alternatives --config jar ~/chromium_build$ sudo update-alternatives --config jarsigner //install build dependencies ~/chromium_build$ src/build/install-build-deps-android.","title":"Build Android WebView From The Chromium Projects"},{"content":"This is a How-To article that include installation and compile LaTeX file to PDF using Texmaker, Sublime Text 3, and Vim.\nInstall TeX Live Install texlive-latex-extra instead of texlive-latex-base.\n$sudo apt-get install texlive-latex-extra -y Initial user tree in home directory Before using tlmgr in user mode, you have to set up the user tree with the init-usertree action.\ntlmgr is TeX Live package manager, you can run tlmgr --help for more detail.\nThe full documentation for tlmgr\n$ tlmgr init-usertree (running on Debian, switching to user mode!) Install packages Run tlmgr install package-name to install a package, if an error has occurred with following.\n$ tlmgr install bytefield (running on Debian, switching to user mode!) /usr/bin/tlmgr: Initialization failed (in setup_unix_one): /usr/bin/tlmgr: could not find a usable xzdec. /usr/bin/tlmgr: Please install xzdec and try again. Couldn't set up the necessary programs. Installation of packages is not supported. Please report to texlive@tug.org. tlmgr: exiting unsuccessfully (status 1). Install zxedc to solve this problem.\n$sudo apt-get install xzdec If you have no problem with install a package\n$ tlmgr install bytefield (running on Debian, switching to user mode!) tlmgr: package repository http://ftp.yzu.edu.tw/CTAN/systems/texlive/tlnet [1/1, ??:??/??:??] install: bytefield [5k] tlmgr: package log updated: /home/oopsmonk/texmf/web2c/tlmgr.log running mktexlsr ... done running mktexlsr. Manually install packages\nInstall Editor Here are some editors you can choose.\nTexmaker\n$sudo apt-get install texmaker\nSublime Text 3 with LaTeXTools\nInstall latexmk\n$ sudo apt-get install latexmk Install Package Control Install LaTeXTools\nPerferences -\u0026gt; Package Control Build system configuration\nTool -\u0026gt; Build System -\u0026gt; New Build System\nCopy Latex.sublime-build and save. Vim with vimtex\nNeoBundle 'lervag/vimtex'\nOthers\nHello LaTex {% highlight tex %} \\documentclass[12pt]{article} \\begin{document} Hello world! $Hello world!$ %math mode \\end{document} {% endhighlight %}\nSave to hello.tex and compile to PDF\nTexmaker\nSublime Text 3 with LaTeXTools\nVim with vimtex\nlaunch Vim via vim --servername vimlatex\nReferences:\n在Mac系統上撰寫台大碩士論文(XeLaTex樣板)\ntlmgr cannot setup TLPDB\n","permalink":"https://oopsmonk.github.io/posts/2015-07-09-install-latex-on-ubuntu-14-04/","summary":"This is a How-To article that include installation and compile LaTeX file to PDF using Texmaker, Sublime Text 3, and Vim.\nInstall TeX Live Install texlive-latex-extra instead of texlive-latex-base.\n$sudo apt-get install texlive-latex-extra -y Initial user tree in home directory Before using tlmgr in user mode, you have to set up the user tree with the init-usertree action.\ntlmgr is TeX Live package manager, you can run tlmgr --help for more detail.","title":"Install LaTeX on Ubuntu 14.04"},{"content":"Real-Time Monitor for rpi-monitor:\nUpdate system status every 5 seconds. Two HTML layouts: change different layout via click Real-Time on navigation bar. Project on github: rpi-monitor Layout 1(default):\nLayout 2:\n","permalink":"https://oopsmonk.github.io/posts/2015-07-04-new-feature-real-time-monitoring/","summary":"Real-Time Monitor for rpi-monitor:\nUpdate system status every 5 seconds. Two HTML layouts: change different layout via click Real-Time on navigation bar. Project on github: rpi-monitor Layout 1(default):\nLayout 2:","title":"New Feature: Real-Time Monitoring"},{"content":"Core Hollow Body Hold\nPlank Variation\nL Sit\nUpper Chest/Push up Exercises \u0026amp; Variations\nPull-up\nDips\nLower Lower Back\nLeg workout\nOther resources Full Body workout\nCore beginner to advanced\nPush beginner to advanced\nPush beginner to advanced\nComprehensive handstand tutorial\n","permalink":"https://oopsmonk.github.io/posts/2015-04-22-basic-calisthenics-workout/","summary":"Core Hollow Body Hold\nPlank Variation\nL Sit\nUpper Chest/Push up Exercises \u0026amp; Variations\nPull-up\nDips\nLower Lower Back\nLeg workout\nOther resources Full Body workout\nCore beginner to advanced\nPush beginner to advanced\nPush beginner to advanced\nComprehensive handstand tutorial","title":"Basic Calisthenics Workout"},{"content":"I recently switched my blog from Google Blogger to GitHub Pages, here is how I built my blog. I\u0026rsquo;ll go through the following:\nInstall Jekyll on Raspberry Pi Setup Jekyll Theme Post a new article Images minimization Commit to GitHub Using Jekyll and Minimal Mistake build a blog and host on GitHub and Raspberry Pi(or Ubuntu).\nRequirements:\nRaspberry Pi(or Ubuntu) GitHub account Jekyll 2.2+ Minimal Mistake Grunt If you have no idea with these things, here are useful resources:\nHow Jekyll Works\nJekyll Installation\nMinimal Mistake Theme Setup\nGitHub Pages\nGetting started - Grunt\nJekyll Installation Because some packages are out of date in Raspberry Pi\u0026rsquo;s repository, we are going to install packages manually.\nJekyll requirements:\nRuby RubyGems (default in Ruby1.9 above) NodeJS or another JavaScript runtime (it\u0026rsquo;s for CoffeeScript support) Build packages using Raspberry Pi will spend a lot of time. Ruby took me about 80 minutes and NodeJS around 4 hours. So have a walk after make :-).\nInstall Ruby2.2\n$ wget http://cache.ruby-lang.org/pub/ruby/2.2/ruby-2.2.0.tar.gz $ tar xf ruby-2.2.0.tar.gz $ cd ruby-2.2.0 $ ./configure $ make $ sudo make install Install NodeJS\n$ wget http://nodejs.org/dist/v0.10.36/node-v0.10.36.tar.gz $ tar xf node-v0.10.36.tar.gz $ cd node-v0.10.36 $ ./configure $ make $ sudo make install Jekyll Theme Setup Install Jekyll Theme is pretty easy, download and do some modify in _config.yml.\nI use the Minimal Mistake for example, you can find the others on Jekyll Themes.\nSteps:\nDownload Minimal Mistakes Unzip Install all dependencies via bundle install $ wget https://github.com/mmistakes/minimal-mistakes/archive/master.zip $ unsip master.zip $ cd minimal-mistakes-master $ sudo gem install bundler $ bundle install $ jekyll s Now you can connect to http://127.0.0.1:4000 see the prototype.\nIf you don\u0026rsquo;t know how to modify _config.yml, Please refer to Site Setup or my _config.yml.\nI got a problem when I was running jekyll s, to solve this problem remove the Gemfile.lock file and it\u0026rsquo;s work properly.\n$ jekyll s WARN: Unresolved specs during Gem::Specification.reset: pygments.rb (~\u0026gt; 0.6.0) redcarpet (~\u0026gt; 3.1) jekyll-watch (~\u0026gt; 1.1) classifier-reborn (~\u0026gt; 2.0) WARN: Clearing out unresolved specs. Please report a bug if this causes problems. /usr/local/lib/ruby/gems/2.2.0/gems/jekyll-2.5.3/bin/jekyll:21:in `block in \u0026lt;top (required)\u0026gt;\u0026#39;: cannot load such file -- jekyll /version (LoadError) from /usr/local/lib/ruby/gems/2.2.0/gems/mercenary-0.3.5/lib/mercenary.rb:18:in `program\u0026#39; from /usr/local/lib/ruby/gems/2.2.0/gems/jekyll-2.5.3/bin/jekyll:20:in `\u0026lt;top (required)\u0026gt;\u0026#39; from /usr/local/bin/jekyll:23:in `load\u0026#39; from /usr/local/bin/jekyll:23:in `\u0026lt;main\u0026gt;\u0026#39; $ rm Gemfile.lock Post a new article The simplest way to post an article is create a file with date prefix in _post folder and fill in header, but as a lazy person like me Minimal Mistake provide octopress command to create a new post. Personally, I use vim-jekyll instead.\nUse octopress\nUse vim-jekyll\nAfter vim-jekyll is installed, add configuration in .vimrc is shown below:\n{% highlight vim %} let g:jekyll_post_dirs = [\u0026rsquo;_posts\u0026rsquo;] let g:jekyll_post_extension = \u0026lsquo;.md\u0026rsquo; let g:jekyll_post_template = [ \\ \u0026lsquo;\u0026mdash;\u0026rsquo;, \\ \u0026rsquo;layout: post\u0026rsquo;, \\ \u0026rsquo;title: \u0026ldquo;JEKYLL_TITLE\u0026rdquo;\u0026rsquo;, \\ \u0026lsquo;modified: \u0026lsquo;, \\ \u0026lsquo;categories: \u0026lsquo;, \\ \u0026lsquo;comments: true\u0026rsquo;, \\ \u0026rsquo;excerpt:\u0026rsquo;, \\ \u0026rsquo;tags: []\u0026rsquo;, \\ \u0026lsquo;image:\u0026rsquo;, \\ \u0026rsquo; feature:\u0026rsquo;, \\ \u0026lsquo;date: \u0026ldquo;JEKYLL_DATE\u0026rdquo;\u0026rsquo;, \\ \u0026lsquo;\u0026mdash;\u0026rsquo;, \\ \u0026lsquo;\u0026rsquo;] {% endhighlight %}\nImages minimization Gruent is a JavaScript Task Runner performs repetitive tasks. Minimal Mistakes have a Gruntfile already, we can use it for minimizing images and JavaScript, but we have to install Gruent first and install dependencies via npm install. By default it minimizes all scripts into scripts.min.js and optimize .jpg, .png, and .svg files in the images/ folder.\nAlternatively, you can use grunt imagemin to minimize images only.\n$ cd minimal-mistakes-master $ sudo npm install -g grunt-cli $ sudo npm install $ grunt Commit to GitHub You can host your blog by your own or use GitHub Pages, how to work with GitHub Pages:\nCreate a repository called account.github.io (mine is oopsmonk.github.io) Clone repository to your blog folder Commit to GitHub Yes, it\u0026rsquo;s extremely convenient and easy, thanks GitHub.\nHere is what I did:\n$ cd minimal-mistakes-master $ git clone https://github.com/oopsmonk/oopsmonk.github.io.git . $ git add . $ git commit $ git push Then you can see your blog at https://account.github.io\nConclusion Create a Jekyll blog doesn\u0026rsquo;t like Google Blogger, even use themes to build a blog, it\u0026rsquo;s not ready to go after unboxing.You have to do some modifications, understanding HTML, CSS, and Jekyll is necessary. Here are Pros/Corns for using GitHub Pages with Jekyll.\nPros Flexible customization Keep contents in local or on Internet Offline writing and preview Write in terminal Corn Learning curve ","permalink":"https://oopsmonk.github.io/posts/2015-03-05-build-a-blog-with-jekyll-on-raspberry-pi/","summary":"I recently switched my blog from Google Blogger to GitHub Pages, here is how I built my blog. I\u0026rsquo;ll go through the following:\nInstall Jekyll on Raspberry Pi Setup Jekyll Theme Post a new article Images minimization Commit to GitHub Using Jekyll and Minimal Mistake build a blog and host on GitHub and Raspberry Pi(or Ubuntu).\nRequirements:\nRaspberry Pi(or Ubuntu) GitHub account Jekyll 2.2+ Minimal Mistake Grunt If you have no idea with these things, here are useful resources:","title":"Build A Blog with Jekyll and GitHub on Raspberry Pi"},{"content":"原味戚風蛋糕(Chiffon Cake) 芋頭麵包(Taro Bread) 小餅乾(Biscuit) 萬聖節餅乾(Halloween Cookies) 海蒂白麵包(アルプスの少女ハイジ・ハイジの白パン) 黑糖饅頭(Brown Sugar Steamed Bread) 蛋糕土司(Cake Toast) 香蕉土司(Banana Toast) ","permalink":"https://oopsmonk.github.io/posts/2014-12-31-baking2014/","summary":"原味戚風蛋糕(Chiffon Cake) 芋頭麵包(Taro Bread) 小餅乾(Biscuit) 萬聖節餅乾(Halloween Cookies) 海蒂白麵包(アルプスの少女ハイジ・ハイジの白パン) 黑糖饅頭(Brown Sugar Steamed Bread) 蛋糕土司(Cake Toast) 香蕉土司(Banana Toast) ","title":"Baking 2014"},{"content":"Generating SSH keys for GitHub Here are github account and work account.\nGitHub:\nSSH Key: github_id_rsa\nAccount: oopsmonk\nWork:\nSSH Key: work_id_rsa\nAccount: SamChen\nAdd SSH config File Modify ~/.ssh/config\n# Default github Host github.com HostName github.com PreferredAuthentications publickey IdentityFile ~/.ssh/github_id_rsa # Work git server Host work.gitserver.com HostName work.gitserver.com PreferredAuthentications publickey IdentityFile ~/.ssh/work_id_rsa Git Repository Configuation GitHub Project: $ git clone https://github.com/abc/projectA.git $ cd projectA #github account $ git config user.name \u0026#34;oopsmonk\u0026#34; $ git config user.email \u0026#34;oopsmonk@example.com.tw\u0026#34; Working Project: $ git clone https://work.com.tw/repo/projectW.git $ cd projectW #working account $ git config user.name \u0026#34;SamChen\u0026#34; $ git config user.email \u0026#34;SamChen@example.com.tw\u0026#34; Now you can deal with git repositories using different accounts.\n(Additional) Using ssh-agent to access GitHub without password Check key list\n# No ssh-agent running $ ssh-add -l Could not open a connection to your authentication agent. $ Enable ssh-agent (Ubuntu12.04):\n#enable ssh-agent $ eval `ssh-agent -s` #add keys to agent $ cd ~/.ssh $ ssh-add work_id_rsa github_id_rsa Identity added: work_id_rsa (work_id_rsa) Identity added: github_id_rsa (github_id_rsa) #list added keys $ ssh-add -L #delete keys in agent $ ssh-add -D Now you can commit modifications to git repository without password.\nReferences:\nUnderstanding ssh-agent and ssh-add\nHow can I run ssh-add automatically, without password prompt?\n","permalink":"https://oopsmonk.github.io/posts/2014-12-12-multiplesshkeyswithgithub/","summary":"Generating SSH keys for GitHub Here are github account and work account.\nGitHub:\nSSH Key: github_id_rsa\nAccount: oopsmonk\nWork:\nSSH Key: work_id_rsa\nAccount: SamChen\nAdd SSH config File Modify ~/.ssh/config\n# Default github Host github.com HostName github.com PreferredAuthentications publickey IdentityFile ~/.ssh/github_id_rsa # Work git server Host work.gitserver.com HostName work.gitserver.com PreferredAuthentications publickey IdentityFile ~/.ssh/work_id_rsa Git Repository Configuation GitHub Project: $ git clone https://github.com/abc/projectA.git $ cd projectA #github account $ git config user.","title":"Using Git With Multiple SSH Keys and Accounts"},{"content":"installation Requirements $ sudo apt-get install -y make build-essential libssl-dev zlib1g-dev libbz2-dev \\ libreadline-dev libsqlite3-dev wget curl llvm install pyenv $ cd ~ $ git clone git://github.com/yyuu/pyenv.git .pyenv $ echo \u0026#39;export PYENV_ROOT=\u0026#34;$HOME/.pyenv\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.bashrc $ echo \u0026#39;export PATH=\u0026#34;$PYENV_ROOT/bin:$PATH\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.bashrc $ echo \u0026#39;eval \u0026#34;$(pyenv init -)\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.bashrc install pyenv-virtualenv $ git clone https://github.com/yyuu/pyenv-virtualenv.git ~/.pyenv/plugins/pyenv-virtualenv $ echo \u0026#39;eval \u0026#34;$(pyenv virtualenv-init -)\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.bashrc $ exec $SHELL Common Usage (Command Reference) List all available versions $ pyenv version -l Install python2.7.8 to pyenv $ pyenv install 2.7.8 List installed versions $ pyenv versions * system (set by /home/oopsmonk/.pyenv/version) 2.7.8 3.4.2 Creating a virtualenv $ pyenv virtualenv 2.7.8 mypy-2.7.8 List virtualenvs $ pyenv virtualenvs mypy-2.7.8 (created from /home/oopsmonk/.pyenv/versions/2.7.8) mypy-3.4.2 (created from /home/oopsmonk/.pyenv/versions/3.4.2) # current versions $ pyenv versions * system (set by /home/oopsmonk/.pyenv/version) 2.7.8 3.4.2 mypy-2.7.8 mypy-3.4.2 Use python via virtualenv # show current version oopsmonk@VBox:~/markdown-note$ python --version Python 2.7.6 # Change to other version oopsmonk@VBox:~/markdown-note$ pyenv activate mypy-2.7.8 (mypy-2.7.8)oopsmonk@VBox:~/markdown-note$ python --version Python 2.7.8 # Deactivate (mypy-2.7.8)oopsmonk@oopsmonk-VBox:~/markdown-note$ pyenv deactivate oopsmonk@oopsmonk-VBox:~/markdown-note$ python --version Python 2.7.8 # Why current version is 2.7.8? it\u0026#39;s supposed to 2.7.6. oopsmonk@oopsmonk-VBox:~/markdown-note$ pyenv activate mypy-3.4.2 (mypy-3.4.2) oopsmonk@oopsmonk-VBox:~/markdown-note$ pyenv deactivate oopsmonk@oopsmonk-VBox:~/markdown-note$ python --version Python 3.4.2 oopsmonk@oopsmonk-VBox:~/markdown-note$ pyenv versions system 2.7.8 3.4.2 mypy-2.7.8 * mypy-3.4.2 (set by PYENV_VERSION environment variable) # delete a virtualenv $ pyenv uninstall mypy-2.7.8 # Go back to original system version $ alias pyenv_deactivate=\u0026#39;pyenv deactivate \u0026amp;\u0026amp; unset PYENV_VERSION\u0026#39; oopsmonk@oopsmonk-VBox:~/markdown-note$ pyenv activate mypy-3.4.2 (mypy-3.4.2) oopsmonk@oopsmonk-VBox:~/markdown-note$ pyenv_deactivate oopsmonk@oopsmonk-VBox:~/markdown-note$ python --version Python 2.7.6 Use python via pyenv # Global python version $ pyenv global # python version in current folder oopsmonk@oopsmonk-VBox:~/markdown-note$ pyenv local mypy-3.4.2 oopsmonk@oopsmonk-VBox:~/markdown-note$ pyenv version mypy-3.4.2 (set by /home/oopsmonk/markdown-note/.python-version) oopsmonk@oopsmonk-VBox:~/markdown-note$ cd .. oopsmonk@oopsmonk-VBox:~$ pyenv version system (set by /home/oopsmonk/.pyenv/version) oopsmonk@oopsmonk-VBox:~$ cd - /home/oopsmonk/markdown-note oopsmonk@oopsmonk-VBox:~/markdown-note$ pyenv version mypy-3.4.2 (set by /home/oopsmonk/markdown-note/.python-version) oopsmonk@oopsmonk-VBox:~/markdown-note$ pyenv local --unset oopsmonk@oopsmonk-VBox:~/markdown-note$ pyenv version system (set by /home/oopsmonk/.pyenv/version) # python version in current shell oopsmonk@oopsmonk-VBox:~/markdown-note$ pyenv shell mypy-3.4.2 oopsmonk@oopsmonk-VBox:~/markdown-note$ pyenv version mypy-3.4.2 (set by PYENV_VERSION environment variable) oopsmonk@oopsmonk-VBox:~/markdown-note$ cd - /home/oopsmonk oopsmonk@oopsmonk-VBox:~$ pyenv version mypy-3.4.2 (set by PYENV_VERSION environment variable) oopsmonk@oopsmonk-VBox:~$ pyenv shell --unset oopsmonk@oopsmonk-VBox:~$ pyenv version system (set by /home/oopsmonk/.pyenv/version) oopsmonk@oopsmonk-VBox:~$ cd - /home/oopsmonk/markdown-note oopsmonk@oopsmonk-VBox:~/markdown-note$ pyenv version system (set by /home/oopsmonk/.pyenv/version) ","permalink":"https://oopsmonk.github.io/posts/2014-12-10-pyenv/","summary":"installation Requirements $ sudo apt-get install -y make build-essential libssl-dev zlib1g-dev libbz2-dev \\ libreadline-dev libsqlite3-dev wget curl llvm install pyenv $ cd ~ $ git clone git://github.com/yyuu/pyenv.git .pyenv $ echo \u0026#39;export PYENV_ROOT=\u0026#34;$HOME/.pyenv\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.bashrc $ echo \u0026#39;export PATH=\u0026#34;$PYENV_ROOT/bin:$PATH\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.bashrc $ echo \u0026#39;eval \u0026#34;$(pyenv init -)\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.bashrc install pyenv-virtualenv $ git clone https://github.com/yyuu/pyenv-virtualenv.git ~/.pyenv/plugins/pyenv-virtualenv $ echo \u0026#39;eval \u0026#34;$(pyenv virtualenv-init -)\u0026#34;\u0026#39; \u0026gt;\u0026gt; ~/.bashrc $ exec $SHELL Common Usage (Command Reference) List all available versions $ pyenv version -l Install python2.","title":"pyenv Quick Start (Utunbu 14.04)"},{"content":"Advanced Bash-Scripting Guide\nsed\nawk\nInternal Variables #current parent pid $$ #last background process pid $! #last exit status $? #current instance pid, Bash 4.x above. $BASHPID Arithmetic Expansion a=12 b=$(($a + 10)) b=`expr $a + 1` b=$(expr $a + 1) let b=$a+3 #let b=$a + 3 #incorrect let \u0026#34;b = $a + 3\u0026#34; declare -i b=$a+$a Manipulating Strings String is a number if [[ $var =~ ^-?[0-9]+$ ]]; then echo \u0026#34;$var is a number\u0026#34; fi if [[ ! $var =~ ^-?[0-9]+$ ]]; then echo \u0026#34;$var is not a number\u0026#34; fi Find String between two words or characters var=\u0026#34;Hello there are (123340) and (123)\u0026#34; #last string between \u0026#39;(\u0026#39; and \u0026#39;)\u0026#39;. substr=$( echo $var | sed \u0026#39;s/.*(\\(.*\\)).*/\\1/\u0026#39; ) #String between \u0026#39;(\u0026#39; and \u0026#39;)\u0026#39;. substr=$( echo $var | awk -v FS=\u0026#34;(\\(|\\))\u0026#34; \u0026#39;{print $2 \u0026#34; \u0026#34; $4}\u0026#39; ) #String between \u0026#39;there\u0026#39; and \u0026#39;and\u0026#39;. substr=$( echo $var | awk -v FS=\u0026#34;(there|and)\u0026#34; \u0026#39;{print $2}\u0026#39; ) #String between \u0026#39;there\u0026#39; and \u0026#39;and\u0026#39;. substr=$( echo $var | sed \u0026#39;s/.*there\\(.*\\)and.*/\\1/\u0026#39; ) #String between \u0026#39;there\u0026#39; and \u0026#39;and\u0026#39;. substr=$( echo $var | grep -o -P \u0026#39;(?\u0026lt;=there).*(?=and)\u0026#39; ) Loop read variables #read from file echo \u0026#34;123, abc, hello world!\u0026#34; \u0026gt; /tmp/test echo \u0026#34;12 43, ddd, !\u0026#34; \u0026gt;\u0026gt; /tmp/test while IFS=\u0026#39;,\u0026#39; read var1 var2 var3 do echo \u0026#34;var1=$var1 var2=$var2 var3=$var3\u0026#34; done \u0026lt; \u0026#34;/tmp/test\u0026#34; #read from variable x=\u0026#34;one, two, three\u0026#34; while IFS=\u0026#39;,\u0026#39; read var1 var2 var3 do echo \u0026#34;var1=$var1 var2=$var2 var3=$var3\u0026#34; done \u0026lt;\u0026lt;\u0026lt; $x iterate IP address #iterate class C ip address for i in 192.168.100.{1..10} do echo \u0026#34;$i\u0026#34; done #iterate class B ip address for x in 192.168.{1..5} do for i in $x.{1..10} do echo \u0026#34;$i\u0026#34; done done infinite while loop while : do echo \u0026#34;infinite loops [ CTRL+C to stop]\u0026#34; sleep 5 done Array # Simple array arrayA=( Mon Tue Wed Thu Fri Sat Sun ) echo \u0026#34;${!arrayA[*]}\u0026#34; # 0 1 2 3 4 5 6 echo \u0026#34;${#arrayA[*]}\u0026#34; # 7 echo \u0026#34;${arrayA[*]}\u0026#34; # Mon Tue Wed Thu Fri Sat Sun echo \u0026#34;${!arrayA[@]}\u0026#34; # 0 1 2 3 4 5 6 echo \u0026#34;${#arrayA[@]}\u0026#34; # 7 echo \u0026#34;${arrayA[@]}\u0026#34; # Mon Tue Wed Thu Fri Sat Sun echo \u0026#34;${arrayA[2]}\u0026#34; # Wed echo \u0026#34;$arrayA\u0026#34; # Mon echo \u0026#34;${arrayA[20]}\u0026#34; # null arrayA=( one two ) echo \u0026#34;${arrayA[*]}\u0026#34; # one two arrayA+=( three \u0026#34;four\u0026#34; ) echo \u0026#34;${arrayA[*]}\u0026#34; # one two three four # Key/Value declare -A arrayB=( [\u0026#34;Mon\u0026#34;]=\u0026#34;Monday\u0026#34; [\u0026#34;Tue\u0026#34;]=\u0026#34;Tuesday\u0026#34; [\u0026#34;Wed\u0026#34;]=\u0026#34;Wednesday\u0026#34; [\u0026#34;Thu\u0026#34;]=\u0026#34;Thursday\u0026#34; [\u0026#34;Fri\u0026#34;]=\u0026#34;Friday\u0026#34; [\u0026#34;Sat\u0026#34;]=\u0026#34;Saturday\u0026#34; [\u0026#34;Sun\u0026#34;]=\u0026#34;Sunday\u0026#34; ) echo \u0026#34;${!arrayB[*]}\u0026#34; # Thu Tue Wed Mon Fri Sat Sun echo \u0026#34;${#arrayB[*]}\u0026#34; # 7 echo \u0026#34;${arrayB[*]}\u0026#34; # Thursday Tuesday Wednesday Monday Friday Saturday Sunday echo \u0026#34;${!arrayB[@]}\u0026#34; # Thu Tue Wed Mon Fri Sat Sun echo \u0026#34;${#arrayB[@]}\u0026#34; # 7 echo \u0026#34;${arrayB[@]}\u0026#34; # Thursday Tuesday Wednesday Monday Friday Saturday Sunday echo \u0026#34;${arrayB[2]}\u0026#34; # null echo \u0026#34;$arrayB\u0026#34; # null echo \u0026#34;${arrayB[\u0026#34;Tue\u0026#34;]}\u0026#34; # Tuesday declare -A arrayB=( [\u0026#34;one\u0026#34;]=1 [\u0026#34;two\u0026#34;]=\u0026#34;2\u0026#34; ) echo \u0026#34;${!arrayB[*]}\u0026#34; # one two echo \u0026#34;${arrayB[*]}\u0026#34; # 1 2 arrayB+=( [\u0026#34;three\u0026#34;]=\u0026#34;3\u0026#34; [\u0026#34;four\u0026#34;]=4 ) echo \u0026#34;${!arrayB[*]}\u0026#34; # four one two three echo \u0026#34;${arrayB[*]}\u0026#34; # 4 1 2 3 arrayB+=( [\u0026#34;four\u0026#34;]=\u0026#34;aa\u0026#34; [\u0026#34;five\u0026#34;]=\u0026#34;5a1c\u0026#34; ) echo \u0026#34;${!arrayB[*]}\u0026#34; # four one five two three echo \u0026#34;${arrayB[*]}\u0026#34; # 4aa 1 5a1c 2 3 I/O redirection Forking Processes pid_perfix=\u0026#34;/tmp/proc-\u0026#34; function doSomething(){ local pid_file=\u0026#34;$pid_perfix$BASHPID\u0026#34; echo \u0026#34;this is task $1 : $pid_file \u0026#34; \u0026gt; $pid_file sleep 5 } w_pid=\u0026#34;\u0026#34; for task in {1..5} do doSomething $task \u0026amp; w_pid+=\u0026#34;$! \u0026#34; sleep 1 done for p in $w_pid do wait $p done #clean up for p in $w_pid do #del pid file rm \u0026#34;$pid_perfix$p\u0026#34; done exit 0 ","permalink":"https://oopsmonk.github.io/posts/2014-12-04-bashquickref/","summary":"Advanced Bash-Scripting Guide\nsed\nawk\nInternal Variables #current parent pid $$ #last background process pid $! #last exit status $? #current instance pid, Bash 4.x above. $BASHPID Arithmetic Expansion a=12 b=$(($a + 10)) b=`expr $a + 1` b=$(expr $a + 1) let b=$a+3 #let b=$a + 3 #incorrect let \u0026#34;b = $a + 3\u0026#34; declare -i b=$a+$a Manipulating Strings String is a number if [[ $var =~ ^-?[0-9]+$ ]]; then echo \u0026#34;$var is a number\u0026#34; fi if [[ !","title":"Bash Quick Reference"},{"content":"Use RRDTool monitor Raspberry Pi, include CPU temperture, Memory usage, Disk I/O, Network I/O\u0026hellip;\nInstall install packages\n$sudo apt-get install libcairo2-dev libpango1.0-dev libglib2.0-dev libxml2-dev \\ librrd-dev python2.7-dev rrdtool python-rrdtool $wget https://pypi.python.org/packages/source/p/psutil/psutil-2.1.1.tar.gz $tar xf psutil-2.1.1.tar.gz $cd psutil-2.1.1 $sudo python setup.py install Download or clone rpi-monitor on github\nhttps://github.com/oopsmonk/rpi-monitor\nSetup Crontab By defualt, the cron.log is disabled in Raspbian. To enable it:\nsudo vi /etc/rsyslog.conf find the line and uncomment it.\n# cron.* /var/log/cron.log Restart rsyslog via:\nsudo /etc/init.d/rsyslog restart Modify crontab\ncrontab -e Add schedule as below\n#data collection every 5 minutes */5 * * * * /path/to/rpi-monitor/rpi_monitor.py #generate daily graph report at 00:01 1 0 * * * /path/to/rpi-monitor/graphReport.py -1d #generate weekly graph report at 00:03 on Monday 3 0 * * 1 /path/to/rpi-monitor/graphReport.py -1w Report example Raspberry Pi Hardware CPU Temperture The temperture drop to 44 because I add a fan on CPU.\nCPU Used Percentage PID Count Memory Usage Mount point Usage Mount Point Percentage HDD I/O eth0 I/O eth1 I/O ","permalink":"https://oopsmonk.github.io/posts/2014-07-21-rpimonitor/","summary":"Use RRDTool monitor Raspberry Pi, include CPU temperture, Memory usage, Disk I/O, Network I/O\u0026hellip;\nInstall install packages\n$sudo apt-get install libcairo2-dev libpango1.0-dev libglib2.0-dev libxml2-dev \\ librrd-dev python2.7-dev rrdtool python-rrdtool $wget https://pypi.python.org/packages/source/p/psutil/psutil-2.1.1.tar.gz $tar xf psutil-2.1.1.tar.gz $cd psutil-2.1.1 $sudo python setup.py install Download or clone rpi-monitor on github\nhttps://github.com/oopsmonk/rpi-monitor\nSetup Crontab By defualt, the cron.log is disabled in Raspbian. To enable it:\nsudo vi /etc/rsyslog.conf find the line and uncomment it.\n# cron.","title":"Raspberry Pi Monitor"},{"content":"起司麵包 綜合麵包 平底鍋做麵包 戚風蛋糕 香蕉核桃馬芬蛋糕 鮭魚炒飯 ","permalink":"https://oopsmonk.github.io/posts/2013-12-31-baking2013/","summary":"起司麵包 綜合麵包 平底鍋做麵包 戚風蛋糕 香蕉核桃馬芬蛋糕 鮭魚炒飯 ","title":"Baking 2013"},{"content":"This is a git tutorial, create svn upstream on GitHub.\nUse MOC project as a example.\n#Checkout SVN and push to GitHub. Install packages\n$ sudo apt-get install subversion git-svn Create git repository (it will take a long time)\n$ git svn clone svn://daper.net/moc/trunk --no-metadata ./moc-svn-git $ cat moc-svn-git/.git/config [core] repositoryformatversion = 0 filemode = true bare = false logallrefupdates = true [svn-remote \u0026#34;svn\u0026#34;] noMetadata = 1 url = svn://daper.net/moc/trunk fetch = :refs/remotes/git-svn Update SVN repository\n$ git svn fetch $ git cehckout remotes/git-svn -b svn-upstream Creat repository on GitHub\n$ cd moc-svn-git $ git svn show-ignore \u0026gt; .gitignore $ git add -f .gitignore $ git commit -m \u0026#34;Convert svn:ignore to .gitignore\u0026#34; $ mkdir ../moc-bare $ git clone --bare ../moc-bare $ cd ../moc-bare/ Create empty repository on GitHub. (named moc-git) $ git push --mirror https://github.com/\u0026#39;your-account\u0026#39;/moc-git.git After this step, we create two folders.\nmoc-svn-git: SVN and Git Workspace.\nmoc-bare: Git bare for GitHub.\n#Add GitHub repository to workspace\n$ cd moc-svn-git $ git remote add github-moc https://github.com/\u0026#39;your-account\u0026#39;/moc-git.git $ git remote update $ git branch -a * master svn-upstream remotes/git-svn remotes/github-moc/master $ git checkout remotes/github-moc/master -b github-moc $ git branch -a * github-moc master svn-upstream remotes/git-svn remotes/github-moc/master #Merge upstream\n$ cd moc-svn-git $ git pull fetch remotes/git-svn $ git svn fetch $ git checkout remotes/git-svn -b upstream-now $ git checkout master $ git merge upstream-now Fix Conflicts... $ git add . $ git commit $ git push Ref:\nConverting a Subverion repository to Git\nGit SVN Tutorial\n","permalink":"https://oopsmonk.github.io/posts/2013-08-26-git-svn-upstream/","summary":"This is a git tutorial, create svn upstream on GitHub.\nUse MOC project as a example.\n#Checkout SVN and push to GitHub. Install packages\n$ sudo apt-get install subversion git-svn Create git repository (it will take a long time)\n$ git svn clone svn://daper.net/moc/trunk --no-metadata ./moc-svn-git $ cat moc-svn-git/.git/config [core] repositoryformatversion = 0 filemode = true bare = false logallrefupdates = true [svn-remote \u0026#34;svn\u0026#34;] noMetadata = 1 url = svn://daper.net/moc/trunk fetch = :refs/remotes/git-svn Update SVN repository","title":"GitHub SVN Upstream (on Ubuntu12.04)"},{"content":"clone MOC svn repository to github Ref: Converting a Subversion repository to Git\n$ sudo apt-get install subversion git-svn $ mkdir moc-svn $ cd moc-svn $ svn co svn://daper.net/moc/trunk $ svn log -q | awk -F \u0026#39;|\u0026#39; \u0026#39;/^r/ {sub(\u0026#34;^ \u0026#34;, \u0026#34;\u0026#34;, $2); sub(\u0026#34; $\u0026#34;, \u0026#34;\u0026#34;, $2); print $2\u0026#34; = \u0026#34;$2\u0026#34; \u0026lt;\u0026#34;$2\u0026#34;\u0026gt;\u0026#34;}\u0026#39; | sort -u \u0026gt; authors-transform.txt $ cd .. $ mkdir moc-git $ git svn clone svn://daper.net/moc/trunk --no-metadata -A ./moc-svn/authors-transform.txt ./moc-git $ cd moc-git $ git svn show-ignore \u0026gt; .gitignore $ git add -f .gitignore $ git commit -m \u0026#34;Convert svn:ignore to .gitignore.\u0026#34; $ mkdir ../moc-bare $ git clone --bare ../moc-bare $ cd ../moc-bare/moc-git.git #Create empty repository on GitHub. $ git push --mirror https://github.com/oopsmonk/moc-git.git install develop package for MOC (Ubuntu) $ sudo apt-get install build-essential libdb-dev gettext Optional libraries: Sound driver: ALSA - libasound2-dev JACK - libjack-dev Decoder: FLAC - libflac-dev MP3 - libmad0-dev, libid3tag0-dev sndfile, vorbis - libsndfile1-dev Network: libcurl4-gnutls-dev RCC: librcc-dev Resample : libsamplerate0-dev MIME magic: libmagic-dev After release 2.5 MOC will require libpopt. $ sudo apt-get install libasound2-dev libjack-dev \\ libflac-dev libmad0-dev libid3tag0-dev libsndfile1-dev $ sudo apt-get install libcurl4-gnutls-dev librcc-dev \\ libsamplerate0-dev libmagic-dev libpopt ----------------------------------------------------------------------- MOC will be compiled with: Decoder plugins: flac mp3 sndfile vorbis Sound Drivers: OSS ALSA JACK DEBUG: yes RCC: yes Network streams: yes Resampling: yes MIME magic: yes ----------------------------------------------------------------------- install develop package for MOC (Raspberry Pi) $ sudo apt-get install build-essential autoconf automake libtool $ sudo apt-get install libncurses5-dev libdb-dev gettext $ sudo apt-get install libasound2-dev libjack-dev libflac-dev \\ libmad0-dev libid3tag0-dev libsndfile1-dev $ sudo apt-get install libcurl4-gnutls-dev librcc-dev libsamplerate0-dev libmagic-dev Build libpopt $ wget http://rpm5.org/files/popt/popt-1.16.tar.gz $ tar xf popt-1.16.tar.gz $ cd popt-1.16 $ autoreconf $ ./configure --prefix=/usr/lib --enable-shared $ make $ sudo make install check out from repository $ svn co svn://daper.net/moc/trunk moc-svn Build step $ cd moc-svn $ autoreconf $ ./configure --enable-debug --perfix=/path/to/dev $ make \u0026amp;\u0026amp; make install Debugging $cd /path/to/dev $ ./bin/mocp --debug ","permalink":"https://oopsmonk.github.io/posts/2013-08-23-mocbuilding/","summary":"clone MOC svn repository to github Ref: Converting a Subversion repository to Git\n$ sudo apt-get install subversion git-svn $ mkdir moc-svn $ cd moc-svn $ svn co svn://daper.net/moc/trunk $ svn log -q | awk -F \u0026#39;|\u0026#39; \u0026#39;/^r/ {sub(\u0026#34;^ \u0026#34;, \u0026#34;\u0026#34;, $2); sub(\u0026#34; $\u0026#34;, \u0026#34;\u0026#34;, $2); print $2\u0026#34; = \u0026#34;$2\u0026#34; \u0026lt;\u0026#34;$2\u0026#34;\u0026gt;\u0026#34;}\u0026#39; | sort -u \u0026gt; authors-transform.txt $ cd .. $ mkdir moc-git $ git svn clone svn://daper.net/moc/trunk --no-metadata -A ./moc-svn/authors-transform.txt .","title":"Building MOC"},{"content":"Bottle is a fast, simple and lightweight WSGI micro web-framework for Python.\njQuery Mobile base on jQuery for mobile device.\njQuery vs. jQuery Mobile vs. jQuery UI\nInstall bottle: $ sudo apt-get install python-setuptools $ easy_install bottle Demo server deployment file structure: BottlejQuery ├── bottleJQuery.py └── index.html run command: $ ./bottleJQuery.py connect to server: http://localhost:8080/bottle Building simple web server use bottle bottleJQuery.py #!/usr/bin/env python from bottle import route, static_file, debug, run, get, redirect from bottle import post, request import os, inspect, json #enable bottle debug debug(True) # WebApp route path routePath = \u0026#39;/bottle\u0026#39; # get directory of WebApp (bottleJQuery.py\u0026#39;s dir) rootPath = os.path.dirname(os.path.abspath(inspect.getfile(inspect.currentframe()))) @route(routePath) def rootHome(): return redirect(routePath+\u0026#39;/index.html\u0026#39;) @route(routePath + \u0026#39;/\u0026lt;filename:re:.*\\.html\u0026gt;\u0026#39;) def html_file(filename): return static_file(filename, root=rootPath) @get(routePath + \u0026#39;/jsontest\u0026#39;) def testJsonGET(): print \u0026#34;GET Header : \\n %s\u0026#34; % dict(request.headers) #for debug header return {\u0026#34;id\u0026#34;:2,\u0026#34;name\u0026#34;:\u0026#34;Jone\u0026#34;} @post(routePath + \u0026#39;/jsontest\u0026#39;) def testJsonPost(): print \u0026#34;POST Header : \\n %s\u0026#34; % dict(request.headers) #for debug header data = request.json print \u0026#34;data : %s\u0026#34; % data if data == None: return json.dumps({\u0026#39;Status\u0026#39;:\u0026#34;Failed!\u0026#34;}) else: return json.dumps({\u0026#39;Status\u0026#39;:\u0026#34;Success!\u0026#34;}) run(host=\u0026#39;localhost\u0026#39;, port=8080, reloader=True) Test GET request: $ curl -i -X GET http://localhost:8080/bottle/jsontest HTTP/1.0 200 OK Date: Wed, 07 Aug 2013 16:03:53 GMT Server: WSGIServer/0.1 Python/2.7.3 Content-Length: 25 Content-Type: application/json {\u0026#34;id\u0026#34;: 2, \u0026#34;name\u0026#34;: \u0026#34;Jone\u0026#34;} bottle debug message:\nGET Header : {\u0026#39;Host\u0026#39;: \u0026#39;localhost:8080\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;text/plain\u0026#39;, \u0026#39;Content-Length\u0026#39;: \u0026#39;\u0026#39;, \u0026#39;Accept\u0026#39;: \u0026#39;*/*\u0026#39;, \u0026#39;User-Agent\u0026#39;: \u0026#39;curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\u0026#39;} localhost - - [08/Aug/2013 00:03:53] \u0026#34;GET /bottle/jsontest HTTP/1.1\u0026#34; 200 25 Test POST request: $ curl -X POST -H \u0026#34;Content-Type: application/json\u0026#34; \\ -d \u0026#39;{\u0026#34;name\u0026#34;:\u0026#34;OopsMonk\u0026#34;,\u0026#34;pwd\u0026#34;:\u0026#34;abc\u0026#34;}\u0026#39; \\ http://localhost:8080/bottle/jsontest {\u0026#34;Status\u0026#34;: \u0026#34;Success!\u0026#34;} bottle debug message:\nPOST Header : {\u0026#39;Host\u0026#39;: \u0026#39;localhost:8080\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;application/json\u0026#39;, \u0026#39;Content-Length\u0026#39;: \u0026#39;31\u0026#39;, \u0026#39;Accept\u0026#39;: \u0026#39;*/*\u0026#39;, \u0026#39;User-Agent\u0026#39;: \u0026#39;curl/7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3\u0026#39;} data : {u\u0026#39;pwd\u0026#39;: u\u0026#39;abc\u0026#39;, u\u0026#39;name\u0026#39;: u\u0026#39;OopsMonk\u0026#39;} localhost - - [08/Aug/2013 00:04:56] \u0026#34;POST /bottle/jsontest HTTP/1.1\u0026#34; 200 22 Building simple web page Create 4 buttons in the index.html file:\njQuery.getJSON : use jQuery.getJSON API.\nbottle debug message: GET Header : {\u0026#39;Content-Length\u0026#39;: \u0026#39;\u0026#39;, \u0026#39;Accept-Language\u0026#39;: \u0026#39;zh-tw,zh;q=0.8,en-us;q=0.5,en;q=0.3\u0026#39;, \u0026#39;Accept-Encoding\u0026#39;: \u0026#39;gzip, deflate\u0026#39;, \u0026#39;Host\u0026#39;: \u0026#39;127.0.0.1:8080\u0026#39;, \u0026#39;Accept\u0026#39;: \u0026#39;application/json, text/javascript, */*; q=0.01\u0026#39;, \u0026#39;User-Agent\u0026#39;: \u0026#39;Mozilla/5.0 (Windows NT 6.1; WOW64; rv:22.0) Gecko/20100101 Firefox/22.0\u0026#39;, \u0026#39;Connection\u0026#39;: \u0026#39;close\u0026#39;, \u0026#39;X-Requested-With\u0026#39;: \u0026#39;XMLHttpRequest\u0026#39;, \u0026#39;Referer\u0026#39;: \u0026#39;http://192.168.1.38/bottle/index.html\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;text/plain\u0026#39;} localhost - - [08/Aug/2013 00:42:08] \u0026#34;GET /bottle/jsontest HTTP/1.0\u0026#34; 200 25 jQuery.post : use jQuery.post API.\nUnfortunately it\u0026rsquo;s not work, because the content-Type is fixed \u0026lsquo;application/x-www-form-urlencoded; charset=UTF-8\u0026rsquo;, that\u0026rsquo;s a problem when using bottle.request.json API to retrieve JSON from request.\nFor this perpose we have to overwirte jQuery.post or use jQuery.ajax. bottle debug message: POST Header : {\u0026#39;Content-Length\u0026#39;: \u0026#39;22\u0026#39;, \u0026#39;Accept-Language\u0026#39;: \u0026#39;zh-tw,zh;q=0.8,en-us;q=0.5,en;q=0.3\u0026#39;, \u0026#39;Accept-Encoding\u0026#39;: \u0026#39;gzip, deflate\u0026#39;, \u0026#39;Host\u0026#39;: \u0026#39;127.0.0.1:8080\u0026#39;, \u0026#39;Accept\u0026#39;: \u0026#39;application/json, text/javascript, */*; q=0.01\u0026#39;, \u0026#39;User-Agent\u0026#39;: \u0026#39;Mozilla/5.0 (Windows NT 6.1; WOW64; rv:22.0) Gecko/20100101 Firefox/22.0\u0026#39;, \u0026#39;Connection\u0026#39;: \u0026#39;close\u0026#39;, \u0026#39;X-Requested-With\u0026#39;: \u0026#39;XMLHttpRequest\u0026#39;, \u0026#39;Pragma\u0026#39;: \u0026#39;no-cache\u0026#39;, \u0026#39;Cache-Control\u0026#39;: \u0026#39;no-cache\u0026#39;, \u0026#39;Referer\u0026#39;: \u0026#39;http://192.168.1.38/bottle/index.html\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;application/x-www-form-urlencoded; charset=UTF-8\u0026#39;} data : None localhost - - [08/Aug/2013 00:55:17] \u0026#34;POST /bottle/jsontest HTTP/1.0\u0026#34; 200 21 jQuery.ajax GET, jQuery.ajax POST : use jQuery.ajax API. GET debug message:\nGET Header : {\u0026#39;Content-Length\u0026#39;: \u0026#39;\u0026#39;, \u0026#39;Accept-Language\u0026#39;: \u0026#39;zh-tw,zh;q=0.8,en-us;q=0.5,en;q=0.3\u0026#39;, \u0026#39;Accept-Encoding\u0026#39;: \u0026#39;gzip, deflate\u0026#39;, \u0026#39;Host\u0026#39;: \u0026#39;127.0.0.1:8080\u0026#39;, \u0026#39;Accept\u0026#39;: \u0026#39;application/json, text/javascript, */*; q=0.01\u0026#39;, \u0026#39;User-Agent\u0026#39;: \u0026#39;Mozilla/5.0 (Windows NT 6.1; WOW64; rv:22.0) Gecko/20100101 Firefox/22.0\u0026#39;, \u0026#39;Connection\u0026#39;: \u0026#39;close\u0026#39;, \u0026#39;X-Requested-With\u0026#39;: \u0026#39;XMLHttpRequest\u0026#39;, \u0026#39;Referer\u0026#39;: \u0026#39;http://192.168.1.38/bottle/index.html\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;text/plain\u0026#39;} localhost - - [08/Aug/2013 01:00:17] \u0026#34;GET /bottle/jsontest HTTP/1.0\u0026#34; 200 25 POST debug message:\nPOST Header : {\u0026#39;Content-Length\u0026#39;: \u0026#39;22\u0026#39;, \u0026#39;Accept-Language\u0026#39;: \u0026#39;zh-tw,zh;q=0.8,en-us;q=0.5,en;q=0.3\u0026#39;, \u0026#39;Accept-Encoding\u0026#39;: \u0026#39;gzip, deflate\u0026#39;, \u0026#39;Host\u0026#39;: \u0026#39;127.0.0.1:8080\u0026#39;, \u0026#39;Accept\u0026#39;: \u0026#39;application/json, text/javascript, */*; q=0.01\u0026#39;, \u0026#39;User-Agent\u0026#39;: \u0026#39;Mozilla/5.0 (Windows NT 6.1; WOW64; rv:22.0) Gecko/20100101 Firefox/22.0\u0026#39;, \u0026#39;Connection\u0026#39;: \u0026#39;close\u0026#39;, \u0026#39;X-Requested-With\u0026#39;: \u0026#39;XMLHttpRequest\u0026#39;, \u0026#39;Pragma\u0026#39;: \u0026#39;no-cache\u0026#39;, \u0026#39;Cache-Control\u0026#39;: \u0026#39;no-cache\u0026#39;, \u0026#39;Referer\u0026#39;: \u0026#39;http://192.168.1.38/bottle/index.html\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;application/json; charset=utf-8\u0026#39;} data : {u\u0026#39;id\u0026#39;: 3, u\u0026#39;name\u0026#39;: u\u0026#39;Ping\u0026#39;} localhost - - [08/Aug/2013 01:01:40] \u0026#34;POST /bottle/jsontest HTTP/1.0\u0026#34; 200 22 ###index.html\n\u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;Bottle \u0026amp; jQuery Mobile\u0026lt;/title\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css\u0026#34; /\u0026gt; \u0026lt;script src=\u0026#34;http://code.jquery.com/jquery-1.9.1.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h3\u0026gt;This is a example using jQuery Mobile and pyhton bottle fromwork. \u0026lt;/h3\u0026gt; \u0026lt;div data-role=\u0026#34;controlgroup\u0026#34; data-type=\u0026#34;horizontal\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; id=\u0026#34;btnGetJSON\u0026#34; data-role=\u0026#34;button\u0026#34;\u0026gt;jQuery.getJSON\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; id=\u0026#34;btnPOSTJSON\u0026#34; data-role=\u0026#34;button\u0026#34;\u0026gt;jQuery.post\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; id=\u0026#34;btnAJAXGet\u0026#34; data-role=\u0026#34;button\u0026#34;\u0026gt;jQuery.ajax GET\u0026lt;/a\u0026gt; \u0026lt;a href=\u0026#34;#\u0026#34; id=\u0026#34;btnAJAXPOST\u0026#34; data-role=\u0026#34;button\u0026#34;\u0026gt;jQuery.ajax POST\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; //button action $(\u0026#34;#btnGetJSON\u0026#34;).click(function(){ $.getJSON(\u0026#34;jsontest\u0026#34;, function(data){ $.each(data, function(index, value){ alert(\u0026#34;index: \u0026#34; + index + \u0026#34; , value: \u0026#34;+ value); }); }); }); $(\u0026#34;#btnPOSTJSON\u0026#34;).click(function(){ alert(\u0026#34;Not easy work on bottle !!!\u0026#34;); /* It\u0026#39;s not work, send JSON via jQuery.post(). because the content-Type is not \u0026#39;application/json\u0026#39;, The content type is fixed : \u0026#39;Content-Type\u0026#39;: \u0026#39;application/x-www-form-urlencoded; charset=UTF-8\u0026#39; that\u0026#39;s a problem on bottle.request.json. */ $.post( \u0026#34;jsontest\u0026#34;, JSON.stringify({\u0026#34;id\u0026#34;:3, \u0026#34;name\u0026#34;:\u0026#34;Ping\u0026#34;}), function(ret_data, st){ $.each(ret_data, function(index, value){ alert(\u0026#34;index: \u0026#34; + index + \u0026#34; , value: \u0026#34;+ value); }); alert(\u0026#34;Server return status : \u0026#34; + st); }, \u0026#39;json\u0026#39; ); }); $(\u0026#34;#btnAJAXGet\u0026#34;).click(function(){ $.ajax ({ url: \u0026#39;jsontest\u0026#39;, success: function(data){ $.each(data, function(index, value){ alert(\u0026#34;index: \u0026#34; + index + \u0026#34; , value: \u0026#34;+ value); }); }, /* if dataType not set, the Accept in request header is: \u0026#39;Accept\u0026#39;: \u0026#39;* / *\u0026#39; dataType = json : \u0026#39;Accept\u0026#39;: \u0026#39;application/json, text/javascript, * /*; q=0.01\u0026#39; */ dataType: \u0026#39;json\u0026#39; }); }); $(\u0026#34;#btnAJAXPOST\u0026#34;).click(function(){ var post_data = {\u0026#34;id\u0026#34;:3, \u0026#34;name\u0026#34;:\u0026#34;Ping\u0026#34;}; $.ajax ({ type: \u0026#39;POST\u0026#39;, url: \u0026#39;jsontest\u0026#39;, data:JSON.stringify(post_data), contentType: \u0026#34;application/json; charset=utf-8\u0026#34;, dataType: \u0026#39;json\u0026#39;, success: function(data){ $.each(data, function(index, value){ alert(\u0026#34;index: \u0026#34; + index + \u0026#34; , value: \u0026#34;+ value); }); } }); }); \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; ","permalink":"https://oopsmonk.github.io/posts/2013-08-07-bottlejqueryjson/","summary":"Bottle is a fast, simple and lightweight WSGI micro web-framework for Python.\njQuery Mobile base on jQuery for mobile device.\njQuery vs. jQuery Mobile vs. jQuery UI\nInstall bottle: $ sudo apt-get install python-setuptools $ easy_install bottle Demo server deployment file structure: BottlejQuery ├── bottleJQuery.py └── index.html run command: $ ./bottleJQuery.py connect to server: http://localhost:8080/bottle Building simple web server use bottle bottleJQuery.py #!/usr/bin/env python from bottle import route, static_file, debug, run, get, redirect from bottle import post, request import os, inspect, json #enable bottle debug debug(True) # WebApp route path routePath = \u0026#39;/bottle\u0026#39; # get directory of WebApp (bottleJQuery.","title":"Web dev example : JSON \u0026 jQuery Mobile \u0026 Bottle"},{"content":"Here is a text/plain MIME type parts in official exmaple code.\nI remove it from my sample code, because it\u0026rsquo;s not show up in mail at Office Outlook 2010.\n#!/usr/bin/env python \u0026#34;\u0026#34;\u0026#34; File name: sendMail.py Python send HTML mail using SMTP with authorization Usage : ./sendMail.py to@gmail.com Subtitle [ FilePath | txt ] \u0026#34;\u0026#34;\u0026#34; import smtplib import sys,traceback from email.mime.multipart import MIMEMultipart from email.mime.text import MIMEText from time import gmtime, strftime #log file location log_path = \u0026#34;./mail-log\u0026#34;; #log timestamp format logger_tstamp = \u0026#34;%Y-%m-%d %H:%M:%S\u0026#34; #SMPT server smtp_server = \u0026#34;smtp.gmail.com\u0026#34; #gmail 465 or 578 smtp_port = 587 #mail from user = \u0026#34;from@gmail.com\u0026#34; pwd = \u0026#34;password\u0026#34; # log method class Logger: file = 1 err = 2 class ContentType: file = 1 txt = 2 #select log method debug_log = Logger.err #select content type content_type = ContentType.txt def debug(msg): if debug_log == Logger.file: with open(log_path, \u0026#39;a\u0026#39;) as log_file: log_file.write(strftime(logger_tstamp, gmtime()) + msg) log_file.close() elif debug_log == Logger.err: sys.stderr.write(strftime(logger_tstamp, gmtime()) + msg) else: print(strftime(logger_tstamp, gmtime()) + msg) #check argument number arg_count = len(sys.argv) if arg_count !=4: debug(\u0026#34;[Error]: invalid argument\\n\u0026#34;) sys.exit(1) try: mail_to = sys.argv[1] subject = sys.argv[2] if content_type == ContentType.file: content_path = sys.argv[3] with open(content_path, \u0026#39;r\u0026#39;) as f_content: content = f_content.read() f_content.close() else: content = sys.argv[3] serv = smtplib.SMTP(smtp_server, smtp_port) # serv.ehlo() serv.starttls() # serv.ehlo() serv.login(user, pwd); msg = MIMEMultipart(\u0026#39;alternative\u0026#39;) msg[\u0026#39;Subject\u0026#39;] = subject msg[\u0026#39;From\u0026#39;] = user msg[\u0026#39;To\u0026#39;] = mail_to part1 = MIMEText(content, \u0026#39;html\u0026#39;) msg.attach(part1) serv.sendmail(user, mail_to, msg.as_string()) serv.quit() debug(\u0026#34;[Debug] subject : \u0026#34; + subject + \u0026#34;\\n\u0026#34;) except: debug(\u0026#34;[Error]: send mail error\\n\u0026#34;) debug(\u0026#34;[Error]:\\n\u0026#34; + traceback.format_exc()) sys.exit(2); Reference:\nemail: Examples\nsmtplib\nHow to send email in Python via SMTPLIB\n","permalink":"https://oopsmonk.github.io/posts/2013-07-31-sendingmailsmtp/","summary":"Here is a text/plain MIME type parts in official exmaple code.\nI remove it from my sample code, because it\u0026rsquo;s not show up in mail at Office Outlook 2010.\n#!/usr/bin/env python \u0026#34;\u0026#34;\u0026#34; File name: sendMail.py Python send HTML mail using SMTP with authorization Usage : ./sendMail.py to@gmail.com Subtitle [ FilePath | txt ] \u0026#34;\u0026#34;\u0026#34; import smtplib import sys,traceback from email.mime.multipart import MIMEMultipart from email.mime.text import MIMEText from time import gmtime, strftime #log file location log_path = \u0026#34;.","title":"Sending HTML Mail Using SMTP With Authorization"},{"content":"Redirect port 8080 to 80\nsudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080 Check iptables setting\nsudo iptables -t nat -L Save configure to iptables.rules\nsudo iptables-save \u0026gt; /etc/iptables.rules Save Solution #1 Configre /etc/network/interfaces\niface eth0 inet dhcp pre-up iptables-restore \u0026lt; /etc/iptables.rules Save Solution #2 Configure /etc/network/if-pre-up.d/iptablesload\n#!/bin/sh iptables-restore \u0026lt; /etc/iptables.rules exit 0 Configure /etc/network/if-post-down.d/iptablessave\n#!/bin/sh iptables-save -c \u0026gt; /etc/iptables.rules if [ -f /etc/iptables.downrules ]; then iptables-restore \u0026lt; /etc/iptables.downrules fi exit 0 Change permissions\nsudo chmod +x /etc/network/if-post-down.d/iptablessave sudo chmod +x /etc/network/if-pre-up.d/iptablesload Reference:\nTomcat: redirecting traffic from port 8080 to 80 using iptables\nIptablesHowTo\n","permalink":"https://oopsmonk.github.io/posts/2013-07-05-savingiptables/","summary":"Redirect port 8080 to 80\nsudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080 Check iptables setting\nsudo iptables -t nat -L Save configure to iptables.rules\nsudo iptables-save \u0026gt; /etc/iptables.rules Save Solution #1 Configre /etc/network/interfaces\niface eth0 inet dhcp pre-up iptables-restore \u0026lt; /etc/iptables.rules Save Solution #2 Configure /etc/network/if-pre-up.d/iptablesload\n#!/bin/sh iptables-restore \u0026lt; /etc/iptables.rules exit 0 Configure /etc/network/if-post-down.d/iptablessave\n#!/bin/sh iptables-save -c \u0026gt; /etc/iptables.rules if [ -f /etc/iptables.downrules ]; then iptables-restore \u0026lt; /etc/iptables.","title":"Redirect and Save iptables on Ubuntu 12.04"},{"content":"install jayDeBeApi \u0026amp; jpype\n$ sudo apt-get install python-setuptools $ sudo easy_install JayDeBeApi $ sudo easy_install jpype Download Oracle JDBC Drivers ojdbc6.jar to local.\nimport jpype import jaydebeapi jHome = jpype.getDefaultJVMPath() print jHome jpype.startJVM(jHome, \u0026#39;-Djava.class.path=/path/to/ojdbc6.jar\u0026#39;) conn = jaydebeapi.connect(\u0026#39;oracle.jdbc.driver.OracleDriver\u0026#39;, \u0026#39;jdbc:oracle:thin:user/password@DB_HOST_IP:1521:DB_NAME\u0026#39;) curs = conn.cursor() curs.execute(\u0026#34;select * from ACCOUNT\u0026#34;) acc = curs.fetchall() curs.close() conn.close() jpype.shutdownJVM() print acc Reference:\nhttps://pypi.python.org/pypi/JayDeBeApi\nhttp://wiki.python.org/moin/Oracle\n","permalink":"https://oopsmonk.github.io/posts/2013-06-24-oracle10gpython/","summary":"install jayDeBeApi \u0026amp; jpype\n$ sudo apt-get install python-setuptools $ sudo easy_install JayDeBeApi $ sudo easy_install jpype Download Oracle JDBC Drivers ojdbc6.jar to local.\nimport jpype import jaydebeapi jHome = jpype.getDefaultJVMPath() print jHome jpype.startJVM(jHome, \u0026#39;-Djava.class.path=/path/to/ojdbc6.jar\u0026#39;) conn = jaydebeapi.connect(\u0026#39;oracle.jdbc.driver.OracleDriver\u0026#39;, \u0026#39;jdbc:oracle:thin:user/password@DB_HOST_IP:1521:DB_NAME\u0026#39;) curs = conn.cursor() curs.execute(\u0026#34;select * from ACCOUNT\u0026#34;) acc = curs.fetchall() curs.close() conn.close() jpype.shutdownJVM() print acc Reference:\nhttps://pypi.python.org/pypi/JayDeBeApi\nhttp://wiki.python.org/moin/Oracle","title":"Connect Oracle 10g Database use JDBC"},{"content":"Here is an error occurred if installed directly:\ninstall.sfx.XXX: not found\nSolution:\ninstall g++-mltilib and JDK $ sudo apt-get install g++-multilib $ chmod +x j2sdk-1_4_2_19-linux-i586.bin $ ./j2sdk-1_4_2_19-linux-i586.bin ..... Do you agree to the above license terms? [yes or no] yes Unpacking... Checksumming... 0 0 Extracting... UnZipSFX 5.40 of 28 November 1998, by Info-ZIP (Zip-Bugs@lists.wku.edu). creating: j2sdk1.4.2_19/ creating: j2sdk1.4.2_19/jre/ creating: j2sdk1.4.2_19/jre/bin/ inflating: j2sdk1.4.2_19/jre/bin/java inflating: j2sdk1.4.2_19/jre/bin/keytool inflating: j2sdk1.4.2_19/jre/bin/policytool .... Creating j2sdk1.4.2_19/lib/tools.jar Creating j2sdk1.4.2_19/jre/lib/rt.jar Creating j2sdk1.4.2_19/jre/lib/jsse.jar Creating j2sdk1.4.2_19/jre/lib/charsets.jar Creating j2sdk1.4.2_19/jre/lib/ext/localedata.jar Creating j2sdk1.4.2_19/jre/lib/plugin.jar Creating j2sdk1.4.2_19/jre/javaws/javaws.jar Done. $ sudo mkdir -p /usr/lib/jvm $ sudo mv j2sdk1.4.2_19 /usr/lib/jvm/java-1.4.2_19 Java environment configuration. $ wget http://webupd8.googlecode.com/files/update-java-0.5b $ chmod +x update-java-0.5b $ sudo ./update-java-0.5b Select java-1.4.2_19 Check java version $ java -version java version \u0026#34;1.4.2_19\u0026#34; Java(TM) 2 Runtime Environment, Standard Edition (build 1.4.2_19-b04) Java HotSpot(TM) Client VM (build 1.4.2_19-b04, mixed mode) ","permalink":"https://oopsmonk.github.io/posts/2013-06-20-jdk1.4.2/","summary":"Here is an error occurred if installed directly:\ninstall.sfx.XXX: not found\nSolution:\ninstall g++-mltilib and JDK $ sudo apt-get install g++-multilib $ chmod +x j2sdk-1_4_2_19-linux-i586.bin $ ./j2sdk-1_4_2_19-linux-i586.bin ..... Do you agree to the above license terms? [yes or no] yes Unpacking... Checksumming... 0 0 Extracting... UnZipSFX 5.40 of 28 November 1998, by Info-ZIP (Zip-Bugs@lists.wku.edu). creating: j2sdk1.4.2_19/ creating: j2sdk1.4.2_19/jre/ creating: j2sdk1.4.2_19/jre/bin/ inflating: j2sdk1.4.2_19/jre/bin/java inflating: j2sdk1.4.2_19/jre/bin/keytool inflating: j2sdk1.4.2_19/jre/bin/policytool .... Creating j2sdk1.4.2_19/lib/tools.jar Creating j2sdk1.","title":"Install JDK1.4.2(32bit) on Ubuntu 12.04 LTS(64bit) "},{"content":"有時在整理照片或文件時, 需要比對2個資料匣, 把重覆的檔案拿掉.\nDwonload Source Here\nfunction usage(){ echo \u0026#34;Find the same file in two folders and remove it.\u0026#34; echo \u0026#34;usage : ./comp-rm.sh target-dir source-dir\u0026#34; echo \u0026#34;remove the same files in target-dir.\u0026#34; } if [ $# -ne 2 ]; then usage exit 1 fi target_dir=$1 source_dir=$2 f_list1=$(find \u0026#34;$target_dir\u0026#34; -type f) f_list2=$(find \u0026#34;$source_dir\u0026#34; -type f) for i in $f_list1; do echo $f_list2 | grep $(basename $i) \u0026gt;/dev/null \u0026amp;\u0026amp; hit_str+=$i\u0026#34;;\u0026#34; done if [ -z $hit_str ]; then echo \u0026#34;list is empty..\u0026#34; exit 0 fi export IFS=\u0026#34;;\u0026#34; count=0 for hit_file in $hit_str; do echo \u0026#34;$hit_file\u0026#34; let count++ done echo \u0026#34;Do you want to remove these files ($count)?\u0026#34; read -p \u0026#34;Press \u0026#39;Ctrl+C\u0026#39; stop, \u0026#39;Enter\u0026#39; key to continue...\u0026#34; for hit_file in $hit_str; do echo \u0026#34;removing... $hit_file\u0026#34; rm -f $hit_file done exit 0 ","permalink":"https://oopsmonk.github.io/posts/2013-06-19-comparermfileintwofolder/","summary":"有時在整理照片或文件時, 需要比對2個資料匣, 把重覆的檔案拿掉.\nDwonload Source Here\nfunction usage(){ echo \u0026#34;Find the same file in two folders and remove it.\u0026#34; echo \u0026#34;usage : ./comp-rm.sh target-dir source-dir\u0026#34; echo \u0026#34;remove the same files in target-dir.\u0026#34; } if [ $# -ne 2 ]; then usage exit 1 fi target_dir=$1 source_dir=$2 f_list1=$(find \u0026#34;$target_dir\u0026#34; -type f) f_list2=$(find \u0026#34;$source_dir\u0026#34; -type f) for i in $f_list1; do echo $f_list2 | grep $(basename $i) \u0026gt;/dev/null \u0026amp;\u0026amp; hit_str+=$i\u0026#34;;\u0026#34; done if [ -z $hit_str ]; then echo \u0026#34;list is empty.","title":"Remove the same files in two folders"},{"content":"Install Raspbian \u0026ldquo;wheezy\u0026rdquo; image Download image from Raspberry Pi offical website\nMount HOME to HDD Copy HOME data to disk $ sudo mkdir /media/new_home $ sudo mount /dev/sda1 /media/new_home $ sudo rsync -aXS /home/. /media/new_home/. $ sudo umount /media/new_home fstab #get disk UUID $ sudo blkid /dev/mmcblk0p1: SEC_TYPE=\u0026#34;msdos\u0026#34; LABEL=\u0026#34;boot\u0026#34; UUID=\u0026#34;936C-7122\u0026#34; TYPE=\u0026#34;vfat\u0026#34; /dev/mmcblk0p2: UUID=\u0026#34;c1198422-7a7c-4863-8a8f-45a1db26b4f2\u0026#34; TYPE=\u0026#34;ext4\u0026#34; /dev/sda1: UUID=\u0026#34;2cd990b5-6c27-4933-95d0-fd00b000fe77\u0026#34; TYPE=\u0026#34;ext4\u0026#34; #modify fstab $ echo \u0026#34;UUID=2cd880b5-6c27-4933-95d0-fd00b000fe77 /home ext4 defaults 0 2\u0026#34; | sudo tee --append /etc/fstab #mount HOMW without reboot. $ sudo mount -a Create a sudo user #create user with HOME directory $ sudo useradd -m oopsmonk #add user to sudo group $ sudo adduser oopsmonk sudo #set password $ sudo passwd oopsmonk Install necessary packages $ sudo aptitude full-upgrade -y $ sudo aptitude install tmux vim git python-setuptools -y $ sudo easy_install pip SAMBA server $ sudo aptitude install samba $ sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.bak $ sudo vi /etc/samba/smb.conf enable sucurity user # security = user [rpi] comment = raspberry-pi path = /home/oopsmonk/ browseable = yes writable = yes read only = no #add smaba user and restart samba server $ sudo pdbedit -a -u oopsmonk $ sudo service samba restart Configre default editor $ echo \u0026#34;export EDITOR=vim\u0026#34; \u0026gt;\u0026gt; ~/.bashrc $ echo \u0026#34;export GIT_EDITOR=vim\u0026#34; \u0026gt;\u0026gt; ~/.bashrc $ echo \u0026#34;export TERM=screen-256color\u0026#34; \u0026gt;\u0026gt; ~/.bashrc $ echo \u0026#34;alias tmux=\u0026#39;tmux -2\u0026#39;\u0026#34; \u0026gt;\u0026gt; ~/.bashrc $ source ~/.bashrc Boot from USB Disk Use dd or Win32DiskImager dump image to both SD card and USB Disk.\nUse gparted to expand root partition to full USB disk.\nChange cmdline.txt on sdcard from root=/dev/mmcblk0p2 to root=/dev/sda2\ndwc_otg.lpm_enable=0 console=ttyAMA0,115200 kgdboc=ttyAMA0,115200 console=tty1 root=/dev/sda2 rootfstype=ext4 elevator=deadline rootwait Plug both sdcard and USB disk into Raspberry Pi, bootup system.\nexFat support Defualt cannot mount exFAT filesystem, why exFAT?\nNTFS performance is so bad. Single file limited to 4GB in FAT32. Install exFat:\nsudo apt-get install exfat-fuse FTP server setup Install vsftpd $ sudo apt-get install vsftpd $ sudo cp /etc/vsftpd.conf /etc/vsftpd.conf.bak Modify vsftpd.conf $ sudo vi /etc/vsftpd.conf anonymous_enable=NO local_enable=YES write_enable=YES force_dot_files=YES #Add at bottom Invoke configuration\nsudo service vsftpd restart References:\nhttp://www.wikihow.com/Make-a-Raspberry-Pi-Web-Server\nhttp://www.vuplus-community.net/board/threads/howto-make-an-ftp-server-with-your-raspberry.7245/\nhttp://www.instructables.com/id/Raspberry-Pi-Web-Server/step9/Install-an-FTP-server/\nBT download server setup Install transmission-daemon\nsudo apt-get install transmission-daemon Modify config file\n$ cd /etc/transmission-daemon $ sudo cp settings.json settings.json.bak $ sudo vi settings.json #Change download folder \u0026#34;download-dir\u0026#34;: \u0026#34;/home/oopsmonk/BT-Download\u0026#34; #Accept connection from all ip address \u0026#34;rpc-whitelist\u0026#34;: \u0026#34;*.*.*.*\u0026#34; #Web GUI login account setting \u0026#34;rpc-username\u0026#34;: \u0026#34;oopsmonk\u0026#34; \u0026#34;rpc-password\u0026#34;: \u0026#34;web-login-pwd\u0026#34; \u0026#34;umask\u0026#34;: 2 umask change from 18 to umask: 2.\nThis will enable all users in the transmission group to also write to the file.\nCreate download folder and change permission for debian-transmission user.\n$ mkdir /home/oopsmonk/BT-Download\n$ chmod 777 /home/oopsmonk/BT-Download\nReload config\nsudo service transmission-daemon reload Login to Web GUI\nhttp://localhost:9091/transmission\nNginx proxy setup for BT server Why should use proxy??\nSome firewall allow connect to internet using 80 port only.\nIn this case, we can use proxy redirect 9091 to 80 port.\n$ sudo install nginx $ sudo service nginx stop $ sudo vi /etc/nginx/sites-available/default server{ #listen 80; ## listen for ipv4; this line is default and implied #listen [::]:80 default_server ipv6only=on; ## listen for ipv6 ... location /bt { proxy_pass http://127.0.0.1:9091/transmission; } ... } $ sudo service nginx start Test connection:\nhttp://localhost/bt/web/\nDo not forget the / in end of URL.\nReferences:\nSetting Up Transmission’s Web Interface\nLinux防健忘日誌No.69-Ubuntu 12.04 安裝及設定transmission-daemon\nUSB Wifi setup Check USB wifi driver $ sudo lsusb Bus 001 Device 002: ID 0424:9512 Standard Microsystems Corp. Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub Bus 001 Device 003: ID 0424:ec00 Standard Microsystems Corp. Bus 001 Device 004: ID 0b05:1786 ASUSTek Computer, Inc. USB-N10 802.11n Network Adapter [Realtek RTL8188SU] Bus 001 Device 005: ID 1a40:0101 Terminus Technology Inc. 4-Port HUB Bus 001 Device 006: ID 0bc2:5061 Seagate RSS LLC Here my wifi dongle is ASUS USB-N10.\nSupported wifi dongle list can find at http://elinux.org/RPi_VerifiedPeripherals#USB_Wi-Fi_Adapters\nWifi scan test $ sudo iwlist wlan0 scan | grep ESSID ESSID:\u0026#34;CH_Lee\u0026#34; ESSID:\u0026#34;iHome01\u0026#34; ESSID:\u0026#34;WALL-E\u0026#34; ESSID:\u0026#34;AndyStella\u0026#34; ESSID:\u0026#34;My home wifi\u0026#34; ESSID:\u0026#34;HC-SY\u0026#34; ESSID:\u0026#34;default\u0026#34; Configure /etc/network/interfaces auto wlan0 iface lo inet loopback iface eth0 inet dhcp allow-hotplug wlan0 iface wlan0 inet dhcp wpa-conf /etc/wpa_supplicant/wpa_supplicant.conf wpa-ssid \u0026#34;XXXXXX\u0026#34; wpa-psk \u0026#34;YYYYYY\u0026#34; iface default inet dhcp PPPoE setup Install pppoeconf $ sudo apt-get install pppoeconf $ sudo pppoeconf Input account and password to config PPPoE.\nSatrt DSL connection\n$ sudo pon dsl-provider Terminate connection\n$ sudo poff Connection status\n$ sudo plog or $ ifconfig ppp0 Run MOC issue Update: 2013/08/14\nWhen run moc get an error as bellow:\n$ mocp Running the server... Trying JACK... Trying ALSA... ALSA lib confmisc.c:768:(parse_card) cannot find card \u0026#39;0\u0026#39; ALSA lib conf.c:4241:(_snd_config_evaluate) function snd_func_card_driver returned error: No such file or directory ALSA lib confmisc.c:392:(snd_func_concat) error evaluating strings ALSA lib conf.c:4241:(_snd_config_evaluate) function snd_func_concat returned error: No such file or directory ALSA lib confmisc.c:1251:(snd_func_refer) error evaluating name ALSA lib conf.c:4241:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory ALSA lib conf.c:4720:(snd_config_expand) Evaluate error: No such file or directory ALSA lib pcm.c:2217:(snd_pcm_open_noupdate) Unknown PCM default Trying OSS... FATAL_ERROR: No valid sound driver! FATAL_ERROR: Server exited! Check if audio driver(snd_bcm2835) is not loaded\n$ lsmod Module Size Used by xt_TCPMSS 3119 1 xt_tcpmss 1301 1 xt_tcpudp 2087 1 iptable_mangle 1467 1 ip_tables 11482 1 iptable_mangle x_tables 16865 5 ip_tables,xt_tcpmss,xt_tcpudp,xt_TCPMSS,iptable_mangle pppoe 11317 2 pppox 2445 1 pppoe ppp_generic 25397 6 pppoe,pppox slhc 5679 1 ppp_generic snd_bcm2835 16304 0 snd_pcm 77560 1 snd_bcm2835 snd_page_alloc 5145 1 snd_pcm snd_seq 53329 0 snd_seq_device 6438 1 snd_seq snd_timer 19998 2 snd_pcm,snd_seq snd 58447 5 snd_bcm2835,snd_timer,snd_pcm,snd_seq,snd_seq_device leds_gpio 2235 0 led_class 3562 1 leds_gpio Check device permission.\n$ sudo ls -al /dev/snd/* crw-rw---T 1 root audio 116, 0 Aug 14 10:49 /dev/snd/controlC0 crw-rw---T 1 root audio 116, 16 Aug 14 10:49 /dev/snd/pcmC0D0p crw-rw---T 1 root audio 116, 1 Aug 14 10:49 /dev/snd/seq crw-rw---T 1 root audio 116, 33 Aug 14 10:49 /dev/snd/timer Ha! it\u0026rsquo;s a permission issue.\nChange permission:\n$ sudo chmod 666 /dev/snd/* Solved!\n","permalink":"https://oopsmonk.github.io/posts/2013-06-15-rpisetup/","summary":"Install Raspbian \u0026ldquo;wheezy\u0026rdquo; image Download image from Raspberry Pi offical website\nMount HOME to HDD Copy HOME data to disk $ sudo mkdir /media/new_home $ sudo mount /dev/sda1 /media/new_home $ sudo rsync -aXS /home/. /media/new_home/. $ sudo umount /media/new_home fstab #get disk UUID $ sudo blkid /dev/mmcblk0p1: SEC_TYPE=\u0026#34;msdos\u0026#34; LABEL=\u0026#34;boot\u0026#34; UUID=\u0026#34;936C-7122\u0026#34; TYPE=\u0026#34;vfat\u0026#34; /dev/mmcblk0p2: UUID=\u0026#34;c1198422-7a7c-4863-8a8f-45a1db26b4f2\u0026#34; TYPE=\u0026#34;ext4\u0026#34; /dev/sda1: UUID=\u0026#34;2cd990b5-6c27-4933-95d0-fd00b000fe77\u0026#34; TYPE=\u0026#34;ext4\u0026#34; #modify fstab $ echo \u0026#34;UUID=2cd880b5-6c27-4933-95d0-fd00b000fe77 /home ext4 defaults 0 2\u0026#34; | sudo tee --append /etc/fstab #mount HOMW without reboot.","title":"Raspberry Pi Setup"},{"content":"Create git.SHA1 property in build.xml file.\n\u0026lt;available file=\u0026#34;.git\u0026#34; type=\u0026#34;dir\u0026#34; property=\u0026#34;git.present\u0026#34;/\u0026gt; \u0026lt;target name=\u0026#34;git.info\u0026#34; description=\u0026#34;Store git info\u0026#34; if=\u0026#34;git.present\u0026#34;\u0026gt; \u0026lt;exec executable=\u0026#34;git\u0026#34; outputproperty=\u0026#34;git.SHA1\u0026#34; failifexecutionfails=\u0026#34;false\u0026#34; errorproperty=\u0026#34;\u0026#34;\u0026gt; \u0026lt;arg value=\u0026#34;log\u0026#34;/\u0026gt; \u0026lt;arg value=\u0026#34;--pretty=oneline\u0026#34;/\u0026gt; \u0026lt;arg value=\u0026#34;-n1\u0026#34;/\u0026gt; \u0026lt;/exec\u0026gt; \u0026lt;condition property=\u0026#34;git.version\u0026#34; value=\u0026#34;${git.SHA1}\u0026#34; else=\u0026#34;unknown\u0026#34;\u0026gt; \u0026lt;and\u0026gt; \u0026lt;isset property=\u0026#34;git.SHA1\u0026#34;/\u0026gt; \u0026lt;length string=\u0026#34;${git.SHA1}\u0026#34; trim=\u0026#34;yes\u0026#34; length=\u0026#34;0\u0026#34; when=\u0026#34;greater\u0026#34;/\u0026gt; \u0026lt;/and\u0026gt; \u0026lt;/condition\u0026gt; \u0026lt;echo message=\u0026#34;print git log : \u0026#34; /\u0026gt; \u0026lt;echo message=\u0026#34;${git.SHA1}\u0026#34; /\u0026gt; \u0026lt;/target\u0026gt; Reference:\nHow to lookup the latest git commit hash from an ant build script\n","permalink":"https://oopsmonk.github.io/posts/2013-06-13-getgitinfoinant/","summary":"Create git.SHA1 property in build.xml file.\n\u0026lt;available file=\u0026#34;.git\u0026#34; type=\u0026#34;dir\u0026#34; property=\u0026#34;git.present\u0026#34;/\u0026gt; \u0026lt;target name=\u0026#34;git.info\u0026#34; description=\u0026#34;Store git info\u0026#34; if=\u0026#34;git.present\u0026#34;\u0026gt; \u0026lt;exec executable=\u0026#34;git\u0026#34; outputproperty=\u0026#34;git.SHA1\u0026#34; failifexecutionfails=\u0026#34;false\u0026#34; errorproperty=\u0026#34;\u0026#34;\u0026gt; \u0026lt;arg value=\u0026#34;log\u0026#34;/\u0026gt; \u0026lt;arg value=\u0026#34;--pretty=oneline\u0026#34;/\u0026gt; \u0026lt;arg value=\u0026#34;-n1\u0026#34;/\u0026gt; \u0026lt;/exec\u0026gt; \u0026lt;condition property=\u0026#34;git.version\u0026#34; value=\u0026#34;${git.SHA1}\u0026#34; else=\u0026#34;unknown\u0026#34;\u0026gt; \u0026lt;and\u0026gt; \u0026lt;isset property=\u0026#34;git.SHA1\u0026#34;/\u0026gt; \u0026lt;length string=\u0026#34;${git.SHA1}\u0026#34; trim=\u0026#34;yes\u0026#34; length=\u0026#34;0\u0026#34; when=\u0026#34;greater\u0026#34;/\u0026gt; \u0026lt;/and\u0026gt; \u0026lt;/condition\u0026gt; \u0026lt;echo message=\u0026#34;print git log : \u0026#34; /\u0026gt; \u0026lt;echo message=\u0026#34;${git.SHA1}\u0026#34; /\u0026gt; \u0026lt;/target\u0026gt; Reference:\nHow to lookup the latest git commit hash from an ant build script","title":"Add Git SHA1 property in Apache ANT build.xml"},{"content":"nginx version: nginx/1.1.19, OS: Ubuntu12.04\nDefault nginx accepted body size limitation is 1MB.\nYou can add client_max_body_size in nginx.conf.\nThis parameter can put in http, server and location sections of configutation file.\nEnlarge body size to 10MB\nclient_max_body_size 10M Or just disable it\nclient_max_body_size 0 For example enlarge body size to 10MB\nAdd to http section:\n$ sudo vi /etc/nginx/nginx.conf http { ## # Basic Settings ## sendfile on; tcp_nopush on; tcp_nodelay on; keepalive_timeout 65; types_hash_max_size 2048; client_max_body_size 10M; # server_tokens off; # server_names_hash_bucket_size 64; # server_name_in_redirect off; include /etc/nginx/mime.types; default_type application/octet-stream; ... } Or modify server and location section\n$ sudo vi /etc/nginx/sites-available/default server { #listen 80; ## listen for ipv4; this line is default and implied #listen [::]:80 default ipv6only=on; ## listen for ipv6 client_max_body_size 10M; root /usr/share/nginx/www; index index.html index.htm; # Make site accessible from http://localhost/ server_name localhost; location / { # First attempt to serve request as file, then # as directory, then fall back to index.html try_files $uri $uri/ /index.html; # Uncomment to enable naxsi on this location # include /etc/nginx/naxsi.rules client_max_body_size 0; } location /doc/ { alias /usr/share/doc/; autoindex on; allow 127.0.0.1; deny all; } .... } Reload configuration:\n$ sudo service nginx reload Done!\n","permalink":"https://oopsmonk.github.io/posts/2013-06-05-nginxerror413/","summary":"nginx version: nginx/1.1.19, OS: Ubuntu12.04\nDefault nginx accepted body size limitation is 1MB.\nYou can add client_max_body_size in nginx.conf.\nThis parameter can put in http, server and location sections of configutation file.\nEnlarge body size to 10MB\nclient_max_body_size 10M Or just disable it\nclient_max_body_size 0 For example enlarge body size to 10MB\nAdd to http section:\n$ sudo vi /etc/nginx/nginx.conf http { ## # Basic Settings ## sendfile on; tcp_nopush on; tcp_nodelay on; keepalive_timeout 65; types_hash_max_size 2048; client_max_body_size 10M; # server_tokens off; # server_names_hash_bucket_size 64; # server_name_in_redirect off; include /etc/nginx/mime.","title":"Nginx Error - 413 Request Entity Too Large"},{"content":"Currently, AWS web console not provide folder downloading. We can use s3cmd or s3Browser for this purpose.\ns3Browser is a freeware Windows client for S3 and CloudFront.\ns3cmd download Bucket folder:\ns3cmd sync s3://bucketname/folder /local/folder For download files using s3Browser, here is a tutorial.\nUploading and Downloading Files to and from Amazon S3\n","permalink":"https://oopsmonk.github.io/posts/2013-05-28-aws-s3-folderdownload/","summary":"Currently, AWS web console not provide folder downloading. We can use s3cmd or s3Browser for this purpose.\ns3Browser is a freeware Windows client for S3 and CloudFront.\ns3cmd download Bucket folder:\ns3cmd sync s3://bucketname/folder /local/folder For download files using s3Browser, here is a tutorial.\nUploading and Downloading Files to and from Amazon S3","title":"AWS S3 Download Bucket Folder"},{"content":"WSGI Micro Framworks 這陣子一直在找適合的Micro Framwork玩第一次的Web Application.\n最後選擇用Bottle, 原因是:\nSingle file module, no dependencies with other library. Document 但是好不好用又是另一回事, 用了就知道..XD\n以下是由WSGI.org列出的Micro Framwork:\nbobo\nBobo is a light-weight framework. Its goal is to be easy to use and remember.\nBottle\nBottle is a fast and simple micro-framework for small web-applications. It offers request dispatching (Routes) with url parameter support, Templates, key/value Databases, a build-in HTTP Server and adapters for many third party WSGI/HTTP-server and template engines. All in a single file and with no dependencies other than the Python Standard Library.\nFlask\nFlask is a microframework for Python based on Werkzeug, Jinja 2 and good intentions. It inherits its high WSGI usage and compliance from Werkzeug.\nPyramid\nMerger of the Pylons and repoze.bfg projects, Pyramid is a minimalist web framework aiming at composability and making developers paying only for what they use.\nweb.py\nMakes web apps. A small RESTful library.\nMicro Framworks Battle Rank Framwork Point 1 Bottle 7 2 pesto 6 3 itty 4 4 flask, cgi+wsgiref 3 5 werkzeug 2 6 web.py 1 7 cherrypy 0 8 bobo -7 9 aspen.io -5 Reference :\nWeb Micro Framework Battle 1\nWeb Micro Framework Battle 2\n","permalink":"https://oopsmonk.github.io/posts/2013-05-27-pythonwebmicroframwork/","summary":"WSGI Micro Framworks 這陣子一直在找適合的Micro Framwork玩第一次的Web Application.\n最後選擇用Bottle, 原因是:\nSingle file module, no dependencies with other library. Document 但是好不好用又是另一回事, 用了就知道..XD\n以下是由WSGI.org列出的Micro Framwork:\nbobo\nBobo is a light-weight framework. Its goal is to be easy to use and remember.\nBottle\nBottle is a fast and simple micro-framework for small web-applications. It offers request dispatching (Routes) with url parameter support, Templates, key/value Databases, a build-in HTTP Server and adapters for many third party WSGI/HTTP-server and template engines.","title":"Web Micro Framework Battle"},{"content":" Headers (Setext and atx) Setext-style只有兩階也就是HTML語法裡的h1及h2 tag,-跟=的個數沒有限制.\natx-style共有6階, h1~h6.\n# This is H1. ## This is H2. ### This is H3. #### ... ###### This is H6. 除了階層較多之外, atx-style還可以使用Markdown syntax.\n###This is *H3* header. Output:\nThis is H3 header. Inline Formatting Basic Emphasis 斜體字: *, _ , 粗體字: **, __,\n*single asterisks* _single underscores_ **double asterisks** __double underscores__ Output:\nsingle asterisks\nsingle underscores\ndouble asterisks\ndouble underscores\nPandoc Inline strikeout, superscript and subscript ~~~deleted text~~~ H~2~O is a liquid. 2^10^ is 1024. Output:\nH~2~O is a liquid. 2^10^ is 1024. --- #### Math Pandoc可以使用LaTeX來表示數學式子, 可參考[Getting Started with LaTeX](http://www.maths.tcd.ie/~dwilkins/LaTeXPrimer/) ``` $a^2 = b^2 + c^2$ $x^{17} - 1$ $M^\\bot = \\{ f \\in V\u0026#39; : f(m) = 0 \\mbox{ for all } m \\in M \\}.$ $\\[ \\cos(\\theta + \\phi) = \\cos \\theta \\cos \\phi - \\sin \\theta \\sin \\phi \\]$ $\\[ |y - x| \u0026lt; \\delta \\]$ then $\\[ |f(y) - f(x)| \u0026lt; \\epsilon. \\]$ \\newcommand{\\tuple}[1]{\\langle #1 \\rangle} $\\tuple{a, b, c}$ ``` output: ``` $$a^2 = b^2 + c^2$$ $$x^{17} - 1$$ $$M^\\bot = \\{ f \\in V\u0026#39; : f(m) = 0 \\mbox{ for all } m \\in M \\}.$$ $$\\[ \\cos(\\theta + \\phi) = \\cos \\theta \\cos \\phi - \\sin \\theta \\sin \\phi \\]$$ $$\\[ |y - x| \u0026lt; \\delta \\]$ then $\\[ |f(y) - f(x)| \u0026lt; \\epsilon. \\]$$ $$\\newcommand{\\tuple}[1]{\\langle #1 \\rangle}\\tuple{a, b, c}$$ ``` ## Links ``` This is an automatic link \u0026lt;http://www.google.com\u0026gt;. This is [inline link](http://example.com/ \u0026#34;Title\u0026#34;) inline link with title. This is [inline link](http://example.com/ ) inline link without title attribute. This is [reference link ][ref] with ID. This is [reference link][] without ID. This is [Inline Internal link](#TOC). This is [Internal link]. [ref]: http://example.com/ [reference link]: http://www.google.com [Internal link]: #pandocs-markdown-reference ``` Output: This is an automatic link \u0026lt;http://www.google.com\u0026gt;. This is [inline link](http://example.com/ \u0026#34;Title\u0026#34;) inline link with title. This is [inline link](http://example.com/ ) inline link without title attribute. This is [reference link ][ref] with ID. This is [reference link][] without ID. This is [Inline Internal link](#TOC). This is [Internal link]. [ref]: http://example.com/ [reference link]: http://www.google.com [Internal link]: #pandocs-markdown-reference ## Images Markddown images sytax ``` ![](http://3.bp.bloGspot.com/-BLhmfBdELH0/UBT3uUd7r5I/AAAAAAAAADw/-rnn2kz5vjY/s220/oops_monk01_120.jpg \u0026#34;OopsMonk\u0026#34;) ![Alt text][pic2] [pic2]: http://3.bp.bloGspot.com/-BLhmfBdELH0/UBT3uUd7r5I/AAAAAAAAADw/-rnn2kz5vjY/s220/oops_monk01_120.jpg ``` Output: ![](http://3.bp.bloGspot.com/-BLhmfBdELH0/UBT3uUd7r5I/AAAAAAAAADw/-rnn2kz5vjY/s220/oops_monk01_120.jpg \u0026#34;OopsMonk\u0026#34;) ![Alt text][pic2] [pic2]: http://3.bp.bloGspot.com/-BLhmfBdELH0/UBT3uUd7r5I/AAAAAAAAADw/-rnn2kz5vjY/s220/oops_monk01_120.jpg --- Markdown的貼圖不能指定圖片大小, 可以用HTML來放圖片. ``` \u0026lt;img src=\u0026#34;http://3.bp.bloGspot.com/-BLhmfBdELH0/UBT3uUd7r5I/AAAAAAAAADw/-rnn2kz5vjY/s220/oops_monk01_120.jpg\u0026#34; width=\u0026#34;50\u0026#34;\u0026gt; ``` Output: ## Embedded Video Markdown沒有嵌入影片的語法, 需要使用HTML. ``` \u0026lt;iframe src=\u0026#34;http://embed.ted.com/talks/lang/zh-tw/ken_robinson_how_to_escape_education_s_death_valley.html\u0026#34; width=\u0026#34;560\u0026#34; height=\u0026#34;315\u0026#34; frameborder=\u0026#34;0\u0026#34; scrolling=\u0026#34;no\u0026#34; webkitAllowFullScreen mozallowfullscreen allowFullScreen\u0026gt;\u0026lt;/iframe\u0026gt; ``` Output: ## Code block ### Basic Code block ``` This is one line code block `function()` ``There is a literal backtick (`) here.`` Bellow is a code block: if(x == 0){ printf(\u0026#34;x = 0\u0026#34;); else printf(\u0026#34;x =/= 0\u0026#34;); ``` Output: This is one line code block `function()` ``There is a literal backtick (`) here.`` Bellow is a code block: if(x == 0){ printf(\u0026#34;x = 0\u0026#34;); else printf(\u0026#34;x =/= 0\u0026#34;); --- ### Pandoc Code Block #### Force code block(more then three `~`) if (a \u0026gt; 3) { moveShip(5 * gravity, DOWN); } Output ~~~~~~~ if (a \u0026gt; 3) { moveShip(5 * gravity, DOWN); } ~~~~~~~ --- #### Code Syntax highlight ~~~ ```python import os import sys def application(env, start_response): start_response(\u0026#39;200 OK\u0026#39;, [(\u0026#39;Content-Type\u0026#39;,\u0026#39;text/html\u0026#39;)]) return \u0026#34;Hello WSGI!!\u0026#34; ``` ~~~ Output: ```python import os import sys def application(env, start_response): start_response(\u0026#39;200 OK\u0026#39;, [(\u0026#39;Content-Type\u0026#39;,\u0026#39;text/html\u0026#39;)]) return \u0026#34;Hello WSGI!!\u0026#34; ``` --- #### Line Number ~~~~~~ ~~~~ {#pycode .python .numberLines startFrom=\u0026#34;10\u0026#34;} import os import sys def application(env, start_response): start_response(\u0026#39;200 OK\u0026#39;, [(\u0026#39;Content-Type\u0026#39;,\u0026#39;text/html\u0026#39;)]) return \u0026#34;Hello WSGI!!\u0026#34; ~~~~ ~~~~~~ Output: ~~~~ {#pycode .python .numberLines startFrom=\u0026#34;10\u0026#34;} import os import sys def application(env, start_response): start_response(\u0026#39;200 OK\u0026#39;, [(\u0026#39;Content-Type\u0026#39;,\u0026#39;text/html\u0026#39;)]) return \u0026#34;Hello WSGI!!\u0026#34; ~~~~ ## Blockquotes ``` \u0026gt; This is a block quote. \u0026gt; \u0026gt; \u0026gt; A block quote within a block quote. \u0026gt; \u0026gt; \u0026gt; \u0026gt; \u0026gt; Nets. ``` Output: \u0026gt; This is a block quote. \u0026gt; \u0026gt; \u0026gt; A block quote within a block quote. \u0026gt; \u0026gt; \u0026gt; \u0026gt; \u0026gt; Nets. ## Lists ### Basic list #### Unordered(Bulleted) ``` * fruits + apples - macintosh - red delicious + pears + peaches * vegetables + brocolli + chard ``` Output: * fruits + apples - macintosh - red delicious + pears + peaches * vegetables + brocolli --- #### Ordered (Numbered) ``` 1. list1. 1. list2. 1. list3. 1. list4. ``` Output: 1. list1. 1. list2. 1. list3. 1. list4. ### Pandoc List Extension #### startnum ``` 5) Five i. 5-1 i. 5-2 5) Six iii. 6-1 * 6-1-1 * 6-1-2 iii. 6-2 iii. 6-3 5) Seven a. 7-1 i. 7-2 #. 7-2-1 #. 7-2-2 i. 7-3 \u0026lt;!-- --\u0026gt; 5) Five again. ``` Output: 5) Five i. 5-1 i. 5-2 5) Six iii. 6-1 * 6-1-1 * 6-1-2 iii. 6-2 iii. 6-3 5) Seven a. 7-1 i. 7-2 #. 7-2-1 #. 7-2-2 i. 7-3 \u0026lt;!-- --\u0026gt; 5) Five again. --- #### Definition lists 語法中為`:`與`Definition`之間為 `TAB` 鍵. ``` Term 1 : Definition 1 Term 2 with *inline markup* : Definition 2 { some code, part of Definition 2 } Third paragraph of definition 2. ``` Output: Term 1 : Definition 1 Term 2 with *inline markup* : Definition 2 { some code, part of Definition 2 } Third paragraph of definition 2. ---- 另一種寫法, 裡面無法放入code block. ``` Term 1 ~ Definition 1 Term 2 ~ Definition 2a ~ Definition 2b ``` Output: Term 1 ~ Definition 1 Term 2 ~ Definition 2a ~ Definition 2b --- #### Example lists ``` (@) My first example will be numbered (1). (@) My second example will be numbered (2). Explanation of examples. (@) My third example will be numbered (3). (@good) This is a good example. As (@good) illustrates, ... ``` Output: (@) My first example will be numbered (1). (@) My second example will be numbered (2). Explanation of examples. (@) My third example will be numbered (3). (@good) This is a good example. As (@good) illustrates, ... ## Pandoc Footnotes 註解會出現在文章的最後面. Here is an inline note.^[Inlines notes are easier to write, since you don\u0026#39;t have to pick an identifier and move down to type the note.] Here is a footnote reference,^[^[^1]^]^ and another.[^longnote] [^1]: Here is the footnote. [^longnote]: Here\u0026#39;s one with multiple blocks. Subsequent paragraphs are indented to show that they belong to the previous footnote. { some.code } The whole paragraph can be indented, or just the first line. In this way, multi-paragraph footnotes work like multi-paragraph list items. This paragraph won\u0026#39;t be part of the note, because it isn\u0026#39;t indented. Output: Here is an inline note.^[Inlines notes are easier to write, since you don\u0026#39;t have to pick an identifier and move down to type the note.] Here is a footnote reference,^[^[^1]^]^ and another.[^longnote] [^1]: Here is the footnote. [^longnote]: Here\u0026#39;s one with multiple blocks. Subsequent paragraphs are indented to show that they belong to the previous footnote. { some.code } The whole paragraph can be indented, or just the first line. In this way, multi-paragraph footnotes work like multi-paragraph list items. This paragraph won\u0026#39;t be part of the note, because it isn\u0026#39;t indented. ## Pandoc Table 標準的Markdown沒有實現表格的標示. ### Simple tables Right Left Center Default ------- ------ ---------- ------- 12 12 12 12 123 123 123 123 1 1 1 1 Output: Right Left Center Default ------- ------ ---------- ------- 12 12 12 12 123 123 123 123 1 1 1 1 --- ### Multiline tables -------------------------- Centered Default Right Left Header Aligned Aligned Aligned ----------- ------- --------------- ------------------------- First row 12.0 Example of a row that spans multiple lines. Second row 5.0 Here\u0026#39;s another one. Note the blank line between rows. -------------------------- Output: -------------------------- Centered Default Right Left Header Aligned Aligned Aligned ----------- ------- --------------- ------------------------- First row 12.0 Example of a row that spans multiple lines. Second row 5.0 Here\u0026#39;s another one. Note the blank line between rows. -------------------------- --- ----------- ------- --------------- ------------------------- First row 12.0 Example of a row that spans multiple lines. Second row 5.0 Here\u0026#39;s another one. Note the blank line between rows. ----------- ------- --------------- ------------------------- Output: ----------- ------- --------------- ------------------------- First row 12.0 Example of a row that spans multiple lines. Second row 5.0 Here\u0026#39;s another one. Note the blank line between rows. ----------- ------- --------------- ------------------------- --- ### Grid tables Grid table syntax: : Sample grid table. +---------------+---------------+--------------------+ | Fruit | Price | Advantages | +===============+===============+====================+ | Bananas | $1.34 | - built-in wrapper | | | | - bright color | +---------------+---------------+--------------------+ | Oranges | $2.10 | - cures scurvy | | | | - tasty | +---------------+---------------+--------------------+ Output: : Sample grid table. +---------------+---------------+--------------------+ | Fruit | Price | Advantages | +===============+===============+====================+ | Bananas | $1.34 | - built-in wrapper | | | | - bright color | +---------------+---------------+--------------------+ | Oranges | $2.10 | - cures scurvy | | | | - tasty | +---------------+---------------+--------------------+ **This is end of article, show defined footnotes as below:** ","permalink":"https://oopsmonk.github.io/posts/2013-05-23-pandocmarkdownref/","summary":"Headers (Setext and atx) Setext-style只有兩階也就是HTML語法裡的h1及h2 tag,-跟=的個數沒有限制.\natx-style共有6階, h1~h6.\n# This is H1. ## This is H2. ### This is H3. #### ... ###### This is H6. 除了階層較多之外, atx-style還可以使用Markdown syntax.\n###This is *H3* header. Output:\nThis is H3 header. Inline Formatting Basic Emphasis 斜體字: *, _ , 粗體字: **, __,\n*single asterisks* _single underscores_ **double asterisks** __double underscores__ Output:\nsingle asterisks\nsingle underscores\ndouble asterisks\ndouble underscores\nPandoc Inline strikeout, superscript and subscript ~~~deleted text~~~ H~2~O is a liquid.","title":"Pandoc's Markdown Reference"},{"content":"Install uWSGI Configure uWSGI $ sudo apt-get install python-dev python-pip $ sudo pip uwsgi ################# uWSGI configuration ################# pcre = False kernel = Linux malloc = libc execinfo = False ifaddrs = True ssl = True matheval = False zlib = True locking = pthread_mutex plugin_dir = . timer = timerfd yaml = True json = False filemonitor = inotify routing = False debug = False zeromq = False capabilities = False xml = expat event = epoll ############## end of uWSGI configuration ############# *** uWSGI is ready, launch it with /usr/local/bin/uwsgi *** Successfully installed uwsgi Cleaning up... $ Test uWSGI Create test file called hello.py:\ndef application(env, start_response): start_response(\u0026#39;200 OK\u0026#39;, [(\u0026#39;Content-Type\u0026#39;,\u0026#39;text/html\u0026#39;)]) return \u0026#34;Hello WSGI!!\u0026#34; Run uWSGI:\nuwsgi --http :8000 --wsgi-file hello.py Open browser connect on port 8000.\nhttp://localhost:8000 Install Nginx Configure nginx $ sudo apt-get install nginx-full The configure file path : /etc/nginx/sites-enabled/default\nAdd your site in nginx configure file.\nlocation /wsgi/ { uwsgi_pass 127.0.0.1:8001; include uwsgi_params; } We use localhost port 8001 for uwsgi protocol, and 80 port for nginx.\nRun uwsgi and start nginx.\n$ uwsgi --socket :8001 --wsgi-file hello.py $ sudo service nginx start Test your web site:\nhttp://your-ip/wsgi/ or\nhttp://localhost/wsgi/ Ref:\nuWSGI Tutorial - Django and nginx\nWSGI using uWSGI and nginx on Ubuntu 12.04 (Precise Pangolin)\n","permalink":"https://oopsmonk.github.io/posts/2013-05-21-usinguwsgi/","summary":"Install uWSGI Configure uWSGI $ sudo apt-get install python-dev python-pip $ sudo pip uwsgi ################# uWSGI configuration ################# pcre = False kernel = Linux malloc = libc execinfo = False ifaddrs = True ssl = True matheval = False zlib = True locking = pthread_mutex plugin_dir = . timer = timerfd yaml = True json = False filemonitor = inotify routing = False debug = False zeromq = False capabilities = False xml = expat event = epoll ############## end of uWSGI configuration ############# *** uWSGI is ready, launch it with /usr/local/bin/uwsgi *** Successfully installed uwsgi Cleaning up.","title":"uWSGI \u0026 Nginx on Ubuntu"},{"content":"Markup Language 寫文件或blog最困擾的就是排版, 大略看一下目前較流行的Markdown \u0026amp; reStructuredText, 決定用Markdown來寫, rst給我的感覺就是要再學另一種語言, 雖然強大, 但我只要夠用就好, 必竟都有人用Markdown寫書了 XD.\nMarkdown Setup 目前是用Vim + Pandoc來寫Markdown, 網路上也有Web editor, 或是windows平台的Markdownpad, 但Web用起來不順手, Markdownpad不能跨平台. 用Vim麻煩的是preview, 寫完要手動用Pandoc轉成html, 之後直接將轉出來的html, 直接貼到blogger.\n一般沒有CSS的用法:\n$ pandoc README.md -o out.html 加入CSS依文件的方法是:\n$ pandoc -c markdown.css README.md -o out.html 但是會有一個問題, 貼上blogger時會無法正常顯示, 原因在於html裡是這樣寫的:\n\u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;markdown.css\u0026quot; type=\u0026quot;text/css\u0026quot; /\u0026gt; 後來想到了一個workaround, 用-H參數將CSS放入Header, 但也不是直接帶入, 需要將一般的CSS file用style tag包起來, 如下:\n\u0026lt;style type=\u0026quot;text/css\u0026quot;\u0026gt; Your CSS syntax.... \u0026lt;/style\u0026gt; 另存成pandoc-markdown.css, 如此才是真正的__fully standalone__.\n$ pandoc -H pandoc-markdown.css README.md -o out.html Vim Tips 修改vimrc將*.md標示為Markdown格式, 存檔自動產生HTML檔案.\n\u0026#34; Markdown extention autocmd BufRead,BufNewFile *.md set filetype=markdown \u0026#34; Auto Pandoc function function! AutoPandoc() \u0026#34;check if pandoc exist if filereadable(\u0026#34;/usr/bin/pandoc\u0026#34;) \u0026#34; get current directory path and append CSS file let l:csspath=expand(\u0026#34;%:p:h\u0026#34;).\u0026#34;/pandoc-markdownpad-github.css\u0026#34; let l:outPut=expand(\u0026#34;%:p:h\u0026#34;).\u0026#34;/out.html\u0026#34; if filereadable(l:csspath) \u0026#34;remove old output if filereadable(l:outPut) let l:rmOut=\u0026#34;!rm -rf \u0026#34;.l:outPut.\u0026#34; \u0026amp;\u0026amp; sync\u0026#34; silent execute l:rmOut endif \u0026#34; run command let l:runCmd=\u0026#34;!pandoc -H \u0026#34;.l:csspath.\u0026#34; -s \u0026#34;.expand(\u0026#34;%:p\u0026#34;).\u0026#34; -o \u0026#34;.l:outPut echo \u0026#34;Auto generated HTML at \u0026#34;.l:outPut silent execute l:runCmd endif endif endfunction \u0026#34;Audo gen html for markdown autocmd BufWritePost *.markdown,*md call AutoPandoc() Conclusion 不用煩惱排版的問題, Blogger與Evernote排版不會差太多.\n可以用Git來做version control 及 backup.\n簡潔有力, 語法簡單.\nVim也有人做realtime preview的plug-in: vim-instant-markdown, 但我覺得沒有即時preview的需求.\n圖片使用Markdown語法無法調整大小, 可以使用HTML來放圖片.\n\u0026lt;img src=\u0026quot;http://3.bp.bloGspot.com/-BLhmfBdELH0/UBT3uUd7r5I/AAAAAAAAADw/-rnn2kz5vjY/s220/oops_monk01_120.jpg\u0026quot; width=\u0026quot;100\u0026quot;\u0026gt;\n影片也是用HTML, 以TEDTalk為例:\n\u0026lt;iframe src=\u0026quot;http://embed.ted.com/talks/lang/zh-tw/ken_robinson_how_to_escape_education_s_death_valley.html\u0026quot;\nwidth=\u0026quot;560\u0026quot; height=\u0026quot;315\u0026quot; frameborder=\u0026quot;0\u0026quot; scrolling=\u0026quot;no\u0026quot; webkitAllowFullScreen mozallowfullscreen allowFullScreen\u0026gt;\u0026lt;/iframe\u0026gt;\n","permalink":"https://oopsmonk.github.io/posts/2013-05-21-aboutmarkup/","summary":"Markup Language 寫文件或blog最困擾的就是排版, 大略看一下目前較流行的Markdown \u0026amp; reStructuredText, 決定用Markdown來寫, rst給我的感覺就是要再學另一種語言, 雖然強大, 但我只要夠用就好, 必竟都有人用Markdown寫書了 XD.\nMarkdown Setup 目前是用Vim + Pandoc來寫Markdown, 網路上也有Web editor, 或是windows平台的Markdownpad, 但Web用起來不順手, Markdownpad不能跨平台. 用Vim麻煩的是preview, 寫完要手動用Pandoc轉成html, 之後直接將轉出來的html, 直接貼到blogger.\n一般沒有CSS的用法:\n$ pandoc README.md -o out.html 加入CSS依文件的方法是:\n$ pandoc -c markdown.css README.md -o out.html 但是會有一個問題, 貼上blogger時會無法正常顯示, 原因在於html裡是這樣寫的:\n\u0026lt;link rel=\u0026quot;stylesheet\u0026quot; href=\u0026quot;markdown.css\u0026quot; type=\u0026quot;text/css\u0026quot; /\u0026gt; 後來想到了一個workaround, 用-H參數將CSS放入Header, 但也不是直接帶入, 需要將一般的CSS file用style tag包起來, 如下:\n\u0026lt;style type=\u0026quot;text/css\u0026quot;\u0026gt; Your CSS syntax.... \u0026lt;/style\u0026gt; 另存成pandoc-markdown.css, 如此才是真正的__fully standalone__.\n$ pandoc -H pandoc-markdown.css README.md -o out.","title":"About Markup"},{"content":"O.S. : Ubuntu12.04 LTS\nOpenNMS Version : 1.10.7\nOpenNMS base on TMN \u0026amp; FCAPS network management models.\nOpenNMS Block Diagram Discovery \u0026amp; Monitor daemons Eventd\nEvent handling daemon\nConfiguration files:\neventconf.xml -\u0026gt; Defines the UEI (Universal Event Identifiers).\neventd-configuration.xml -\u0026gt; Defines operating parameters for eventd such as timeouts, listener threads and listener port.\nevents-archiver-configuation.xml -\u0026gt; Configuration for event archive daemon.\nevents.archiver.properties -\u0026gt; Fine tune events archive subsystem.\netc/events/*.xml -\u0026gt; Vendor UEI define files.\nListening \u0026ldquo;eventsConfigChange\u0026rdquo; event.\nDiscovery (discovery-configuration.xml)\nDiscovery service implement the Singleton pattern.\nListening events:\ndiscPause, interfaceDeleted, discResume, nodeGainedInterface, discoveryConfigChange and reloadDaemonConfig.\nCapsd (Capabilities daemon, capsd-configuration.xml)\nNotified by the discovery process when a new node is discovered, the polls for all the capabilities for this node and loading the data collected into the database.\nListening events:\ndeleteService, changeService, deleteInterface, newSuspect, froceRescan, addInterface, nodeDeleted, addNode, updateServer, nodeAdded, duplicateNodeDeleted, deleteNode and updateService.\nCollectd (collectd-configuration.xml)\nResponsible for gathering and storing data from various sources, including SNMP, JMX, HTTP and NSClient.\nListening events:\nnodeGainedService, primarySnmpInterfaceChanged, reinitializePrimarySnmpInterface, interfaceReparented, nodeDeleted, duplicateNodeDeleted, interfaceDeleted, serviceDeleted, schedOutagesChanged, configureSNMP, thresholdConfigChange, reloadDaemonConfig and nodeCategoryMembershipChanged.\nPoller (poller-configuration.xml)\nPolling services, including ICMP, DNS, FTP, HTTP, HTTPS, SSH, MySQL\u0026hellip;.\nListening events:\nnodeGaineService, serviceDeleted, interfaceReparented, nodeDeleted, nodeLabelChanged, duplicateNodeDeleted, interfaceDeleted, suspendPollingService, resumePollingService, schedOutagesChanged, demandPollService, thresholdConfigChange, assetInfoChanged and nodeCategoryMembershipChanged.\nRTC (Real-Time Collector)\nThe RTC initializes its data from the database when it comes up then subscribes to the events subsystem to receive events of interest to keep the data up-to-date.\nListening events:\nnodeGainedService, nodeLostService, interfaceDown, nodeDown, nodeUp, nodeCategoryMembershipChanged, interfaceUp, nodeRegainedService, serviceDeleted, serviceunmanaged, interfaceReparented, subscribe, unsubscribe and assetInfoChanged.\nNote:\nThere are two major ways that OpenNMS gathers data about the network.\nThe first is through polling. Processes called monitors connect to a network resource and perform a simple test to see if the resource is responding correctly. If not, events are generated.\nThe second is through data collection using collectors. Currently, the only collector is for SNMP data.\nCollectd record SNMP data to RRDTool in /share/rrd/snmp/NodeID/*, Ex: tcpOutSegs.jrb, icmpInEchos.jrb, tcpInSegs.jrb, ifInOctets.jrb, ifoutOctets.jrb\u0026hellip;\nPoller record Service data to RRDTool in /share/rrd/response/IP/*, Ex: icmp.jrb ssh.jrd\u0026hellip;\nOpenNMS configuration files:\nhttp://www.opennms.org/wiki/Configuration_File_Index\nDiscovery \u0026amp; Monitor Flow Here is the event flow when press \u0026ldquo;Save and Restart Discovery\u0026rdquo; button on WebGUI.\nReferences :\nWhite Paper: Project OpenNMS\nThe architecture of OpenNMS\n論OpenNMS 在 SUSE linux 之應用\n","permalink":"https://oopsmonk.github.io/posts/2013-02-03-opennmsarchitectureintroduction/","summary":"O.S. : Ubuntu12.04 LTS\nOpenNMS Version : 1.10.7\nOpenNMS base on TMN \u0026amp; FCAPS network management models.\nOpenNMS Block Diagram Discovery \u0026amp; Monitor daemons Eventd\nEvent handling daemon\nConfiguration files:\neventconf.xml -\u0026gt; Defines the UEI (Universal Event Identifiers).\neventd-configuration.xml -\u0026gt; Defines operating parameters for eventd such as timeouts, listener threads and listener port.\nevents-archiver-configuation.xml -\u0026gt; Configuration for event archive daemon.\nevents.archiver.properties -\u0026gt; Fine tune events archive subsystem.\netc/events/*.xml -\u0026gt; Vendor UEI define files.","title":"OpenNMS Architecture Introduction (Discovery \u0026 Monitor)"},{"content":"結束上份工作後, 不想閒著, 也就開始找新\u0026quot;玩具\u0026quot;, 做麵包好像滿有趣的, 又不用出門可以在家陪小朋友,於是爬了2~3天的文章,了解需要的東西.\nGoogle什麼是yeast(Active dry, Instant dry, Fresh)?\n什麼是麵粉(高筋, 中筋, 低筋, 法國粉)?\n什麼是麵糰(擴展, 完成)?\n什麼是揉麵?\n天真的以為\u0026quot;吐司\u0026quot;很簡單,麵糰整好丟進烤模..done.\n結果烤到第五條吐司, 才__接近滿模__.\n失敗品之一:\n接著白吐司太無聊了, 所以做了其它嚐試\n全麥鮪魚麵包 高粉 270g 全麥粉 30g Instant dry 3/4t 奶油 20g 塩 1/2t 糖 20g 水 185g 整形參考: 蒔蘿鮪魚麵包\n海蒂的白麵包 配方跟做法參考 【肉桂打噴嚏】海蒂的白麵包\n全麥豆漿枸杞葡萄乾 高粉 270g 全麥粉 30g Instant dry 3/4t 奶油 20g 塩 1/2t 糖 20g 豆漿 185g 枸杞 + 葡萄乾 適量. No-Knead Bread 做了這些後, 深深感到\u0026hellip;\n萬能的雙手真的累人又吵, 尤其吐司要揉到完成階段.\n再上鄰居來關切說: \u0026ldquo;你家是不是最近在釘東西?\u0026rdquo;\u0026hellip;XD\n於是開始Google解決辦法..\n沒想到真的有人研發出No-Knead Bread\u0026hellip;OMG\n不過缺點是要\u0026quot;長時間發酵\u0026quot;, 後來又改善了長時間發酵的缺點:\nSpeedy No-Knead Bread\n於是No-Knead Bread成了目前主要的做法\n優點:\n免揉 == 不累沒噪音 麵糰不加奶油 and 糖, 感覺較健康. 我愛歐包的脆皮及咬勁 缺點:\n麵糰水份高, 不易操作.\n使用陶鍋試了這個方法5次後, 覺得缺點還可以接受, 反正自己吃不用做美美的..XD\n麵糰配方:\n高粉 200g Instant dry 1/8t 塩 1/4t 水 170~175g 今天特別做了一個大size的:\n蜂蜜乾果全麥歐包, 乾果是葡萄乾+核桃\n整形再發酵60分鐘就入烤箱了, 烤箱中的大陶鍋, 上色時表皮的乾果烤焦了..\n出爐几分鐘後還量了一下, 沒想到裡面還有90几度的高溫@@..\n","permalink":"https://oopsmonk.github.io/posts/2012-11-30-baking2012/","summary":"結束上份工作後, 不想閒著, 也就開始找新\u0026quot;玩具\u0026quot;, 做麵包好像滿有趣的, 又不用出門可以在家陪小朋友,於是爬了2~3天的文章,了解需要的東西.\nGoogle什麼是yeast(Active dry, Instant dry, Fresh)?\n什麼是麵粉(高筋, 中筋, 低筋, 法國粉)?\n什麼是麵糰(擴展, 完成)?\n什麼是揉麵?\n天真的以為\u0026quot;吐司\u0026quot;很簡單,麵糰整好丟進烤模..done.\n結果烤到第五條吐司, 才__接近滿模__.\n失敗品之一:\n接著白吐司太無聊了, 所以做了其它嚐試\n全麥鮪魚麵包 高粉 270g 全麥粉 30g Instant dry 3/4t 奶油 20g 塩 1/2t 糖 20g 水 185g 整形參考: 蒔蘿鮪魚麵包\n海蒂的白麵包 配方跟做法參考 【肉桂打噴嚏】海蒂的白麵包\n全麥豆漿枸杞葡萄乾 高粉 270g 全麥粉 30g Instant dry 3/4t 奶油 20g 塩 1/2t 糖 20g 豆漿 185g 枸杞 + 葡萄乾 適量. No-Knead Bread 做了這些後, 深深感到\u0026hellip;\n萬能的雙手真的累人又吵, 尤其吐司要揉到完成階段.","title":"Baking 2012"},{"content":"boot_cm9.img file from mk802_legacy-compatibility_v1.zip\nDevice: Rikomagic MK802\nScript files : Split_bootimg.pl , extract-ikconfig ( in {kernel_source}/script )\nSplit boot.img Copy boot_cm9.img, Split_bootimg.pl, extract-ikconfig into \u0026lsquo;split_boot\u0026rsquo;\n$ mkdir split_boot $ cd split_boot $ ./split_bootimg.pl boot_cm9.img Page size: 2048 (0x00000800) Kernel size: 8094708 (0x007b83f4) Ramdisk size: 178940 (0x0002bafc) Second size: 0 (0x00000000) Board name: Command line: console=ttyS0,115200 rw init=/init loglevel=8 Writing boot_cm9.img-kernel ... complete. Writing boot_cm9.img-ramdisk.gz ... complete. Get kernel image (boot_cm9.img-kernel) and ramdisk (boot_cm9.img-ramdisk.gz)\nExtract kernel config $ dd if=boot_cm9.img-kernel of=dd_uImage bs=1024 skip=1 7903+1 records in 7903+1 records out 8093684 bytes (8.1 MB) copied, 0.0178518 s, 453 MB/s $./extract-ikconfig dd_uImage \u0026gt; kernel_config Extract ramdisk $ mkdir ramdisk $ cd ramdisk $ gzip -dc ../boot_cm9.img-ramdisk.gz | cpio -i 6677 blocks $ tree . . ├── data ├── default.prop ├── dev ├── init ├── init.goldfish.rc ├── initlogo.rle ├── init.rc ├── init.sun4i.rc ├── init.sun4i.usb.rc ├── proc ├── sbin │ ├── adbd │ └── ueventd -\u0026gt; ../init ├── sys ├── system ├── ueventd.goldfish.rc ├── ueventd.rc └── ueventd.sun4i.rc Reference:\nHOWTO: Unpack, Edit, and Re-Pack Boot Images\n","permalink":"https://oopsmonk.github.io/posts/2012-09-12-how2splitbootimage/","summary":"boot_cm9.img file from mk802_legacy-compatibility_v1.zip\nDevice: Rikomagic MK802\nScript files : Split_bootimg.pl , extract-ikconfig ( in {kernel_source}/script )\nSplit boot.img Copy boot_cm9.img, Split_bootimg.pl, extract-ikconfig into \u0026lsquo;split_boot\u0026rsquo;\n$ mkdir split_boot $ cd split_boot $ ./split_bootimg.pl boot_cm9.img Page size: 2048 (0x00000800) Kernel size: 8094708 (0x007b83f4) Ramdisk size: 178940 (0x0002bafc) Second size: 0 (0x00000000) Board name: Command line: console=ttyS0,115200 rw init=/init loglevel=8 Writing boot_cm9.img-kernel ... complete. Writing boot_cm9.img-ramdisk.gz ... complete. Get kernel image (boot_cm9.img-kernel) and ramdisk (boot_cm9.","title":"How to split boot.img and get kernel config"},{"content":"Get extract-ikconfig in kernel-source/scripts/ $mkdir extreact-uImage $cd extreact-uImage $cp {kernel-source}/scripts/extract-ikconfig . Dump uImage skip 1024 bytes $cp {uImage/what/you/want} uImage $dd if=uImage of=dd_uImage bs=1024 skip=1 $./extract-ikconfig dd_uImage \u0026gt; config ","permalink":"https://oopsmonk.github.io/posts/2012-08-21-how2extractkernelconfigfromuimage/","summary":"Get extract-ikconfig in kernel-source/scripts/ $mkdir extreact-uImage $cd extreact-uImage $cp {kernel-source}/scripts/extract-ikconfig . Dump uImage skip 1024 bytes $cp {uImage/what/you/want} uImage $dd if=uImage of=dd_uImage bs=1024 skip=1 $./extract-ikconfig dd_uImage \u0026gt; config ","title":"How to extract kernel config from uImage"},{"content":"XBMC announced XBMC for Android.\n不過並不打算放上Google Play, 需要自行compile及打包, 方法可參考:\nBuild XBMC for Android on lubuntu 12.04\n在此記錄一下目前在MK802跑起來的情況.\nMK802介紹可參考:\nAndroid 4.0 mini PC 最小的主機MK802\nCPU : Allwinner A10 - ARM Cortex A8 SoC\nGPU : ARM Mali 400\nRAM : 1GB\n以公定價$79USD及讓人跌破眼鏡的入手價, 拿來玩真是夠本了.\n這次是要用Android 手機來控制 XBMC, 因為MK802沒有IR只能用滑鼠操作上有些不便.\nGoogle Play上有Official XBMC Remote可直接下載來用.\n中文設定: 切換到Appearance -\u0026gt; Setting -\u0026gt; International -\u0026gt; Language\n為了能透過HTTP連到MK802的XBMC, 需要將\u0026quot;網站伺服\u0026quot;的功能打開, 設定port number\n接著查看IP, 設定手機上的XBMC Remote如下:\n連線成功就會出現控制選項\n用手機上\u0026quot;Remote Control\u0026quot; Navigation, 測試播放USB裡的影片\n影片開播後選手機上的\u0026quot;Now Playing\u0026quot;, 可以做seek, FF/FB功能, 音量控制是使用手機上的音量鍵.\n(當初還因為無法控制音量煩腦, 沒想到直接用就可以\u0026hellip;冏)\n播放online radio, 用的是SKY.FM, 可以到\u0026quot;附加元件\u0026quot;中下載安裝.\n音樂Full screen播放, 可以看到背景的GL動畫還可以跑到31fps, 似乎還OK.\n天氣+音樂播放, 後面的GL動畫還是正常顯示, 並不是靜態的.\n後記:\n透過附加元件下載安裝的YouTube及Time.com無法正常播放video. 很吃記憶體大約要吃掉80MB. 研究XBMC在Android 如何implement, 應該是很有趣的.必竟XBMC是用自己的GUI系統, 還要克服Bionic libc在dlopen的不足之處. ","permalink":"https://oopsmonk.github.io/posts/2012-07-29-xbmc4androidonmk802/","summary":"XBMC announced XBMC for Android.\n不過並不打算放上Google Play, 需要自行compile及打包, 方法可參考:\nBuild XBMC for Android on lubuntu 12.04\n在此記錄一下目前在MK802跑起來的情況.\nMK802介紹可參考:\nAndroid 4.0 mini PC 最小的主機MK802\nCPU : Allwinner A10 - ARM Cortex A8 SoC\nGPU : ARM Mali 400\nRAM : 1GB\n以公定價$79USD及讓人跌破眼鏡的入手價, 拿來玩真是夠本了.\n這次是要用Android 手機來控制 XBMC, 因為MK802沒有IR只能用滑鼠操作上有些不便.\nGoogle Play上有Official XBMC Remote可直接下載來用.\n中文設定: 切換到Appearance -\u0026gt; Setting -\u0026gt; International -\u0026gt; Language\n為了能透過HTTP連到MK802的XBMC, 需要將\u0026quot;網站伺服\u0026quot;的功能打開, 設定port number\n接著查看IP, 設定手機上的XBMC Remote如下:\n連線成功就會出現控制選項\n用手機上\u0026quot;Remote Control\u0026quot; Navigation, 測試播放USB裡的影片","title":"XBMC for Android on MK802"},{"content":"Install required packages # sudo apt-get install build-essential default-jdk git curl autoconf \\ unzip zip zlib1g-dev gawk gperf Getting the Android SDK and NDK http://developer.android.com/sdk/index.html\nSDK : android-sdk_r20.0.1-linux.tgz\ncrystax-5 NDK with enabled support of C++ exceptions, RTTI and Standard C++ Library\nhttp://www.crystax.net/en/android/ndk/7#download\nNDK : android-ndk-r7-crystax-5.beta2-linux-x86.tar.bz2\nInstalling Android SDK packages \u0026lt;android-sdk\u0026gt; : $HOME/XBMC_Project/android-sdk-linux\n# cd \u0026lt;android-sdk\u0026gt;/tools # ./android update sdk -u -t platform,platform-tool Setup the Android toolchain \u0026lt;android-ndk\u0026gt; : $HOME/XBMC_Project/android-ndk-r8b \u0026lt;android-toolchain\u0026gt; : $HOME/XBMC_Project/android_toolchain/android-9\n# cd \u0026lt;android-ndk\u0026gt; # ls platforms # cd build/tools # ./make-standalone-toolchain.sh --ndk-dir=../../ \\ --install-dir=\u0026lt;android-toolchain\u0026gt;/android-9 --platform=android-9 Create a (new) debug key to sign debug APKs All packages must be signed. The following command will generate a self-signed debug key. If the result is a cryptic error, it probably just means a debug key already existed, no cause for alarm.\n# keytool -genkey -keystore ~/.android/debug.keystore -v -alias \\ androiddebugkey -dname \u0026#34;CN=Android Debug,O=Android,C=US\u0026#34; -keypass \\ android -storepass android -keyalg RSA -keysize 2048 -validity 10000 Getting the source code # cd $HOME/XBMC_Project # git clone git://github.com/xbmc/android.git xbmc-android-git # cd xbmc-android-git # git submodule update --init addons/skin.touched Building dependencies # cd $HOME/XBMC_Project/xbmc-android-git/tools/android/depends # ./bootstrap # ./configure --help #export XBMC_ANDROID_NDK=~/XBMC_Project/android-ndk-r7-crystax-5.beta2 #export XBMC_ANDROID_SDK=~/XBMC_Project/android-sdk-linux #export XBMC_ANDROID_TARBALLS=~/XBMC_Project/xbmc-tarballs #./configure --with-toolchain=~/XBMC_Project/android-toolchain/android-9 checking for g++... g++ checking whether the C++ compiler works... yes checking for C++ compiler default output file name... a.out checking for suffix of executables... checking whether we are cross compiling... no checking for suffix of object files... o checking whether we are using the GNU C++ compiler... yes checking whether g++ accepts -g... yes checking for gcc... gcc checking whether we are using the GNU C compiler... yes checking whether gcc accepts -g... yes checking for gcc option to accept ISO C89... none needed checking for main in -lz... yes checking for unzip... yes checking for zip... yes checking for curl... /usr/bin/curl checking for tar... /bin/tar checking for -gcc... no configure: WARNING: host was not specified. guessing. checking for gcc... /home/oopsmonk/XBMC_Project/android-toolchain/android-9/arm-linux-androideabi/bin/gcc toolchain: /home/oopsmonk/XBMC_Project/android-toolchain/android-9 cpu: armeabi-v7a host: arm-linux-androideabi sdk-platform: android-10 configure: creating ./config.status config.status: creating Makefile config.status: creating Makefile.include #make -j4 make[1]: Leaving directory `/home/oopsmonk/XBMC_Project/xbmc-android-git/tools/android/depends/libssh\u0026#39; Dependencies built successfully. Building XBMC #cd ~/XBMC_Project/xbmc-android-git/tools/android/depends/xbmc #make -j4 APK location : ~/XBMC_Project/xbmc-android-git/xbmcapp-armeabi-v7a-debug.apk\nEnjoy it !!\nReferences:\nhttps://github.com/xbmc/android/blob/android-rebase-8/docs/README.android\nhttp://xbmc.org/theuni/2012/07/13/xbmc-for-android/\n","permalink":"https://oopsmonk.github.io/posts/2012-07-28-buildxbmc/","summary":"Install required packages # sudo apt-get install build-essential default-jdk git curl autoconf \\ unzip zip zlib1g-dev gawk gperf Getting the Android SDK and NDK http://developer.android.com/sdk/index.html\nSDK : android-sdk_r20.0.1-linux.tgz\ncrystax-5 NDK with enabled support of C++ exceptions, RTTI and Standard C++ Library\nhttp://www.crystax.net/en/android/ndk/7#download\nNDK : android-ndk-r7-crystax-5.beta2-linux-x86.tar.bz2\nInstalling Android SDK packages \u0026lt;android-sdk\u0026gt; : $HOME/XBMC_Project/android-sdk-linux\n# cd \u0026lt;android-sdk\u0026gt;/tools # ./android update sdk -u -t platform,platform-tool Setup the Android toolchain \u0026lt;android-ndk\u0026gt; : $HOME/XBMC_Project/android-ndk-r8b \u0026lt;android-toolchain\u0026gt; : $HOME/XBMC_Project/android_toolchain/android-9","title":"Build XBMC for Android on lubuntu 12.04"},{"content":"先看過Processes and Threads會有比較清楚的概念, 當Adnroid Application 啟動後, 系統會建一個主要的thread 稱 \u0026ldquo;main thread\u0026rdquo; or \u0026ldquo;UI thread\u0026rdquo;, 所有的components 皆跑在這個UI thread, system calls 也是透過UI thread dispatched給各個component, ex: onKeyDown, touch event.\nUI thread 如因大量運算或等待而blocked, 預設超過5秒ANR(Application Not Responding)就會發生.\n且Android UI components 並非thread-safe, 使用上要特別小心.\n所以:\nlong time computation使用另外的thread, 不要寫在 UI Thread. 不要在UI thread 之外使用UI component method. 透過Thread, Handler and AsyncTask perform asynchronous processing, 避免UI thread block. Threads Android 提供以下的method, 可在其它的thread 下調用 UI thread.\nActivity.runOnUiThread(Runnable) View.post(Runnable) \u0026lt;-- used in example code. View.postDelayed(Runnable, long) 或是使用Handler or AsyncTasks class 達到同樣的效果.\nHandler 有2個主要用途:\nmessage scheduling, post action at specific point. 將其它thread發出來的action 放入message queue中, 避免race condition. 處理message 需要override handleMessage(), 透過sendMessage() or sendEmptyMessage() method.\n執行Runnanble則是使用post() method.\n一個Activity 只需有一個Handler instance.\nAsyncTask 使用AsyncTask必需繼承它, 且override doInBackground() method.\n用法：\n呼叫execute() 開始執行, 之後onPerExecute()接著自動被呼叫, 通常用來 initial status of task.\n接著doInBackground() 被調用, 一般為long time computation時使用.\ncall publishProgress()後會調用onProgressUpdate(), onProgressUpdate()調用於UI thread, 一般用來update progress bar, UI animate.\npublishProgress() trigger時間點是無法預期的.\ndoInBackground() 結束後會trigger onPostExecute()調用於UI thread, 用來返回結果.\nThread, Handler 在Avtivity 結束後 thread就結束, 但AsyncTack則否.\nAns:\nInternally, AsyncTask uses fixed thread pool.\n(See http://developer.android.com/reference/java/util/concurrent/ThreadPoolExecutor.html)\nSo, even if AsyncTask finished, thread does not die. But thread in thread pool can be killed.\nExample:\nres/layout/demothreads.xml\nDemoThreads.java\nDemoHandler.java\nDemoAsyncTask.java\nReferences:\nhttp://www.vogella.com/articles/AndroidPerformance/article.html\nhttp://android-er.blogspot.tw/2010/11/progressbar-running-in-asynctask.html\nhttp://stackoverflow.com/questions/10688878/android-how-to-reconnect-to-asynctask-after-ondestroy-and-relaunch-oncreate\n","permalink":"https://oopsmonk.github.io/posts/2012-06-14-androidthreadshandlersandasynctask/","summary":"先看過Processes and Threads會有比較清楚的概念, 當Adnroid Application 啟動後, 系統會建一個主要的thread 稱 \u0026ldquo;main thread\u0026rdquo; or \u0026ldquo;UI thread\u0026rdquo;, 所有的components 皆跑在這個UI thread, system calls 也是透過UI thread dispatched給各個component, ex: onKeyDown, touch event.\nUI thread 如因大量運算或等待而blocked, 預設超過5秒ANR(Application Not Responding)就會發生.\n且Android UI components 並非thread-safe, 使用上要特別小心.\n所以:\nlong time computation使用另外的thread, 不要寫在 UI Thread. 不要在UI thread 之外使用UI component method. 透過Thread, Handler and AsyncTask perform asynchronous processing, 避免UI thread block. Threads Android 提供以下的method, 可在其它的thread 下調用 UI thread.\nActivity.runOnUiThread(Runnable) View.post(Runnable) \u0026lt;-- used in example code.","title":"Android Threads, Handlers and AsyncTask"},{"content":"這次的Computex show 中Micorsofte主要是強打windows 8系統的 Ultrabook, Tablet , AIO(All in One) PC, 主要大廠ASUS, Acer, Compal, Gigabyte, MSI, Samsung \u0026hellip;等都有展出, 除了這些來看看其它有趣的東西吧.\n互動感十足的販賣機, 原本以為是單純的transparent panel 播放動畫, 沒想到是touch panel還可以玩game, AUO的面板, 當然這麼大的面板用的是光學觸控(Optical touch).\nLITEMAX(晶達光電) 的 Spanpixel Resizing LCD透過獨特的面板切割技術, 提供非一般標準比例的LCD顯示器. 做為特殊工業應用, 車站、購物中心，公共資訊\u0026hellip;等的顯示應用. 今年掛牌上市的公司, 電子廣告看板模組似乎有不錯的潛力.\n讓我想到Always Innovatin 的 HDMI Dongle, 家裡的舊電視只要有HDMI port就可以升級成SmartTV, 後來得知國內有几家公司有在做類似的產品, 似乎也是不錯的商機.\nGenius 在2011年推出全球首款Ring Mouse, 今年又推出新一代的Ring Presenter. 用的是2.4GHz無線.\n精傑電子, 主要強調3D graphic處理能力, 應用在3D presentations, 用transparent panel. 總覺得與磐儀科技推的行動醫療平板很像.\n規格如下:\nCPU: AMD G-Series T56N Dual Core GPU: AMD Radeon HD6320 Screen: 10.4\u0026quot; XGA color LCD(1024x768), touch panel Memory: 4GB DDR3 memory Storage: 32GB SSD Drive Wireless: 802.11 b/g/n, Bluetooth interfaces LAN: Gigabit Ethernet Camera: auto-focus CMOS 5.0 megapixels Battery life: 2.5_3 hours (2 batteries) Weight: 1.75kg (with 2 batteries) 手上拿的是Google Glass ?!\n記得CES show中的demo有看過這眼鏡, 暫時找不到之前youtbe上的影片..~\u0026quot;~\n玩佷大, 液態氮都出場了.\n如果是在Shopping Mall, Pub..等地方, 應該會吸引不少目光.\n萬里科技的號稱全球第一台免去背拍照系統, 不過上面這model 看起來笑的有點僵, 這姿式還有笑容可是要維持3分鐘以上吧, 我猜!! 因為要拍20個角度\u0026hellip;冏\n看似不錯的功能, 但如果是桌機的話, 雖然灰塵不卡在CPU散熱片上, 似乎依舊在機殼裡面?!\n拿D3來展示gaming performance讓我嘴角上揚了一下, 為什麼不拿個3D game來展示..只能說D3正夯\u0026hellip;XD\n另外Grand Hyatt show room list.\n其它照片\n","permalink":"https://oopsmonk.github.io/posts/2012-06-10-computextaipei/","summary":"這次的Computex show 中Micorsofte主要是強打windows 8系統的 Ultrabook, Tablet , AIO(All in One) PC, 主要大廠ASUS, Acer, Compal, Gigabyte, MSI, Samsung \u0026hellip;等都有展出, 除了這些來看看其它有趣的東西吧.\n互動感十足的販賣機, 原本以為是單純的transparent panel 播放動畫, 沒想到是touch panel還可以玩game, AUO的面板, 當然這麼大的面板用的是光學觸控(Optical touch).\nLITEMAX(晶達光電) 的 Spanpixel Resizing LCD透過獨特的面板切割技術, 提供非一般標準比例的LCD顯示器. 做為特殊工業應用, 車站、購物中心，公共資訊\u0026hellip;等的顯示應用. 今年掛牌上市的公司, 電子廣告看板模組似乎有不錯的潛力.\n讓我想到Always Innovatin 的 HDMI Dongle, 家裡的舊電視只要有HDMI port就可以升級成SmartTV, 後來得知國內有几家公司有在做類似的產品, 似乎也是不錯的商機.\nGenius 在2011年推出全球首款Ring Mouse, 今年又推出新一代的Ring Presenter. 用的是2.4GHz無線.\n精傑電子, 主要強調3D graphic處理能力, 應用在3D presentations, 用transparent panel. 總覺得與磐儀科技推的行動醫療平板很像.\n規格如下:\nCPU: AMD G-Series T56N Dual Core GPU: AMD Radeon HD6320 Screen: 10.","title":"COMPUTEX TAIPEI 2012"}]