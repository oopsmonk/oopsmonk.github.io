<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Linux | oopsmonk</title>
<meta name=keywords content><meta name=description content><meta name=author content="oopsmonk"><link rel=canonical href=https://oopsmonk.github.io/tags/linux/><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://oopsmonk.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://oopsmonk.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://oopsmonk.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://oopsmonk.github.io/apple-touch-icon.png><link rel=mask-icon href=https://oopsmonk.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://oopsmonk.github.io/tags/linux/index.xml><link rel=alternate hreflang=en href=https://oopsmonk.github.io/tags/linux/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=364511140"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","364511140")}</script><meta property="og:url" content="https://oopsmonk.github.io/tags/linux/"><meta property="og:site_name" content="oopsmonk"><meta property="og:title" content="Linux"><meta property="og:locale" content="en-us"><meta property="og:type" content="website"><meta property="og:image" content="https://oopsmonk.github.io/images/bio-oopsmonk.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://oopsmonk.github.io/images/bio-oopsmonk.jpg"><meta name=twitter:title content="Linux"><meta name=twitter:description content></head><body class="list dark" id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://oopsmonk.github.io/ accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://oopsmonk.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://oopsmonk.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://oopsmonk.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://oopsmonk.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://oopsmonk.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://oopsmonk.github.io/tags/>Tags</a></div><h1>Linux</h1></header><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy src=https://oopsmonk.github.io/images/2022-06-05/Syncthing-Joplin-Setup.jpg alt></figure><header class=entry-header><h2 class=entry-hint-parent>Note-taking and file sharing with Syncthing and Joplin</h2></header><div class=entry-content><p>You can find many note-taking services, like, Evernote, Google Keep, Notion, Obsidian and online storage services such as, Dropbox, Google Drive, OneDrive, iCloud. They are easy to use and secure. But, secure is not equal to private! A way to keep privacy is host private services by self.
Edward Snowden’s Privacy Tips: “Get Rid Of Dropbox,” Avoid Facebook And Google
This is how I share/edit notes and files with different devices which service providers are unable to peek and analyze my private contents. Joplin and Syncthing in grey are optional in the diagram, for example notes can be written on the Raspberry Pi through the terminal Joplin application, files can share between the Phone and the PC directly but my Raspberry Pi is online 24/7.
...</p></div><footer class=entry-footer><span title='2022-06-05 13:01:48 +0800 +0800'>June 5, 2022</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;oopsmonk</footer><a class=entry-link aria-label="post link to Note-taking and file sharing with Syncthing and Joplin" href=https://oopsmonk.github.io/posts/2022-06-05-syncthin-joplin/></a></article><article class="post-entry tag-entry"><figure class=entry-cover><img loading=lazy src=https://oopsmonk.github.io/images/2022-04-28/perf_events_map.png alt></figure><header class=entry-header><h2 class=entry-hint-parent>Install Perf on Ubuntu 20.04</h2></header><div class=entry-content><p>What is Perf? Perf or perf-event is a Linux profiler and is part of the Linux Kernel which can help you solve advanced performance and troubleshooting functions. It covers hardware level (CPU/PMU, Performance Monitoring Unit) features and software features (software counters, tracepoints) as well.
Install on Ubuntu If perf has not installed on the system
$ perf WARNING: perf not found for kernel 5.4.0-109 You may need to install the following packages for this specific kernel: linux-tools-5.4.0-109-generic linux-cloud-tools-5.4.0-109-generic You may also want to install one of the following packages to keep up to date: linux-tools-generic linux-cloud-tools-generic $ The perf is part of linux-tools-generic package on Ubuntu:
...</p></div><footer class=entry-footer><span title='2022-04-28 18:27:21 +0800 +0800'>April 28, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;oopsmonk</footer><a class=entry-link aria-label="post link to Install Perf on Ubuntu 20.04" href=https://oopsmonk.github.io/posts/2022-04-28-perf/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Policy Configuration of SELinux and SEAndroid</h2></header><div class=entry-content><p>A Note for SELinux and SEAndroid policy configuration.
SEAndroid Security-Enhanced Linux in Android
SELinux for Android 8 - Treble mode
SEAndroid安全機制中的文件安全上下文關聯分析 - file_context
SEAndroid安全機制中的進程安全上下文關聯分析 - process
Android 8 Treble mode: Kernel early mount PRODUCT_FULL_TREBLE, PRODUCT_FULL_TREBLE_OVERRIDE, BOARD_SEPOLICY_DIRS Android 4.3 ~ 6 TE macro define: external/sepolicy/te_macros
Android 8 TE macro define: system/sepolicy/te_macros
##################################### # domain_trans(olddomain, type, newdomain) # Allow a transition from olddomain to newdomain # upon executing a file labeled with type. # This only allows the transition; it does not # cause it to occur automatically - use domain_auto_trans # if that is what you want. # define(`domain_trans', ` # Old domain may exec the file and transition to the new domain. allow $1 $2:file { getattr open read execute }; allow $1 $3:process transition; # New domain is entered by executing the file. allow $3 $2:file { entrypoint open read execute getattr }; # New domain can send SIGCHLD to its caller. ifelse($1, `init', `', `allow $3 $1:process sigchld;') # Enable AT_SECURE, i.e. libc secure mode. dontaudit $1 $3:process noatsecure; # XXX dontaudit candidate but requires further study. allow $1 $3:process { siginh rlimitinh }; ') ##################################### # domain_auto_trans(olddomain, type, newdomain) # Automatically transition from olddomain to newdomain # upon executing a file labeled with type. # define(`domain_auto_trans', ` # Allow the necessary permissions. domain_trans($1,$2,$3) # Make the transition occur by default. type_transition $1 $2:process $3; ') ##################################### # tmpfs_domain(domain) # Define and allow access to a unique type for # this domain when creating tmpfs / shmem / ashmem files. define(`tmpfs_domain', ` type $1_tmpfs, file_type; type_transition $1 tmpfs:file $1_tmpfs; allow $1 $1_tmpfs:file { read write getattr }; allow $1 tmpfs:dir { getattr search }; ') ##################################### # init_daemon_domain(domain) # Set up a transition from init to the daemon domain # upon executing its binary. define(`init_daemon_domain', ` domain_auto_trans(init, $1_exec, $1) tmpfs_domain($1) ') apol - SELinux policy analysis tool sudo apt install setools-gui SELinux Configuring the SELinux Policy
...</p></div><footer class=entry-footer><span title='2017-11-17 08:12:13 +0800 +0800'>November 17, 2017</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;oopsmonk</footer><a class=entry-link aria-label="post link to Policy Configuration of SELinux and SEAndroid" href=https://oopsmonk.github.io/posts/2017-11-17-policy-configuration-of-selinux-and-seandroid/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Faster R-CNN Use Caffe Framework</h2></header><div class=entry-content><p>Install caffe framework and run Faster R-CNN demo on Ubuntu 16.04.
Test environment CPU: Intel(R) Core(TM) i3-4130 CPU @ 3.40GHz 4-Cores
GPU: ASUSTeK GeForce GTX 1060 with 6GB Memory
HD: WDC WD5000AAKX
OS: Ubuntu 16.04
Test Flow Install software requirement Video pre-processing: get jpeg images from source video Image Labeling Use Faster R-CNN to genrate trained model Run Faster R-CNN demo Requirement Hardware:
Good graphic card with large memory (6GB memory is okay, but it has problem in VGG traing.)
...</p></div><footer class=entry-footer><span title='2017-08-31 10:00:10 +0800 +0800'>August 31, 2017</span>&nbsp;·&nbsp;12 min&nbsp;·&nbsp;oopsmonk</footer><a class=entry-link aria-label="post link to Faster R-CNN Use Caffe Framework" href=https://oopsmonk.github.io/posts/2017-08-31-faster-r-cnn-use-caffe-framework/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>[Paper] - An Evolutionary Study of Linux Memory Management for Fun and Profit</h2></header><div class=entry-content><p>Memory management主要的功能是page mapping, memory protection, and sharing, 但隨著時間不斷的演進已經算是kernel裡不小的subsystem.
這份研究分析2009~2015年之間4587筆有關memory management(mm)的patches, Linux版本由v2.6.32.1 ~ v4.0-rc4.
Source: An Evolutionary Study of Linux Memory Management for Fun and Profit
Memory Bugs 5種bugs存在mm: memory error, checking, concurrency, logic and programming.
透過heat map可清楚看到主要bug發生地方
主要的bug fix在: Memory Allocation, Garbage Collection (GC), Virtual Memory Management.
大部份memory leak並不是因為忘了free, 而是錯誤的page fault handling和 free page的計算.
MM較大的問題是很難去track正確的狀態.
Memory optimization 定義3種optimization patches
data structure: 避免nested data structure. Scalability的實現, scalability問題是因為locking for atomic access to shared data structures. memory policy: 使用合理的policy design (latency/throughput, sync/async, lazy/non-lazy, local/global, fairness/performance). fast path: 加速頻繁使用的source code, reduction跟lockless optimization是廣泛被使用. Optimistic barrier是為了減少呼叫barrier/fence system call時的synchronous overheads. (Code reduction, lockless optimization, new function, state caching, inline, code shifting, group excution, optimistic barrier) MM常見的Data structure Radix tree: In adress_space, 主要特色是有效率的存放(sparse)資料. Red-black tree: In vm_area_struct, 可快速的search, insert, delete. 相較於AVL 雖然在search上較快但需要額外的空間, insert/delete比較慢, rotation比較困難. Bitmap: 通常用在RAM的page indexing. List: 廣泛使用的DS, 例如LRU(Last Recently Used) list, 用來追蹤active/inactive pages. ...</p></div><footer class=entry-footer><span title='2017-06-13 14:47:22 +0800 +0800'>June 13, 2017</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;oopsmonk</footer><a class=entry-link aria-label="post link to [Paper] - An Evolutionary Study of Linux Memory Management for Fun and Profit" href=https://oopsmonk.github.io/posts/2017-06-13-linux-memory-management/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Linux Graphic Stack相關的名詞</h2></header><div class=entry-content><p>Linux graphic 架構還滿複雜的, 在看時需要大略了解几個名詞及之間的關係.
X Window System:
目前來到第11版本所以叫X11, 是以X window System Core protocol為基礎的window system.
wayland:
由於X11太過複雜且在embbeded system中的效能不佳, 用來取代X window System Core protocol.
weston (wayland compositor):
以wayland protocol來實做的compositor做為參考的範例, 實用上會用Westeros, Clutter…等.
KMS/UMS:
Kernel mode-setting 及User mode-setting.
OpenGL: 由Khronos Group制定的跨平台graphic API.
GLX:
是一個extension, 做為OpenGL與X window system之間的橋樑. 就像embedded system的EGL, MacOS的AGL.
DRM(Direct Rendering Manager):
為了防止世界被破壞, 保護世界的和平. 防止同時使用graphic buffer.
DRI(Direct Rendering Infrastructure):
Mesa及DRM之間的橋樑. Ref: Introduction to the Direct Rendering Infrastructure
CRTC (CRT Controller):
Crtc is in charge of reading the framebuffer memory and routes the data to an encoder.
...</p></div><footer class=entry-footer><span title='2017-05-30 14:46:40 +0800 +0800'>May 30, 2017</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;oopsmonk</footer><a class=entry-link aria-label="post link to Linux Graphic Stack相關的名詞" href=https://oopsmonk.github.io/posts/2017-05-30-linux-graphic-stack/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>在Shell使用vi-mode</h2></header><div class=entry-content><p>Vi用慣了, 那在shell也可以vi-style嗎? 答案是可以的!
這個方法可使用在常用的shell, 例如bash, ksh, zsh, mksh.
btw, mksh 是Android使用的shell, 但Ubuntu預設的dash 是不支援的.
在shell中執行set -o vi 後按’i’進入insert mode, ‘ESC’為normal mode.
回到原本的模式則是set -o emacs
如下圖:
Reference: Using vi-mode in your shell</p></div><footer class=entry-footer><span title='2017-03-28 15:36:08 +0800 +0800'>March 28, 2017</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;oopsmonk</footer><a class=entry-link aria-label="post link to 在Shell使用vi-mode" href=https://oopsmonk.github.io/posts/2017-03-28-vi-mode-in-shell/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://oopsmonk.github.io/tags/linux/page/2/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2025 <a href=https://oopsmonk.github.io/>oopsmonk</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.8/medium-zoom.min.js integrity="sha512-J3G1KdOKUuj92x5w2mV/7AmPckHbiTQdoPXd6qaeHemfcNOsuwFVQm851m+lLuJR33sGuz9TAzWtccXZOsFE0Q==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".post-content img"));images.forEach(e=>{mediumZoom(e,{background:"#808B96",margin:30,scrollOffset:30,container:null,template:null})})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>